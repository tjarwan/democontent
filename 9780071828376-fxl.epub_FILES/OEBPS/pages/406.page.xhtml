<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf196" class="pf w2 h2" data-page-no="196"><div class="pc pc196 w2 h2"><img class="bi xaf y23fd w4 hf" alt="" src="bg196.png"/><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">383</span></div><div class="t m0 x16 h1f y467 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y468 ff4 fs7 fc0 sc0 ls0 ws0">Hiding registry entries</div><div class="t m0 x16 h1f y469 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y46a ff4 fs7 fc0 sc0 ls0 ws0">Hiding network acti<span class="_ _0"/>vities</div><div class="t m0 x4 hd y46b ff4 fs7 fc0 sc0 ls0 ws0">There has been so much excellent research on technical methods and rootkit </div><div class="t m0 x3 hd y46c ff4 fs7 fc0 sc0 ls0 ws0">techniques. <span class="_ _0"/>W<span class="_ _3"/>e will not cover them in great depth; ho<span class="_ _0"/>we<span class="_ _0"/>ver<span class="_ _2"/>, we will discuss a few </div><div class="t m0 x3 hd y46d ff4 fs7 fc0 sc0 ls0 ws0">primary methods that will be benecial for our backdoor<span class="_ _0"/>, as well as include this </div><div class="t m0 x3 hd y46e ff4 fs7 fc0 sc0 ls0 ws0">functionality in our backdoor<span class="_ _2"/>. Part of the reason we will not go into great depth on </div><div class="t m0 x3 hd y241c ff4 fs7 fc0 sc0 ls0 ws0">some of these rootkit methods for stealth from the local system is that in many cases, </div><div class="t m0 x3 hd y241d ff4 fs7 fc0 sc0 ls0 ws0">they are completely unnecessary<span class="_ _3"/>.</div><div class="t m0 x4 hd y471 ff4 fs7 fc0 sc0 ls0 ws0">Many times, it’<span class="_ _2"/>s not only unnecessary to utilize host-based rootkit stealth </div><div class="t m0 x3 hd y241e ff4 fs7 fc0 sc0 ls0 ws0">methods, but also unnecessary to ha<span class="_ _0"/>v<span class="_ _0"/>e administrator privile<span class="_ _0"/>ges on the compromised </div><div class="t m0 x3 hd y241f ff4 fs7 fc0 sc0 ls0 ws0">machine. Remember back to Chapter 3 and our discussion of exploitless e<span class="_ _0"/>xploits and </div><div class="t m0 x3 hd y2420 ff4 fs7 fc0 sc0 ls0 ws0">targeting administrati<span class="_ _0"/>v<span class="_ _0"/>e channels. If we chose our target user correctly and no<span class="_ _0"/>w ha<span class="_ _0"/>ve </div><div class="t m0 x3 hd y2421 ff4 fs7 fc0 sc0 ls0 ws0">a backdoor on their system, we should hav<span class="_ _0"/>e immediate access to our target asset with </div><div class="t m0 x3 hd y2422 ff4 fs7 fc0 sc0 ls0 ws0">the pri<span class="_ _0"/>vileges of the user<span class="_ _2"/>.</div><div class="t m0 x4 hd y2423 ff4 fs7 fc0 sc0 ls0 ws0">As an example, if our tar<span class="_ _0"/>get asset is intellectual property or source code and </div><div class="t m0 x3 hd y478 ff4 fs7 fc0 sc0 lsb ws16">we’<span class="_ _0"/>v<span class="_ _0"/>e compromised the workstation of a programmer at the tar<span class="_ _0"/>get organization, then </div><div class="t m0 x3 hd y479 ff4 fs7 fc0 sc0 lsb ws16">we may hav<span class="_ _0"/>e all the pri<span class="_ _0"/>vileges we need to obtain our tar<span class="_ _0"/>get asset, regardless of the </div><div class="t m0 x3 hd y47a ff4 fs7 fc0 sc0 ls0 ws0">asset being on the local system or a network system. <span class="_ _0"/>There are still many technical </div><div class="t m0 x3 hd y47b ff4 fs7 fc0 sc0 ls0 ws0">vulnerabilities we can exploit with only the pri<span class="_ _0"/>vile<span class="_ _0"/>ges of the current user<span class="_ _0"/>, including:</div><div class="t m0 x16 h1f y2424 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2425 ff4 fs7 fc0 sc0 ls0 ws0">K<span class="_ _0"/>eylogging all user acti<span class="_ _0"/>vity</div><div class="t m0 x16 h1f y2426 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2427 ff4 fs7 fc0 sc0 ls0 ws0">Accessing user credentials</div><div class="t m0 x16 h1f y2428 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2429 ff4 fs7 fc0 sc0 ls0 ws0">Accessing web bro<span class="_ _0"/>wser data and sessions</div><div class="t m0 x16 h1f y242a ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y242b ff4 fs7 fc0 sc0 ls0 ws0">Accessing user data on local systems</div><div class="t m0 x16 h1f y242c ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y242d ff4 fs7 fc0 sc0 ls0 ws0">Accessing data on network systems</div><div class="t m0 x3 h16 y242e ff1 fsb fc0 sc0 ls0 ws0">Know Thy Enemy</div><div class="t m0 x3 hd y242f ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e will have a much greater le<span class="_ _0"/>v<span class="_ _0"/>el of control and more options if the backdoor is </div><div class="t m0 x3 hd y2430 ff4 fs7 fc0 sc0 ls0 ws0">running with administrator or system pri<span class="_ _0"/>vileges on the compromised system and </div><div class="t m0 x3 hd y2431 ff4 fs7 fc0 sc0 ls0 ws0">we can use this to implement rootkit functionality; ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, in man<span class="_ _0"/>y cases, this </div><div class="t m0 x3 hd y2432 ff4 fs7 fc0 sc0 ls0 ws0">le<span class="_ _0"/>vel of access is unnecessary<span class="_ _2"/>. Many of the core functions we’<span class="_ _0"/>ll use do not require </div><div class="t m0 x3 hd y2433 ff4 fs7 fc0 sc0 ls0 ws0">administrati<span class="_ _0"/>ve pri<span class="_ _0"/>vileges.</div><div class="t m0 x4 hd y2434 ff4 fs7 fc0 sc0 ls0 ws0">In fact, in some cases, it can be more ef<span class="_ _0"/>fecti<span class="_ _0"/>ve to not implement an<span class="_ _0"/>y of these </div><div class="t m0 x3 hd y2435 ff4 fs7 fc0 sc0 ls0 ws0">stealth or rootkit functions and instead hide in plain sight. The e<span class="_ _0"/>xamples we will </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>