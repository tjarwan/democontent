<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pfa1" class="pf w2 h2" data-page-no="a1"><div class="pc pca1 w2 h2"><img class="bi xaf yf0e w4 h59" alt="" src="bga1.png"/><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">138<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd yf0f ff4 fs7 fc0 sc0 ls0 ws0">Once you’<span class="_ _2"/>ve identied the appropriate HTTP request for your search, right-click the </div><div class="t m0 x3 hd yf10 ff4 fs7 fc0 sc0 ls0 ws0">request and choose Send T<span class="_ _3"/>o Intruder<span class="_ _2"/>. The Intruder tab will turn orange to indicate the </div><div class="t m0 x3 hd yf11 ff4 fs7 fc0 sc0 ls0 ws0">ne<span class="_ _0"/>w action. Select the Intruder tab, and then select the Positions subtab<span class="_ _0"/>.</div><div class="t m0 x4 hd yf12 ff4 fs7 fc0 sc0 ls0 ws0">The Intruder module within Burp Suite allo<span class="_ _0"/>ws us to perform custom attacks </div><div class="t m0 x3 hd yf13 ff4 fs7 fc0 sc0 lsb ws16">against websites by essentially scripting dif<span class="_ _0"/>ferent payloads to inject in specic areas </div><div class="t m0 x3 hd yf14 ff4 fs7 fc0 sc0 ls0 ws0">of an HTTP request. In this case, we’<span class="_ _2"/>re utilizing Intruder to perform a basic loop </div><div class="t m0 x3 hd yf15 ff4 fs7 fc0 sc0 ls0 ws0">in which we request the same page, but change the search v<span class="_ _0"/>ariable based on the </div><div class="t m0 x3 hd yf16 ff4 fs7 fc0 sc0 ls0 ws0">payload we dene. In Figure 5-6, you can see an example of the conguration we’<span class="_ _0"/>ll </div><div class="t m0 x3 hd yf17 ff4 fs7 fc0 sc0 ls0 ws0">use for this search directory<span class="_ _2"/>. The § character is used to mark the locations within </div><div class="t m0 x3 hd yf18 ff4 fs7 fc0 sc0 ls0 ws0">the HTTP request that will change with each HTTP request,  as Burp Suite loops </div><div class="t m0 x3 hd yf19 ff4 fs7 fc0 sc0 ls0 ws0">through the v<span class="_ _0"/>ariables we dene.</div><div class="t m0 x4 hd yf1a ff4 fs7 fc0 sc0 ls0 ws0">Start by clearing all of the v<span class="_ _0"/>ariables using the Clear § button. <span class="_ _0"/>Then highlight the </div><div class="t m0 x3 hd yf1b ff4 fs7 fc0 sc0 ls0 ws0">“a” character after the Search= parameter and click the <span class="_ _2"/>Add § button. No<span class="_ _0"/>w click the </div><div class="t m0 x3 hd yf1c ff4 fs7 fc0 sc0 ls0 ws0">Payload tab to choose what we will substitute in that eld. <span class="_ _0"/>There are many options </div><div class="t m0 x3 hd yf1d ff4 fs7 fc0 sc0 ls0 ws0">for choosing a payload. For our purposes, we kno<span class="_ _0"/>w a single character will work, so </div><div class="t m0 x3 hd yf1e ff4 fs7 fc0 sc0 ls0 ws0">we will loop through the letters <span class="ff5">a</span> through <span class="ff5">z.</span> The easiest w<span class="_ _0"/>ay to do this is to choose </div><div class="t m0 x3 hd yf1f ff4 fs7 fc0 sc0 ls0 ws0">Simple List as sho<span class="_ _0"/>wn in Figure 5-7.</div><div class="t m0 x4 hd yf20 ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _3"/>o create the list of all characters in the alphabet, use the following simple bash </div><div class="t m0 x3 hd yf21 ff4 fs7 fc0 sc0 ls0 ws0">command:</div><div class="t m0 x3 h44 yf22 fff fse fc0 sc0 ls0 ws0">for i in {A..Z}; do echo $i &gt;&gt; alpha.txt; done</div><div class="t m0 x4 hd yf23 ff4 fs7 fc0 sc0 ls0 ws0">Then choose Load and select the alpha.txt le just created. Once we hav<span class="_ _0"/>e the </div><div class="t m0 x3 hd yf24 ff4 fs7 fc0 sc0 ls0 ws0">payload set, choose Intruder | Start <span class="_ _2"/>Attack to begin sending the requests. <span class="_ _2"/>A new </div><div class="t m0 x3 hd yf25 ff4 fs7 fc0 sc0 ls0 ws0">windo<span class="_ _0"/>w will open and loop through all of the requests. <span class="_ _3"/>Y<span class="_ _3"/>ou can then highlight any </div><div class="t m0 x3 hd yf26 ff4 fs7 fc0 sc0 ls0 ws0">request and see the request and response. Select all of the items, right-click, and </div><div class="t m0 x3 hd yf27 ff4 fs7 fc0 sc0 ls0 ws0">choose Sav<span class="_ _0"/>e Selected Items. <span class="_ _0"/>When you sa<span class="_ _0"/>ve the les, be sure to clear the check box </div><div class="t m0 x3 hd yf28 ff4 fs7 fc0 sc0 ls0 ws0">at the bottom of the dialog box labeled “Base64-encode requests and responses”; this </div><div class="t m0 x3 h3f yf29 ff4 fs7 fc0 sc0 ls0 ws0">will make it easier to <span class="fff">grep</span> the output le.</div><div class="t m0 x3 h21 yf2a ff1 fs2 fc0 sc0 ls0 ws0">Figure 5-5<span class="_ _21"> </span><span class="ffc">Burp Suite Intercept tab</span></div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>