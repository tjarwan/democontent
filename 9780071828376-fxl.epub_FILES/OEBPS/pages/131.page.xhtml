<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf83" class="pf w2 h2" data-page-no="83"><div class="pc pc83 w2 h2"><div class="t m0 xa7 h10 y83 ff1 fs9 fc0 sc0 lsa ws0">108<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x31 hd y11c ff4 fs7 fc0 sc0 lsb ws16">especially handy for larger or<span class="_ _0"/>ganizations where you might be scanning thousands of </div><div class="t m0 x31 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">IP addresses.</div><div class="t m0 x32 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">Since we didn’t specify an<span class="_ _0"/>y ports, nmap will scan its default ports, which are </div><div class="t m0 x31 hd y11f ff4 fs7 fc0 sc0 ls0 ws0">based on 1,000 common ports. </div><div class="t m0 x32 hd y232 ff4 fs7 fc0 sc0 ls0 ws0">Our full hard and fast scan can be performed with the follo<span class="_ _0"/>wing command: </div><div class="t m0 x31 h44 yc0e fff fse fc0 sc0 ls0 ws0">nmap -sS -oA weak.standard 1.1.1.0/24 -p- -A -T5</div><div class="t m0 x32 hd yc0f ff4 fs7 fc0 sc0 ls0 ws0">Relying only on the most common ports can be ironically inef<span class="_ _0"/>fectiv<span class="_ _0"/>e. By </div><div class="t m0 x31 hd yc10 ff4 fs7 fc0 sc0 ls0 ws0">identifying uncommon ports in use, we can nd strange or neglected services, </div><div class="t m0 x31 hd yc11 ff4 fs7 fc0 sc0 ls0 ws0">which can provide good data or possible attack paths. <span class="_ _0"/>W<span class="_ _3"/>e want to be as thorough as </div><div class="t m0 x31 hd yc12 ff4 fs7 fc0 sc0 ls0 ws0">possible and scan all 65,535 ports. T<span class="_ _3"/>o do this, we use the -p- argument.</div><div class="t m0 x32 hd yc13 ff4 fs7 fc0 sc0 ls0 ws0">When performing our full-blo<span class="_ _0"/>wn scan, we want to identify as much information </div><div class="t m0 x31 hd yc14 ff4 fs7 fc0 sc0 ls0 ws0">as possible, so we will add options that provide specic information about the </div><div class="t m0 x31 hd yc15 ff4 fs7 fc0 sc0 ls0 ws0">services identied. <span class="_ _0"/>W<span class="_ _3"/>e can use individual options, or we can use -A, which enables </div><div class="t m0 x31 hd yc16 ff4 fs7 fc0 sc0 ls0 ws0">OS detection, version detection, script scanning, and traceroute.</div><div class="t m0 x32 hd yc17 ff4 fs7 fc0 sc0 ls0 ws0">Se<span class="_ _0"/>veral templates are a<span class="_ _0"/>v<span class="_ _0"/>ailable to us that control the timing within nmap. The </div><div class="t m0 x31 hd yc18 ff4 fs7 fc0 sc0 ls0 ws0">timing templates from slo<span class="_ _0"/>west to fastest are paranoid, sneaky<span class="_ _3"/>, polite, normal, </div><div class="t m0 x31 hd yc19 ff4 fs7 fc0 sc0 ls0 ws0">aggressi<span class="_ _0"/>ve, and insane. If it’<span class="_ _2"/>s a very lar<span class="_ _0"/>ge subnet or we are feeling extremely </div><div class="t m0 x31 hd yc1a ff4 fs7 fc0 sc0 ls0 ws0">impatient, we can max out the timing with the -T insane option.</div><div class="t m0 x32 hd yc1b ff4 fs7 fc0 sc0 ls0 ws0">I normally don’t recommend w<span class="_ _0"/>orrying too much about scanning very slo<span class="_ _0"/>wly; </div><div class="t m0 x31 hd yc1c ff4 fs7 fc0 sc0 ls0 ws0">ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, there are some en<span class="_ _2"/>vironments where this makes sense. There aren’<span class="_ _0"/>t any </div><div class="t m0 x31 hd yc1d ff4 fs7 fc0 sc0 ls0 ws0">hard rules on when you should use very slo<span class="_ _0"/>w timing or v<span class="_ _0"/>ery fast timing; instead, you </div><div class="t m0 x31 hd yc1e ff4 fs7 fc0 sc0 ls0 ws0">need to make a judgment call based on the information you ha<span class="_ _0"/>ve about your tar<span class="_ _0"/>get </div><div class="t m0 x31 hd yc1f ff4 fs7 fc0 sc0 ls1f ws0">organization.</div><div class="t m0 x32 hd yc20 ff4 fs7 fc0 sc0 ls0 ws0">In most cases, you’ll probably want to try at least three scans from dif<span class="_ _0"/>ferent </div><div class="t m0 x31 hd yc21 ff4 fs7 fc0 sc0 ls0 ws0">source networks: one slo<span class="_ _0"/>w or very slo<span class="_ _0"/>w scan, one normal scan, and one v<span class="_ _0"/>ery fast </div><div class="t m0 x31 hd yc22 ff4 fs7 fc0 sc0 ls0 ws0">scan. By performing these scans from dif<span class="_ _0"/>ferent source networks, you can be sure </div><div class="t m0 x31 hd yc23 ff4 fs7 fc0 sc0 ls0 ws0">you’<span class="_ _2"/>re getting the most accurate information and accounting for the possibility that </div><div class="t m0 x31 hd yc24 ff4 fs7 fc0 sc0 ls0 ws0">one of your scans might be identied and present inaccurate information.</div><div class="t m0 x32 hd yc25 ff4 fs7 fc0 sc0 ls13 ws0">If you’<span class="_ _2"/>re feeling ambitious, you can check out the manual conguration </div><div class="t m0 x31 hd yc26 ff4 fs7 fc0 sc0 ls20 ws16">for timing settings. Most of these are self-explanatory<span class="_ _3"/>, but at the end of the day<span class="_ _2"/>, the </div><div class="t m0 x31 hd yc27 ff4 fs7 fc0 sc0 ls0 ws0">timing templates av<span class="_ _0"/>ailable to us will be appropriate for 99 percent of the tar<span class="_ _0"/>gets </div><div class="t m0 x31 hd yc28 ff4 fs7 fc0 sc0 ls0 ws0">we encounter<span class="_ _2"/>. The follo<span class="_ _0"/>wing example sho<span class="_ _0"/>ws the timing and performance options </div><div class="t m0 x31 hd yc29 ff4 fs7 fc0 sc0 ls0 ws0">av<span class="_ _0"/>ailable from the nmap man page:</div><div class="t m0 x31 h4c yc2a fff fs12 fc0 sc0 ls21 ws0">           TIMING AND PERFORMANCE:</div><div class="t m0 x31 h4c yc2b fff fs12 fc0 sc0 ls21 ws0">             Options which take &lt;time&gt; are in seconds, or append 'ms' </div><div class="t m0 x31 h4c yc2c fff fs12 fc0 sc0 ls21 ws0">(milliseconds),</div><div class="t m0 x31 h4c yc2d fff fs12 fc0 sc0 ls21 ws0">             's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>