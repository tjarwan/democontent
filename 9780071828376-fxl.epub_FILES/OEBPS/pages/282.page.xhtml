<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf11a" class="pf w2 h2" data-page-no="11a"><div class="pc pc11a w2 h2"><div class="t m0 xa3 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 7: Phase III: Remote T<span class="_ _0"/>argeting<span class="_ _9"> </span><span class="ff1 fs9 lsa">259</span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">response and indicate that our host is the mail server<span class="_ _2"/>. The e-mail program then </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls2a ws31">attempts to connect to our host on port 110 for POP3 (Post Ofce Protocol version 3). </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 ls0 ws0">Our fake serv<span class="_ _0"/>er then provides basic functionality to authenticate the user and capture </div><div class="t m0 x3 hd y210 ff4 fs7 fc0 sc0 ls0 ws0">their credentials.</div><div class="t m0 x4 hd y120 ff4 fs7 fc0 sc0 lsb ws16">Most of the protocols support cleartext login, allo<span class="_ _0"/>wing us to gather v<span class="_ _0"/>alid </div><div class="t m0 x3 hd y121 ff4 fs7 fc0 sc0 ls0 ws0">credentials in an extremely easy and ef<span class="_ _0"/>fecti<span class="_ _0"/>ve w<span class="_ _0"/>ay<span class="_ _2"/>. There are many f<span class="_ _0"/>ake serv<span class="_ _0"/>er </div><div class="t m0 x3 hd y398 ff4 fs7 fc0 sc0 ls0 ws0">modules within Metasploit to ex<span class="_ _0"/>ecute these attacks:</div><div class="t m0 x16 h1f y1b0b ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 h2c y783 ff3 fs7 fc0 sc0 ls0 ws0">E-mail<span class="_ _a"> </span><span class="ff4">SMTP<span class="_ _1b"/>, IMAP<span class="_ _3"/>, POP3</span></div><div class="t m0 x16 h1f y1b0c ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 h2c y1b0d ff3 fs7 fc0 sc0 ls0 ws2d">File T<span class="_ _2"/>ransfer<span class="_ _a"> </span><span class="ff4 ws0">FTP<span class="_ _1b"/>, SMB, printing</span></div><div class="t m0 x16 h1f y1b0e ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 h2c y549 ff3 fs7 fc0 sc0 ls0 ws0">Database<span class="_ _a"> </span><span class="ff4">MySQL, MSSQL, PostgreSQL, DRD<span class="_ _0"/>A</span></div><div class="t m0 x16 h1f y1b0f ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 h2c y1b10 ff3 fs7 fc0 sc0 ls0 ws0">V<span class="_ _0"/>OIP<span class="_ _41"> </span><span class="ff4">SIP</span></div><div class="t m0 x16 h1f y1b11 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 h2c y1b12 ff3 fs7 fc0 sc0 ls0 ws0">Miscellaneous<span class="_ _41"> </span><span class="ff4">T<span class="_ _2"/>elnet</span></div><div class="t m0 x4 hd y1b13 ff4 fs7 fc0 sc0 ls0 ws0">Depending on the protocol and its conguration, sending the user to our fake </div><div class="t m0 x3 hd y1b14 ff4 fs7 fc0 sc0 ls0 ws0">server might not be necessary<span class="_ _3"/>. For example, by allo<span class="_ _0"/>wing a user to reach an intended </div><div class="t m0 x3 hd y1b15 ff4 fs7 fc0 sc0 ls0 ws0">Remote Desktop Protocol (RDP) or Point-to-Point T<span class="_ _2"/>unneling Protocol (PPTP) server </div><div class="t m0 x3 hd y1b16 ff4 fs7 fc0 sc0 ls0 ws0">that is congured to authenticate the user using MSChap-v2, we might be able to </div><div class="t m0 x3 hd y1b17 ff4 fs7 fc0 sc0 ls0 ws0">capture the login and brute-force the obtained credentials.</div><div class="t m0 x4 hd y1b18 ff4 fs7 fc0 sc0 ls0 ws0">Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, this might not work for all protocols that support weak login protocols. </div><div class="t m0 x3 hd y1b19 ff4 fs7 fc0 sc0 ls0 ws0">For e<span class="_ _0"/>xample, the original POP3 e-mail server only supported clearte<span class="_ _0"/>xt login with a </div><div class="t m0 x3 hd y1b1a ff4 fs7 fc0 sc0 ls0 ws32">user name and password, although ne<span class="_ _0"/>wer implementations support many alternati<span class="_ _0"/>v<span class="_ _0"/>es, </div><div class="t m0 x3 hd y1b1b ff4 fs7 fc0 sc0 ls0 ws0">including challenge/response protocols, hashed logins, and e<span class="_ _0"/>ven tunneling through </div><div class="t m0 x3 hd y1b1c ff4 fs7 fc0 sc0 ls0 ws0">an SSL-encrypted tunnel. Thus, if we let the client communications reach the </div><div class="t m0 x3 hd y1b1d ff4 fs7 fc0 sc0 ls0 ws0">intended system but the<span class="_ _0"/>y end up using a secure login system such as an SSL tunnel, </div><div class="t m0 x3 hd y1b1e ff4 fs7 fc0 sc0 ls0 ws0">we won’<span class="_ _0"/>t be able to capture any meaningful data. In addition, some client software </div><div class="t m0 x3 hd y1b1f ff4 fs7 fc0 sc0 ls0 ws0">might be congured to only connect with secure protocols.</div><div class="t m0 x4 hd y1b20 ff4 fs7 fc0 sc0 ls0 ws0">Many of the Metasploit f<span class="_ _0"/>ake servers implement only basic functionality to allo<span class="_ _0"/>w </div><div class="t m0 x3 hd y1b21 ff4 fs7 fc0 sc0 ls0 ws0">us to collect important pieces of the communication. The Simple Mail <span class="_ _0"/>T<span class="_ _0"/>ransport </div><div class="t m0 x3 hd y1b22 ff4 fs7 fc0 sc0 ls0 ws0">Protocol (SMTP) server supports the follo<span class="_ _0"/>wing SMTP protocol commands: HELO, </div><div class="t m0 x3 hd y1b23 ff4 fs7 fc0 sc0 ls0 ws0">EHLO, MAIL, RCPT<span class="_ _2"/>, D<span class="_ _0"/>A<span class="_ _1b"/>T<span class="_ _3"/>A, P<span class="_ _3"/>ASS, and QUIT<span class="_ _2"/>. Howe<span class="_ _0"/>v<span class="_ _0"/>er<span class="_ _0"/>, this server is not actually </div><div class="t m0 x3 hd y1b24 ff4 fs7 fc0 sc0 ls0 ws0">inspecting the elements to make sure the<span class="_ _0"/>y are valid. Instead, it’<span class="_ _2"/>s simply responding </div><div class="t m0 x3 hd y1b25 ff4 fs7 fc0 sc0 ls0 ws0">with the same message e<span class="_ _0"/>very time that indicates a success or failure.</div><div class="t m0 x3 h4 y1b26 ff2 fs1 fc0 sc0 ls0 ws0">Access Point Core Attack Cong</div><div class="t m0 x3 hd y1b27 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e’<span class="_ _0"/>ve already created the basic functionality to of<span class="_ _0"/>fer wireless services and hand out </div><div class="t m0 x3 hd y1b28 ff4 fs7 fc0 sc0 ls0 ws0">IP addresses. No<span class="_ _0"/>w we need to build the DNS serv<span class="_ _0"/>er and HTTP server<span class="_ _2"/>. <span class="_ _0"/>W<span class="_ _2"/>e’ll use the </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>