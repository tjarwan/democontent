<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf1a0" class="pf w2 h2" data-page-no="1a0"><div class="pc pc1a0 w2 h2"><img class="bi xaf y2526 w4 h9a" alt="" src="bg1a0.png"/><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">393</span></div><div class="t m0 x4 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">Detecting when an HTTPS tunnel is being tampered with is actually a relati<span class="_ _0"/>vely </div><div class="t m0 x3 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">easy task for our backdoor<span class="_ _2"/>. The trick is to determine what our next action should </div><div class="t m0 x3 hd y19a ff4 fs7 fc0 sc0 ls0 ws0">be. <span class="_ _0"/>W<span class="_ _3"/>e can choose to have our backdoor remo<span class="_ _0"/>ve itself if the risk of being identied </div><div class="t m0 x3 hd y291 ff4 fs7 fc0 sc0 ls0 ws0">is too great. Or perhaps a better option might be to fall back to the absolute bare </div><div class="t m0 x3 hd y424 ff4 fs7 fc0 sc0 ls0 ws0">minimum of network trafc that is needed to signal to our C2 serv<span class="_ _0"/>er that the </div><div class="t m0 x3 hd y425 ff4 fs7 fc0 sc0 ls0 ws0">backdoor is still operational, but w<span class="_ _0"/>aiting for the signal to perform additional actions.</div><div class="t m0 x4 hd y426 ff4 fs7 fc0 sc0 ls0 ws0">Finally<span class="_ _2"/>, we’ll design the optimal way to e<span class="_ _0"/>xltrate data. There are methods b<span class="_ _0"/>uilt </div><div class="t m0 x3 hd y427 ff4 fs7 fc0 sc0 ls0 ws0">into the HTTP protocol that work v<span class="_ _0"/>ery well; howe<span class="_ _0"/>v<span class="_ _0"/>er<span class="_ _0"/>, based on the type and size </div><div class="t m0 x3 hd y428 ff4 fs7 fc0 sc0 ls0 ws0">of the data to be exltrated, we can mak<span class="_ _0"/>e it much more difcult to identify the data </div><div class="t m0 x3 hd y429 ff4 fs7 fc0 sc0 ls0 ws0">being exltrated by hiding the data within components of netw<span class="_ _0"/>ork communication.</div><div class="t m0 x3 h16 y42a ff1 fsb fc0 sc0 ls0 ws0">Deployment Scenarios</div><div class="t m0 x3 hd y42b ff4 fs7 fc0 sc0 ls0 ws0">In pre<span class="_ _0"/>vious phases, we discussed specic attacks in which we can utilize our custom </div><div class="t m0 x3 hd y42c ff4 fs7 fc0 sc0 ls0 ws0">droppers and backdoors. It will be noted when creating functions that will be unique </div><div class="t m0 x3 hd y42d ff4 fs7 fc0 sc0 ls0 ws0">or benecial to a specic attack we discussed pre<span class="_ _0"/>viously<span class="_ _2"/>. Some of the specic </div><div class="t m0 x3 hd y42e ff4 fs7 fc0 sc0 ls0 ws0">scenarios and attacks included</div><div class="t m0 x16 h1f y42f ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y430 ff4 fs7 fc0 sc0 ls0 ws0">Bundle dropper or backdoor with legitimate softw<span class="_ _0"/>are on USB or CD</div><div class="t m0 x16 h1f y431 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y432 ff4 fs7 fc0 sc0 ls0 ws0">Spear phishing (deli<span class="_ _0"/>vering dropper via phishing website)</div><div class="t m0 x16 h1f y433 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y434 ff4 fs7 fc0 sc0 ls0 ws0">APT rogue access point (deli<span class="_ _0"/>vering dropper via phishing website)</div><div class="t m0 x16 h1f y2527 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2528 ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _2"/>eensy (dropper or a T<span class="_ _3"/>eensy payload that downloads a dropper)</div><div class="t m0 x4 hd y2529 ff4 fs7 fc0 sc0 ls0 ws0">In addition, we’ll co<span class="_ _0"/>ver a fe<span class="_ _0"/>w unique scenarios where utilizing a custom backdoor </div><div class="t m0 x3 hd y252a ff4 fs7 fc0 sc0 ls0 ws0">may also be adv<span class="_ _0"/>antageous, including extreme situations in which almost all </div><div class="t m0 x3 hd y252b ff4 fs7 fc0 sc0 ls0 ws0">communication is ltered.</div><div class="t m0 x3 h16 y252c ff1 fsb fc0 sc0 ls0 ws0">American Backdoor: An APT Hacker’<span class="_ _1b"/>s Novel</div><div class="t m0 x3 hd y252d ff4 fs7 fc0 sc0 ls0 ws0">Even if you ha<span class="_ _0"/>ve zero programming e<span class="_ _0"/>xperience, do not skip this section. <span class="_ _3"/>Y<span class="_ _3"/>ou will </div><div class="t m0 x3 hd y252e ff4 fs7 fc0 sc0 ls0 ws0">learn a lot about the ef<span class="_ _0"/>fectiv<span class="_ _0"/>e operation of our backdoors and related programs in this </div><div class="t m0 x3 hd y252f ff4 fs7 fc0 sc0 ls0 ws0">section.</div><div class="t m0 x4 hd y2530 ff4 fs7 fc0 sc0 ls0 ws0">The v<span class="_ _0"/>ast majority of our example code is written for the <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws operating </div><div class="t m0 x3 hd y2531 ff4 fs7 fc0 sc0 lsb ws16">system—again, this is done because the v<span class="_ _0"/>ast majority of our targets will be using </div><div class="t m0 x3 hd y2532 ff4 fs7 fc0 sc0 ls0 ws0">the <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws OS. This doesn’<span class="_ _0"/>t mean that other operating systems such as Mac OS, </div><div class="t m0 x3 hd y2533 ff4 fs7 fc0 sc0 ls0 ws0">Unix, or Linux are impervious to custom backdoors, or e<span class="_ _0"/>ven that you’<span class="_ _2"/>re completely </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>