<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf1be" class="pf w2 h2" data-page-no="1be"><div class="pc pc1be w2 h2"><img class="bi xaf y282b w4 hf" alt="" src="bg1be.png"/><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">423</span></div><div class="t m0 x4 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">Then build the source code with the follo<span class="_ _0"/>wing commands:</div><div class="t m0 x3 h44 y282c fff fse fc0 sc0 ls0 ws0">root@kali:/root/dev/ssh/openssh-6.6p1# configure</div><div class="t m0 x3 h44 y282d fff fse fc0 sc0 ls0 ws0">root@kali:/root/dev/ssh/openssh-6.6p1# make</div><div class="t m0 x4 hd y282e ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e will not install the updated source with “make install” for now—let’<span class="_ _2"/>s just </div><div class="t m0 x3 hd y282f ff4 fs7 fc0 sc0 ls0 ws0">work with it in the current directory to ensure it’<span class="_ _2"/>s operating as we expect. Once the </div><div class="t m0 x3 hd y2830 ff4 fs7 fc0 sc0 ls0 ws0">source has nished compiling, let’<span class="_ _2"/>s start the service with the following command:</div><div class="t m0 x3 h44 y2831 fff fse fc0 sc0 ls0 ws0">root@kali:./openssh-6.6p1/sshd -f /etc/ssh/sshd_config</div><div class="t m0 x4 hd y2832 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou should now be able to SSH to the tar<span class="_ _0"/>get system using the backdoor password. </div><div class="t m0 x3 hd y2833 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou’ll notice that you can actually authenticate as any user using the password </div><div class="t m0 x3 hd y2834 ff4 fs7 fc0 sc0 ls0 ws0">“rootmeplease.<span class="_ _2"/>” If root logins are allowed, this includes the root user<span class="_ _2"/>. If this were a </div><div class="t m0 x3 hd y2835 ff4 fs7 fc0 sc0 ls0 ws0">li<span class="_ _0"/>ve system, we’<span class="_ _2"/>d then simply install the updated version and restart the service.</div><div class="t m0 x4 hd y2836 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can use this same method with any open-source software, backdooring it </div><div class="t m0 x3 hd y2837 ff4 fs7 fc0 sc0 ls0 ws0">in any w<span class="_ _0"/>ay we choose. If the server software is not open source, another similar </div><div class="t m0 x3 hd y2838 ff4 fs7 fc0 sc0 ls0 ws0">technique would be to backdoor the <span class="_ _0"/>TCP server in a slightly more natural way<span class="_ _3"/>. </div><div class="t m0 x3 hd y2839 ff4 fs7 fc0 sc0 ls0 ws0">For e<span class="_ _0"/>xample, with Internet Information Server (IIS), we might be able to plant a </div><div class="t m0 x3 hd y283a ff4 fs7 fc0 sc0 ls0 ws0">backdoor server<span class="_ _0"/>-side script or implant some obfuscated code into an existing serv<span class="_ _0"/>er<span class="_ _0"/>-</div><div class="t m0 x3 hd y283b ff4 fs7 fc0 sc0 ls0 ws0">side script. Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, e<span class="_ _0"/>ven in cases where the softw<span class="_ _0"/>are itself is closed source, we can </div><div class="t m0 x3 hd y283c ff4 fs7 fc0 sc0 ls0 ws0">possibly extend the functionality using custom DLLs or an <span class="_ _2"/>API for the software.</div><div class="t m0 x3 h16 y283d ff1 fsb fc0 sc0 ls0 ws0">Don’t Forget</div><div class="t m0 x3 hd y283e ff4 fs7 fc0 sc0 ls0 ws0">In this chapter<span class="_ _0"/>, you’<span class="_ _2"/>ve learned simple and creati<span class="_ _0"/>ve ways to mak<span class="_ _0"/>e your backdoor </div><div class="t m0 x3 hd y283f ff4 fs7 fc0 sc0 lsb ws16">blend in with the noise and remain stealthy despite in<span class="_ _0"/>v<span class="_ _0"/>estigation. <span class="_ _0"/>W<span class="_ _2"/>e discussed the </div><div class="t m0 x3 hd y2840 ff4 fs7 fc0 sc0 ls0 ws0">primary goals of our backdoor<span class="_ _0"/>, including:</div><div class="t m0 x16 h1f y2841 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2842 ff4 fs7 fc0 sc0 ls0 ws0">Obtaining data from compromised machines</div><div class="t m0 x16 h1f y2843 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2844 ff4 fs7 fc0 sc0 ls0 ws0">Maintaining prolonged stealth access</div><div class="t m0 x16 h1f y2845 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2846 ff4 fs7 fc0 sc0 ls0 ws0">Pi<span class="_ _0"/>voting to other assets or resources</div><div class="t m0 x4 hd y2847 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e discussed some of the necessary functions of the backdoor, including </div><div class="t m0 x3 hd y2848 ff4 fs7 fc0 sc0 lsb ws16">monitoring for specic actions that could be indicati<span class="_ _0"/>ve of an in<span class="_ _0"/>v<span class="_ _0"/>estigation, such as:</div><div class="t m0 x16 h1f y2849 ffb fse fc0 sc0 ls0 ws16">c</div><div class="t m0 x1 hd y284a ff4 fs7 fc0 sc0 ls0 ws0">Starting of specic ex<span class="_ _0"/>ecutables:</div><div class="t m0 x1 h1f y284b ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y284c ff4 fs7 fc0 sc0 ls0 ws0">taskmgr<span class="_ _2"/>.exe (task/process manager)</div><div class="t m0 x1 h1f y284d ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y284e ff4 fs7 fc0 sc0 ls0 ws0">regedit.e<span class="_ _0"/>xe (re<span class="_ _0"/>gistry editor )</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>