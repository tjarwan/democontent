<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf130" class="pf w2 h2" data-page-no="130"><div class="pc pc130 w2 h2"><div class="t m0 x2 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 8: Spear Phishing with Hardware T<span class="_ _0"/>rojans<span class="_ _9"> </span><span class="ff1 fs9 lsa">281</span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">Store. The Superuser app will allo<span class="_ _0"/>w you to grant and manage root pri<span class="_ _0"/>vileges to apps </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">that you install. <span class="_ _0"/>When an application requires root pri<span class="_ _0"/>vileges, the Superuser app will </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 ls0 ws0">prompt you and allo<span class="_ _0"/>w you to permit or deny the request. <span class="_ _0"/>That’<span class="_ _2"/>s it—your wakizashi </div><div class="t m0 x3 hd y210 ff4 fs7 fc0 sc0 ls0 ws0">phone is no<span class="_ _0"/>w rooted. Keep in mind that these steps w<span class="_ _0"/>ork for the K<span class="_ _0"/>yocera Event </div><div class="t m0 x3 hd y211 ff4 fs7 fc0 sc0 ls0 ws0">running <span class="_ _2"/>Android 4.0.4; in fact, the same process should work for many dif<span class="_ _0"/>ferent </div><div class="t m0 x3 hd y212 ff4 fs7 fc0 sc0 ls0 ws0">phones. The main dif<span class="_ _0"/>ference you might nd is that the Poot app may not ha<span class="_ _0"/>ve an </div><div class="t m0 x3 hd y213 ff4 fs7 fc0 sc0 ls0 ws0">exploit that w<span class="_ _0"/>orks for your phone or version of the operating system. If that is the </div><div class="t m0 x3 hd y1654 ff4 fs7 fc0 sc0 ls0 ws0">case, you’ll need to research an e<span class="_ _0"/>xploit that will work for your phone.</div><div class="t m0 x3 h7 y1cea ff1 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"/>akizashi Audio/Video Bug</div><div class="t m0 x3 hd y1ceb ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _3"/>o use the wakizashi as a bugging de<span class="_ _0"/>vice, we’ll simply install le<span class="_ _0"/>gitimate apps that </div><div class="t m0 x3 hd y1cec ff4 fs7 fc0 sc0 ls0 ws0">will allo<span class="_ _0"/>w us to remotely take pictures, vie<span class="_ _0"/>w video, or capture audio. <span class="_ _2"/>At the time of </div><div class="t m0 x3 hd y1ced ff4 fs7 fc0 sc0 ls0 ws0">writing, one of the best apps for this purpose is IP <span class="_ _0"/>W<span class="_ _3"/>ebcam by Pav<span class="_ _0"/>el Khlebovich. </div><div class="t m0 x3 hd y1cee ff4 fs7 fc0 sc0 ls0 ws0">Not surprisingly<span class="_ _2"/>, this turns your <span class="_ _0"/>Android phone into a web camera you can access </div><div class="t m0 x3 hd y1cef ff4 fs7 fc0 sc0 ls0 ws0">via Internet Protocol (IP)—more specically<span class="_ _2"/>, a web server run on your phone. <span class="_ _0"/>The </div><div class="t m0 x3 hd y1cf0 ff4 fs7 fc0 sc0 ls0 ws0">app allo<span class="_ _0"/>ws you to stream audio and video, and can be congured to start on device </div><div class="t m0 x3 hd y1cf1 ff4 fs7 fc0 sc0 ls0 ws0">boot. <span class="_ _0"/>When deployed in the eld, we would w<span class="_ _0"/>ant to at least set a password on the </div><div class="t m0 x3 hd y1cf2 ff4 fs7 fc0 sc0 ls0 ws0">phone so that anyone who obtains the phone is not lik<span class="_ _0"/>ely to be able to access any </div><div class="t m0 x3 hd y1cf3 ff4 fs7 fc0 sc0 ls0 ws0">data on it. If we’<span class="_ _2"/>re especially concerned, we can encrypt the device; ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, this </div><div class="t m0 x3 hd y1cf4 ff4 fs7 fc0 sc0 ls0 ws0">would require the passcode to be entered an<span class="_ _0"/>y time the device is booted.</div><div class="t m0 x4 hd y1cf5 ff4 fs7 fc0 sc0 ls0 ws0">The IP address can be that of the cellular network connection or the wireless </div><div class="t m0 x3 hd y1cf6 ff4 fs7 fc0 sc0 ls0 ws0">network connection. <span class="_ _0"/>Thus, for better performance, you could either connect to a </div><div class="t m0 x3 hd y1cf7 ff4 fs7 fc0 sc0 ls0 ws0">wireless network with an Internet connection or create an ad hoc network with the </div><div class="t m0 x3 hd y1cf8 ff4 fs7 fc0 sc0 ls0 ws0">phone and your monitoring de<span class="_ _0"/>vice.</div><div class="t m0 x4 hd y1cf9 ff4 fs7 fc0 sc0 lsb ws16">The default web serv<span class="_ _0"/>er runs on port 8080, so to access the web server<span class="_ _0"/>, na<span class="_ _0"/>vigate to </div><div class="t m0 x3 hd y1cfa ff4 fs7 fc0 sc0 ls0 ws0">http://IP-ADDRESS:8080. If you are not on the same wireless network as the phone, </div><div class="t m0 x3 hd y1cfb ff4 fs7 fc0 sc0 ls0 ws0">you’ll ha<span class="_ _0"/>ve to access the phone remotely<span class="_ _3"/>. W<span class="_ _3"/>e’ll cov<span class="_ _0"/>er exible ways of doing this in </div><div class="t m0 x3 hd y1cfc ff4 fs7 fc0 sc0 ls0 ws0">the next section.</div><div class="t m0 x4 hd y1cfd ff4 fs7 fc0 sc0 ls0 ws0">The video produced by this phone is surprisingly good and will often be more </div><div class="t m0 x3 hd y1cfe ff4 fs7 fc0 sc0 ls0 ws0">than sufcient for video bugging. Lik<span class="_ _0"/>e traditional bugs, v<span class="_ _0"/>oice b<span class="_ _0"/>ugging can be a little </div><div class="t m0 x3 hd y1cff ff4 fs7 fc0 sc0 ls0 ws0">difcult if the communication is not done relati<span class="_ _0"/>vely close to the microphone.</div><div class="t m0 x3 h7 y1d00 ff1 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"/>akizashi Remote Access</div><div class="t m0 x3 hd y1d01 ff4 fs7 fc0 sc0 ls0 ws0">Once our wakizashi is rooted, we ha<span class="_ _0"/>ve man<span class="_ _0"/>y options av<span class="_ _0"/>ailable to remotely access </div><div class="t m0 x3 hd y1d02 ff4 fs7 fc0 sc0 ls0 ws0">the phone. One of the most exible w<span class="_ _0"/>ays to do this is by establishing a Secure Shell </div><div class="t m0 x3 hd y1d03 ff4 fs7 fc0 sc0 ls0 ws0">(SSH) tunnel to the phone, allo<span class="_ _0"/>wing us to forward any ports we choose from our </div><div class="t m0 x3 hd y1d04 ff4 fs7 fc0 sc0 ls0 ws0">system to the phone.</div><div class="t m0 x4 hd y1d05 ff4 fs7 fc0 sc0 ls0 ws0">Many SSH apps are a<span class="_ _0"/>v<span class="_ _0"/>ailable for <span class="_ _2"/>Android—SSHDroid is basic and works well. </div><div class="t m0 x3 hd y1d06 ff4 fs7 fc0 sc0 ls0 ws0">Open the app, congure any options such as autostart and an SSH port, and you’<span class="_ _2"/>re </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>