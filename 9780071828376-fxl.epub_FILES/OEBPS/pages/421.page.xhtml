<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf1a5" class="pf w2 h2" data-page-no="1a5"><div class="pc pc1a5 w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">398<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 h40 ya7f fff fs5 fc0 sc0 ls0 ws0">  create_dir_success = YES;</div><div class="t m0 x3 h40 ya80 fff fs5 fc0 sc0 ls0 ws0"> }</div><div class="t m0 x3 h40 ya81 fff fs5 fc0 sc0 ls0 ws0"> else</div><div class="t m0 x3 h40 ya82 fff fs5 fc0 sc0 ls0 ws0"> {</div><div class="t m0 x3 h40 y259c fff fs5 fc0 sc0 ls0 ws0">  // directory creation failed, find out why</div><div class="t m0 x3 h40 y259d fff fs5 fc0 sc0 ls0 ws0">  if (GetLastError() == ERROR_ALREADY_EXISTS) </div><div class="t m0 x3 h40 y259e fff fs5 fc0 sc0 ls0 ws0">  {</div><div class="t m0 x3 h40 y259f fff fs5 fc0 sc0 ls0 ws0">   /* curDir Directory already exists lets see if</div><div class="t m0 x3 h40 y25a0 fff fs5 fc0 sc0 ls0 ws0">   we have write access to the directory */</div><div class="t m0 x3 h40 y25a1 fff fs5 fc0 sc0 ls0 ws0">   strcat( curDir, "\\"); // add final backslash for directory</div><div class="t m0 x3 h40 y25a2 fff fs5 fc0 sc0 ls0 ws0">   strcat(canaryPath, curDir);</div><div class="t m0 x3 h40 y25a3 fff fs5 fc0 sc0 ls0 ws0">   strcat(canaryPath, CANARY_FILE_NAME);</div><div class="t m0 x3 h40 y25a4 fff fs5 fc0 sc0 ls0 ws0">   printf ("Canary file is %s\n", canaryPath);</div><div class="t m0 x3 h40 y25a5 fff fs5 fc0 sc0 ls0 ws0">   if( ( canaryFile=fopen( canaryPath , "w")) != NULL )</div><div class="t m0 x3 h40 y25a6 fff fs5 fc0 sc0 ls0 ws0">   {</div><div class="t m0 x3 h40 y25a7 fff fs5 fc0 sc0 ls0 ws0">    /*Canary file creation success */</div><div class="t m0 x3 h40 y25a8 fff fs5 fc0 sc0 ls0 ws0">    strcat(outDirName, curDir);</div><div class="t m0 x3 h40 y25a9 fff fs5 fc0 sc0 ls0 ws0">    fclose(canaryFile);</div><div class="t m0 x3 h40 y25aa fff fs5 fc0 sc0 ls0 ws0">    create_dir_success = YES;</div><div class="t m0 x3 h40 y25ab fff fs5 fc0 sc0 ls0 ws0">   } </div><div class="t m0 x3 h40 y25ac fff fs5 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x3 h40 y25ad fff fs5 fc0 sc0 ls0 ws0"> } /* END PATH_ONE TEST */</div><div class="t m0 x3 h40 y25ae fff fs5 fc0 sc0 ls0 ws0"> /* createdirectory failed and it does not already exist, try different </div><div class="t m0 x3 h40 y25af fff fs5 fc0 sc0 ls0 ws0">directory */</div><div class="t m0 x3 h40 y25b0 fff fs5 fc0 sc0 ls0 ws0"> if( create_dir_success == NO )</div><div class="t m0 x3 h40 y25b1 fff fs5 fc0 sc0 ls0 ws0"> {</div><div class="t m0 x3 h40 y25b2 fff fs5 fc0 sc0 ls0 ws0">  int evCode = 0;</div><div class="t m0 x3 h40 y25b3 fff fs5 fc0 sc0 ls0 ws0">  memset( curDir, '\0', sizeof(curDir) );</div><div class="t m0 x3 h40 y25b4 fff fs5 fc0 sc0 ls0 ws0">  evCode = GetEnvironmentVariable( "USERPROFILE", curDir, sizeof(curDir));</div><div class="t m0 x3 h40 y25b5 fff fs5 fc0 sc0 ls0 ws0">  if( evCode != 0)</div><div class="t m0 x3 h40 y25b6 fff fs5 fc0 sc0 ls0 ws0">  {</div><div class="t m0 x3 h40 y25b7 fff fs5 fc0 sc0 ls0 ws0">   /* Add user defined foldername to environment variable USERPROFILE */</div><div class="t m0 x3 h40 y25b8 fff fs5 fc0 sc0 ls0 ws0">   strcat( curDir, "\\"); // add final backslash for directory</div><div class="t m0 x3 h40 y25b9 fff fs5 fc0 sc0 ls0 ws0">   strcat( curDir, BD_FOLDERNAME ); </div><div class="t m0 x3 h40 y25ba fff fs5 fc0 sc0 ls0 ws0">  }</div><div class="t m0 x3 h40 y25bb fff fs5 fc0 sc0 ls0 ws0">  if ( CreateDirectory( curDir ,NULL) != 0) </div><div class="t m0 x3 h40 y25bc fff fs5 fc0 sc0 ls0 ws0">  {</div><div class="t m0 x3 h40 y25bd fff fs5 fc0 sc0 ls0 ws0">   // this directory can be used</div><div class="t m0 x3 h40 y25be fff fs5 fc0 sc0 ls0 ws0">   strcat( curDir, "\\"); // add final backslash for directory</div><div class="t m0 x3 h40 y25bf fff fs5 fc0 sc0 ls0 ws0">   strcat( outDirName, curDir );</div><div class="t m0 x3 h40 y25c0 fff fs5 fc0 sc0 ls0 ws0">  }</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>