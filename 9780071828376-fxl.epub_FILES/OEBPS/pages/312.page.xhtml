<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf138" class="pf w2 h2" data-page-no="138"><div class="pc pc138 w2 h2"><img class="bi xaf y1d7b w4 h7c" alt="" src="bg138.png"/><div class="t m0 x2 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 8: Spear Phishing with Hardware T<span class="_ _0"/>rojans<span class="_ _9"> </span><span class="ff1 fs9 lsa">289</span></div><div class="t m0 x3 hd y1d7c ff4 fs7 fc0 sc0 ls0 ws0">fe<span class="_ _0"/>w av<span class="_ _0"/>ors, with the main dif<span class="_ _0"/>ference being the amount of onboard storage, RAM, </div><div class="t m0 x3 hd y1d7d ff4 fs7 fc0 sc0 ls0 ws0">and number of contacts. The base <span class="_ _0"/>T<span class="_ _2"/>eensy 2.0 model comes with about 32K of ash </div><div class="t m0 x3 hd y1d7e ff4 fs7 fc0 sc0 ls0 ws0">memory and 25 input/output pins. The pins allo<span class="_ _0"/>w us to e<span class="_ _0"/>xpand the functionality of </div><div class="t m0 x3 hd y1d7f ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _2"/>eensy by soldering additional hardware. <span class="_ _0"/>That might not sound like a lot of memory<span class="_ _2"/>, </div><div class="t m0 x3 hd y1d80 ff4 fs7 fc0 sc0 ls0 ws0">but for our purposes, it’<span class="_ _2"/>s plenty<span class="_ _2"/>.</div><div class="t m0 x4 hd y1d81 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e will congure T<span class="_ _2"/>eensy to operate as a USB HID device, or human interf<span class="_ _0"/>ace </div><div class="t m0 x3 hd y1d82 ff4 fs7 fc0 sc0 ls0 ws0">de<span class="_ _0"/>vice, in our case, a keyboard. <span class="_ _0"/>This will allo<span class="_ _0"/>w us to programmatically “type” </div><div class="t m0 x3 hd y1d83 ff4 fs7 fc0 sc0 ls0 ws0">anything we choose. <span class="_ _2"/>At rst glance, that might not seem like the easiest system to </div><div class="t m0 x3 hd y1d84 ff4 fs7 fc0 sc0 ls0 ws0">use to compromise a system, but it can be e<span class="_ _0"/>xtremely versatile. One of the biggest </div><div class="t m0 x3 hd y1d85 ff4 fs7 fc0 sc0 ls0 ws0">benets for us is that it doesn’t rely on an<span class="_ _0"/>y special software being installed on </div><div class="t m0 x3 hd y1d86 ff4 fs7 fc0 sc0 lsb ws16">the computer<span class="_ _0"/>, and the method of e<span class="_ _0"/>xploitation will work almost regardless of the </div><div class="t m0 x3 hd y1d87 ff4 fs7 fc0 sc0 ls0 ws0">conguration of the system and autorun settings.</div><div class="t m0 x4 hd y1d88 ff4 fs7 fc0 sc0 ls0 ws0">Although we might hav<span class="_ _0"/>e pre<span class="_ _0"/>viously attempted to use autorun to launch our </div><div class="t m0 x3 hd y1d89 ff4 fs7 fc0 sc0 ls0 ws0">backdoor on a USB dri<span class="_ _0"/>ve or CD by using a HID de<span class="_ _0"/>vice, there is no autorun setting </div><div class="t m0 x3 hd y1d8a ff4 fs7 fc0 sc0 ls0 ws0">that could potentially stop our backdoor from automatically ex<span class="_ _0"/>ecuting. <span class="_ _0"/>W<span class="_ _2"/>e can use </div><div class="t m0 x3 hd y1d8b ff4 fs7 fc0 sc0 ls0 ws0">this ke<span class="_ _0"/>yboard functionality to type out commands and ev<span class="_ _0"/>en transfer binary payloads </div><div class="t m0 x3 hd y1d8c ff4 fs7 fc0 sc0 ls0 ws0">in an ingenious way<span class="_ _2"/>.</div><div class="t m0 x4 hd y1d8d ff4 fs7 fc0 sc0 lsb ws16">It is becoming much more common for organizations to block access to USB </div><div class="t m0 x3 hd y1d8e ff4 fs7 fc0 sc0 ls0 ws0">storage de<span class="_ _0"/>vices because of the increased awareness of the potential dangers, not </div><div class="t m0 x3 hd y1d8f ff4 fs7 fc0 sc0 ls0 ws0">only from infected dri<span class="_ _0"/>ves, b<span class="_ _0"/>ut also because users can easily exltrate lar<span class="_ _0"/>ge amounts </div><div class="t m0 x3 hd y1d90 ff4 fs7 fc0 sc0 ls0 ws0">of data. <span class="_ _0"/>Whene<span class="_ _0"/>ver a USB de<span class="_ _0"/>vice is plugged into a computer<span class="_ _0"/>, the type of de<span class="_ _0"/>vice is </div><div class="t m0 x3 h21 y1d91 ff1 fs2 fc0 sc0 ls0 ws0">Figure 8-9<span class="_ _21"> </span><span class="ffc">T<span class="_ _3"/>eensy 2.0 programmable USB board</span></div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>