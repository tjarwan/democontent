<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf9e" class="pf w2 h2" data-page-no="9e"><div class="pc pc9e w2 h2"><img class="bi xaf yec4 w4 h56" alt="" src="bg9e.png"/><div class="t m0 x5d h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 5: Reconnaissance: Nontechnical Data<span class="_ _9"> </span><span class="ff1 fs9 lsa">135</span></div><div class="t m0 x4 hd yec5 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou should also note that just because you don’t see the exact search term you </div><div class="t m0 x3 hd yec6 ff4 fs7 fc0 sc0 ls0 ws0">used in the address bar doesn’t mean the v<span class="_ _0"/>ariable is not sent as a GET request. </div><div class="t m0 x3 hd yec7 ff4 fs7 fc0 sc0 ls0 ws0">As you can see in Figure 5-3, while it does not contain the word FOOB<span class="_ _0"/>AR, if we </div><div class="t m0 x3 hd yec8 ff4 fs7 fc0 sc0 ls0 ws0">decode the base64 string 'Rk9PQkFSCg==' we’<span class="_ _2"/>d see that it’<span class="_ _0"/>s simply our search term </div><div class="t m0 x3 hd yec9 ff4 fs7 fc0 sc0 ls0 ws0">encoded as base64. </div><div class="t m0 x4 hd yeca ff4 fs7 fc0 sc0 ls0 ws0">There are many times when our search term might actually be in the GET request; </div><div class="t m0 x3 hd yecb ff4 fs7 fc0 sc0 ls0 ws0">ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, it’<span class="_ _2"/>s obfuscated in a way that makes it difcult to script the searches. </div><div class="t m0 x3 hd yecc ff4 fs7 fc0 sc0 ls0 ws0">Often, this obfuscation isn’t in place as a security measure; instead, it’<span class="_ _2"/>s just the way </div><div class="t m0 x3 hd yecd ff4 fs7 fc0 sc0 ls0 ws0">the programmer of the web application chose to write the page. For e<span class="_ _0"/>xample, the </div><div class="t m0 x3 hd yece ff4 fs7 fc0 sc0 ls0 ws0">programmer might hav<span class="_ _0"/>e chosen to concatenate a timestamp, unique identier<span class="_ _0"/>, and </div><div class="t m0 x3 hd yecf ff4 fs7 fc0 sc0 ls0 ws0">the search term and submit these as one v<span class="_ _0"/>ariable or split them among a few v<span class="_ _0"/>ariables.</div><div class="t m0 x4 hd yed0 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can also simply look at the HTML of the web page to see how the form </div><div class="t m0 x3 hd yed1 ff4 fs7 fc0 sc0 ls0 ws0">functions—typically<span class="_ _2"/>, the method will be shown with a “form” eld, such as “&lt;form </div><div class="t m0 x3 hd yed2 ff4 fs7 fc0 sc0 ls0 ws0">method=POST action=search.php&gt;.<span class="_ _2"/>” Sometimes, you’ll also be able to identify </div><div class="t m0 x3 hd yed3 ff4 fs7 fc0 sc0 ls0 ws0">some obfuscation or encoding techniques that are performed on the client side, for </div><div class="t m0 x3 hd yed4 ff4 fs7 fc0 sc0 ls0 ws0">example, with Ja<span class="_ _0"/>v<span class="_ _0"/>aScript. In either case, we can still script the searching process, but </div><div class="t m0 x3 hd yed5 ff4 fs7 fc0 sc0 ls0 ws0">stateful pages require a little more work. In the follo<span class="_ _0"/>wing code, we’<span class="_ _2"/>re using a simple </div><div class="t m0 x3 h3f yed6 ff4 fs7 fc0 sc0 ls0 ws0">bash script and the <span class="fff">wget</span> command to loop through e<span class="_ _0"/>very letter of the alphabet, </div><div class="t m0 x3 hd yed7 ff4 fs7 fc0 sc0 ls0 ws0">send this as the search term to the remote server<span class="_ _2"/>, and save all the output to a single </div><div class="t m0 x3 hd yed8 ff4 fs7 fc0 sc0 ls0 ws0">document titled with the search term:</div><div class="t m0 x3 h44 yed9 fff fse fc0 sc0 ls0 ws0">#!/bin/bash</div><div class="t m0 x3 h44 yeda fff fse fc0 sc0 ls0 ws0">for x in {a..z}</div><div class="t m0 x3 h44 yedb fff fse fc0 sc0 ls0 ws0">do</div><div class="t m0 x3 h44 yedc fff fse fc0 sc0 ls0 ws0">    echo "wget http://weaktarget.com/directory/search.php?=$x </div><div class="t m0 x3 h44 yedd fff fse fc0 sc0 ls0 ws0">--output-document=$x.html"</div><div class="t m0 x3 h44 yede fff fse fc0 sc0 ls0 ws0">done</div><div class="t m0 x3 h21 yedf ff1 fs2 fc0 sc0 ls0 ws0">Figure 5-2<span class="_ _21"> </span><span class="ffc">HTTP GET request shown in URL</span></div><div class="t m0 x3 h21 yee0 ff1 fs2 fc0 sc0 ls0 ws0">Figure 5-3<span class="_ _21"> </span><span class="ffc">HTTP GET request is encoded in URL.</span></div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>