<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf75" class="pf w2 h2" data-page-no="75"><div class="pc pc75 w2 h2"><div class="t m0 x5c h10 y83 ff1 fs9 fc0 sc0 lsa ws0">94<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 h40 ya7f fff fs5 fc0 sc0 ls0 ws0">;; Query time: 53 msec</div><div class="t m0 x3 h40 ya80 fff fs5 fc0 sc0 ls0 ws0">;; SERVER: 8.8.8.8#53(8.8.8.8)</div><div class="t m0 x3 h40 ya81 fff fs5 fc0 sc0 ls0 ws0">;; WHEN: Thu Dec 12 19:55:11 2013</div><div class="t m0 x3 h40 ya82 fff fs5 fc0 sc0 ls0 ws0">;; MSG SIZE  rcvd: 74</div><div class="t m0 x3 h40 ya83 fff fs5 fc0 sc0 ls0 ws0">user@kali:$</div><div class="t m0 x4 hd ya84 ff4 fs7 fc0 sc0 ls0 ws0">In the next output, you can see a similar query to the same DNS serv<span class="_ _0"/>er; ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, </div><div class="t m0 x3 hd ya85 ff4 fs7 fc0 sc0 ls0 ws0">this time, we query for a record we don’t think e<span class="_ _0"/>xists. <span class="_ _0"/>W<span class="_ _3"/>e did this just to show what </div><div class="t m0 x3 hd ya86 ff4 fs7 fc0 sc0 ls0 ws0">an answer would look like for a record that w<span class="_ _0"/>as not cached. If you compare the </div><div class="t m0 x3 hd ya87 ff4 fs7 fc0 sc0 ls0 ws0">two results, you’ll see that in this e<span class="_ _0"/>xample, there is no <span class="_ _2"/>Answer section. Thus, this </div><div class="t m0 x3 hd ya88 ff4 fs7 fc0 sc0 ls0 ws0">requested record was not cached by the tar<span class="_ _0"/>get DNS server<span class="_ _2"/>.</div><div class="t m0 x3 h44 ya89 fff fse fc0 sc0 ls0 ws0">user@kali:$ dig @8.8.8.8 fake12345.thiscantexist.com A +norecurse</div><div class="t m0 x3 h44 ya8a fff fse fc0 sc0 ls0 ws0">; &lt;&lt;&gt;&gt; DiG 9.8.4-rpz2+rl005.12-P1 &lt;&lt;&gt;&gt; @8.8.8.8 fake12345.</div><div class="t m0 x3 h44 ya8b fff fse fc0 sc0 ls0 ws0">thiscantexist.com A </div><div class="t m0 x3 h44 ya8c fff fse fc0 sc0 ls0 ws0">+norecurse</div><div class="t m0 x3 h44 ya8d fff fse fc0 sc0 ls0 ws0">; (1 server found)</div><div class="t m0 x3 h44 ya8e fff fse fc0 sc0 ls0 ws0">;; global options: +cmd</div><div class="t m0 x3 h44 ya8f fff fse fc0 sc0 ls0 ws0">;; Got answer:</div><div class="t m0 x3 h44 ya90 fff fse fc0 sc0 ls0 ws0">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 25131</div><div class="t m0 x3 h44 ya91 fff fse fc0 sc0 ls0 ws0">;; flags: qr ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0</div><div class="t m0 x3 h44 ya92 fff fse fc0 sc0 ls0 ws0">;; QUESTION SECTION:</div><div class="t m0 x3 h44 ya93 fff fse fc0 sc0 ls0 ws0">;fake12345.thiscantexist.com. IN   A</div><div class="t m0 x3 h44 ya94 fff fse fc0 sc0 ls0 ws0">;; Query time: 53 msec</div><div class="t m0 x3 h44 ya95 fff fse fc0 sc0 ls0 ws0">;; SERVER: 8.8.8.8#53(8.8.8.8)</div><div class="t m0 x3 h44 ya96 fff fse fc0 sc0 ls0 ws0">;; WHEN: Thu Dec 12 19:57:23 2013</div><div class="t m0 x3 h44 ya97 fff fse fc0 sc0 ls0 ws0">;; MSG SIZE  rcvd: 45</div><div class="t m0 x3 h44 ya98 fff fse fc0 sc0 ls0 ws0">user@kali:$</div><div class="t m0 x4 hd ya99 ff4 fs7 fc0 sc0 ls0 ws0">Luckily<span class="_ _2"/>, we can accomplish this much faster using the dnsrecon tool, as sho<span class="_ _0"/>wn in </div><div class="t m0 x3 hd ya9a ff4 fs7 fc0 sc0 ls0 ws0">the follo<span class="_ _0"/>wing example. In this case, we specify that we are e<span class="_ _0"/>xploiting the snooping </div><div class="t m0 x3 hd ya9b ff4 fs7 fc0 sc0 ls0 ws0">vulnerability on the ns1.weaktarget.com domain and attempting to look up the </div><div class="t m0 x3 hd ya9c ff4 fs7 fc0 sc0 ls0 ws0">domains in the websites.txt le. The real trick here is to use a v<span class="_ _0"/>ery good wordlist of </div><div class="t m0 x3 hd ya9d ff4 fs7 fc0 sc0 lsb ws16">potential target websites, so again, tak<span class="_ _0"/>e your time to think of a long list of sites and </div><div class="t m0 x3 hd ya9e ff4 fs7 fc0 sc0 ls0 ws0">resources to test for<span class="_ _2"/>.</div><div class="t m0 x3 h40 ya9f fff fs5 fc0 sc0 ls0 ws0">user@kali:$ dnsrecon.py -t snoop -n ns1.weaktarget.com -D ./websites.txt</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>