<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf84" class="pf w2 h2" data-page-no="84"><div class="pc pc84 w2 h2"><img class="bi x94 yc2e w6 h2e" alt="" src="bg84.png"/><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">109</span></div><div class="t m0 x3 h4c yb83 fff fs12 fc0 sc0 ls21 ws0">             -T&lt;0-5&gt;: Set timing template (higher is faster)</div><div class="t m0 x3 h4c yb84 fff fs12 fc0 sc0 ls21 ws0">             --min-hostgroup/max-hostgroup &lt;size&gt;: Parallel host scan group sizes</div><div class="t m0 x3 h4c yb85 fff fs12 fc0 sc0 ls21 ws0">             --min-parallelism/max-parallelism &lt;numprobes&gt;: Probe parallelization</div><div class="t m0 x3 h4c yb86 fff fs12 fc0 sc0 ls21 ws0">             --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout &lt;time&gt;: </div><div class="t m0 x3 h4c yb87 fff fs12 fc0 sc0 ls21 ws0">Specifies</div><div class="t m0 x3 h4c yc2f fff fs12 fc0 sc0 ls21 ws0">                 probe round trip time.</div><div class="t m0 x3 h4c yc30 fff fs12 fc0 sc0 ls21 ws0">             --max-retries &lt;tries&gt;: Caps number of port scan probe </div><div class="t m0 x3 h4c yc31 fff fs12 fc0 sc0 ls21 ws0">retransmissions.</div><div class="t m0 x3 h4c yc32 fff fs12 fc0 sc0 ls21 ws0">             --host-timeout &lt;time&gt;: Give up on target after this long</div><div class="t m0 x3 h4c yc33 fff fs12 fc0 sc0 ls21 ws0">             --scan-delay/--max-scan-delay &lt;time&gt;: Adjust delay between probes</div><div class="t m0 x3 h4c yc34 fff fs12 fc0 sc0 ls21 ws0">             --min-rate &lt;number&gt;: Send packets no slower than &lt;number&gt; per second</div><div class="t m0 x3 h4c yc35 fff fs12 fc0 sc0 ls21 ws0">             --max-rate &lt;number&gt;: Send packets no faster than &lt;number&gt; per second</div><div class="t m0 x4 hd yc36 ff4 fs7 fc0 sc0 ls0 ws0">One of the most important external systems we w<span class="_ _0"/>ant to identify are remote access </div><div class="t m0 x3 hd yc37 ff4 fs7 fc0 sc0 lsb ws16">systems. Things lik<span class="_ _0"/>e virtual priv<span class="_ _0"/>ate netw<span class="_ _0"/>ork (VPN) gatew<span class="_ _0"/>ays, remote access portals, </div><div class="t m0 x3 hd yc38 ff4 fs7 fc0 sc0 ls0 ws0">or remote system administration services will prov<span class="_ _0"/>e to be extremely important for </div><div class="t m0 x3 hd yc39 ff4 fs7 fc0 sc0 ls0 ws0">our future phases of attack.</div><div class="t m0 x94 h2f yc3a ffe fs9 fc0 sc0 ls0 ws0">NOTE</div><div class="t m0 x94 h14 yc3b ff9 fs7 fc0 sc0 ls0 ws0">There are many other techniques and tools for performing port scanning; however<span class="_ _2"/>, as an </div><div class="t m0 x94 h14 yc3c ff9 fs7 fc0 sc0 ls0 ws0">APT hacker<span class="_ _2"/>, you can focus on a few techniques that guarantee the quickest and most accurate </div><div class="t m0 x94 h14 yc3d ff9 fs7 fc0 sc0 ls0 ws0">results to obtain information to be used in our next attack.</div><div class="t m0 x4 hd yc3e ff4 fs7 fc0 sc0 ls0 ws0">The information obtained from port scanning is important for our next phase of </div><div class="t m0 x3 hd yc3f ff4 fs7 fc0 sc0 lsb ws16">spear phishing. For e<span class="_ _0"/>xample, if the target or<span class="_ _0"/>ganization has a remote access service </div><div class="t m0 x3 hd yc40 ff4 fs7 fc0 sc0 ls0 ws0">such as a <span class="_ _2"/>VPN service, we know that we can most likely focus on obtaining a v<span class="_ _0"/>alid </div><div class="t m0 x3 hd yc41 ff4 fs7 fc0 sc0 ls0 ws0">set of credentials from our phishing target, which we can then use to <span class="_ _2"/>VPN into the </div><div class="t m0 x3 hd yc42 ff4 fs7 fc0 sc0 lsb ws16">target or<span class="_ _0"/>ganization. If, on the other hand, no remote access services are a<span class="_ _0"/>vailable, we </div><div class="t m0 x3 hd yc43 ff4 fs7 fc0 sc0 ls0 ws0">might hav<span class="_ _0"/>e to change our attack strategy and focus on deli<span class="_ _0"/>v<span class="_ _0"/>ering a backdoor to our </div><div class="t m0 x3 hd yc44 ff4 fs7 fc0 sc0 ls0 ws0">phishing target that will pro<span class="_ _0"/>vide remote access to their system.</div><div class="t m0 x4 hd yc45 ff4 fs7 fc0 sc0 ls0 ws0">Other technical reconnaissance techniques might provide v<span class="_ _0"/>aluable information; </div><div class="t m0 x3 hd yc46 ff4 fs7 fc0 sc0 ls0 ws0">ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, at this stage, we’<span class="_ _2"/>re going to focus on the information that will help us in </div><div class="t m0 x3 hd yc47 ff4 fs7 fc0 sc0 ls0 ws0">the next planned phase of spear phishing attacks. It is important that you analyze all </div><div class="t m0 x3 hd yc48 ff4 fs7 fc0 sc0 ls0 ws0">of the results from port scanning the target netw<span class="_ _0"/>ork for any information that might </div><div class="t m0 x3 hd yc49 ff4 fs7 fc0 sc0 ls0 ws0">be usable in the next phase of attack. </div><div class="t m0 x4 hd yc4a ff4 fs7 fc0 sc0 ls0 ws0">For v<span class="_ _0"/>ery large netw<span class="_ _0"/>orks, we hav<span class="_ _0"/>e some ne<span class="_ _0"/>w options for fast and efcient </div><div class="t m0 x3 hd yc4b ff4 fs7 fc0 sc0 ls0 ws0">port scanning: masscan and ZMap. Masscan claims to be “the fastest Internet </div><div class="t m0 x3 hd yc4c ff4 fs7 fc0 sc0 ls0 ws0">port scanner<span class="_ _0"/>,<span class="_ _3"/>” and frankly I think they’<span class="_ _0"/>re right. <span class="_ _2"/>Although masscan’<span class="_ _0"/>s options are </div><div class="t m0 x3 hd yc4d ff4 fs7 fc0 sc0 ls0 ws0">some<span class="_ _0"/>what limited, the sheer speed and usefulness make it a must for your toolbox. </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>