<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf76" class="pf w2 h2" data-page-no="76"><div class="pc pc76 w2 h2"><img class="bi x94 yaa0 w6 h2e" alt="" src="bg76.png"/><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">95</span></div><div class="t m0 x4 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">Many technologies rely on DNS and may query the DNS serv<span class="_ _0"/>er automatically </div><div class="t m0 x3 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">for certain records. This can also be used to our adv<span class="_ _0"/>antage to determine if the tar<span class="_ _0"/>get </div><div class="t m0 x3 hd y19a ff4 fs7 fc0 sc0 lsb ws16">organization is using certain systems. F<span class="_ _0"/>or example, some Cisco wireless access </div><div class="t m0 x3 hd y291 ff4 fs7 fc0 sc0 ls0 ws0">points will automatically query for CISCO-L<span class="_ _2"/>W<span class="_ _1b"/>APP-CONTR<span class="_ _0"/>OLLER.localdomain </div><div class="t m0 x3 hd y424 ff4 fs7 fc0 sc0 ls0 ws0">to identify a wireless local area network (LAN) controller that will manage its </div><div class="t m0 x3 hd y425 ff4 fs7 fc0 sc0 ls0 ws0">conguration. Thus, if we query for this record and nd it cached, we can assume </div><div class="t m0 x3 hd y426 ff4 fs7 fc0 sc0 lsb ws16">there are some Cisco wireless access points on the target or<span class="_ _0"/>ganization’<span class="_ _2"/>s network.</div><div class="t m0 x4 hd y427 ff4 fs7 fc0 sc0 ls0 ws0">Like<span class="_ _0"/>wise, there are software solutions, such as anti<span class="_ _0"/>virus software, that will query </div><div class="t m0 x3 hd y428 ff4 fs7 fc0 sc0 ls0 ws0">for common DNS entries. For e<span class="_ _0"/>xample, Symantec Endpoint Protection might query </div><div class="t m0 x3 hd y429 ff4 fs7 fc0 sc0 ls0 ws0">for li<span class="_ _0"/>veupdate.symantec.com or li<span class="_ _0"/>veupdate.symantecli<span class="_ _0"/>v<span class="_ _0"/>eupdate.com. If we identify </div><div class="t m0 x3 hd yaa1 ff4 fs7 fc0 sc0 ls0 ws0">cached DNS records for these sites, we can assume there are at least some clients on </div><div class="t m0 x3 hd yaa2 ff4 fs7 fc0 sc0 ls0 ws0">the remote network with a Symantec product installed.</div><div class="t m0 x3 h4 yaa3 ff2 fs1 fc0 sc0 ls0 ws0">Border Gateway Protocol: An Over<span class="_ _1"/>view</div><div class="t m0 x3 hd yaa4 ff4 fs7 fc0 sc0 ls0 ws0">The Border Gate<span class="_ _0"/>way Protocol (BGP) is the primary routing protocol of the Internet. </div><div class="t m0 x3 hd y29c ff4 fs7 fc0 sc0 ls0 ws0">It allo<span class="_ _0"/>ws the decentralized and dynamic exchange of routing information on the </div><div class="t m0 x3 hd yaa5 ff4 fs7 fc0 sc0 ls0 ws0">Internet. This is ob<span class="_ _0"/>viously a critical component for the Internet to work properly<span class="_ _2"/>. </div><div class="t m0 x3 hd yaa6 ff4 fs7 fc0 sc0 ls0 ws0">BGP connects to peers using TCP port 179, which is dif<span class="_ _0"/>ferent from most dynamic </div><div class="t m0 x3 hd yaa7 ff4 fs7 fc0 sc0 ls0 ws0">routing protocols that rely on connectionless UDP or multicast for their connection </div><div class="t m0 x3 hd y593 ff4 fs7 fc0 sc0 ls0 ws0">to neighbors.</div><div class="t m0 x94 h2f y595 ffe fs9 fc0 sc0 ls0 ws0">NOTE</div><div class="t m0 x94 h14 yaa8 ff9 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _2"/>ou should understand that BGP is a large, important, and complex protocol. Entire books have </div><div class="t m0 x94 h14 yaa9 ff9 fs7 fc0 sc0 ls0 ws0">been written on it. Vulnerabilities have been identied in BGP that could make it a good target for </div><div class="t m0 x94 h14 yaaa ff9 fs7 fc0 sc0 ls0 ws0">exploitation; however<span class="_ _2"/>, we’re focusing on its use here as a source for important information for our </div><div class="t m0 x94 h14 yaab ff9 fs7 fc0 sc0 ls0 ws0">reconnaissance purposes. Obtaining a complete understanding of BGP in this book is impractical at </div><div class="t m0 x94 h14 yaac ff9 fs7 fc0 sc0 ls0 ws0">the very least. I highly recommend you do some additional research on the BGP protocol.</div><div class="t m0 x4 hd yaad ff4 fs7 fc0 sc0 lsb ws16">In Figure 4-5, our target or<span class="_ _0"/>ganization has two Internet connections to tw<span class="_ _0"/>o different </div><div class="t m0 x3 hd yaae ff4 fs7 fc0 sc0 ls0 ws0">ISPs. In this case, both service providers kno<span class="_ _0"/>w the<span class="_ _0"/>y can access the 1.2.3.0/24 subnet </div><div class="t m0 x3 hd yaaf ff4 fs7 fc0 sc0 ls0 ws0">for <span class="_ _0"/>W<span class="_ _3"/>eakT<span class="_ _2"/>arget ov<span class="_ _0"/>er their o<span class="_ _0"/>wn links. The service pro<span class="_ _0"/>viders then advertise that the<span class="_ _0"/>y </div><div class="t m0 x3 hd yab0 ff4 fs7 fc0 sc0 ls0 ws0">can both reach the <span class="_ _0"/>W<span class="_ _3"/>eakT<span class="_ _2"/>arget subnet. This means that an<span class="_ _0"/>y system on the Internet </div><div class="t m0 x3 hd yab1 ff4 fs7 fc0 sc0 ls0 ws0">attempting to reach the 1.2.3.0/24 subnet can do so through either the network </div><div class="t m0 x3 hd yab2 ff4 fs7 fc0 sc0 ls0 ws0">connection of Provider 1 or Pro<span class="_ _0"/>vider 2.</div><div class="t m0 x4 hd yab3 ff4 fs7 fc0 sc0 lsb ws16">T<span class="_ _3"/>ypically<span class="_ _0"/>, though, the BGP conguration for tar<span class="_ _0"/>get organizations will mak<span class="_ _0"/>e it so </div><div class="t m0 x3 hd yab4 ff4 fs7 fc0 sc0 ls0 ws0">that one of the provider connections will be preferred and the second will only be </div><div class="t m0 x3 hd yab5 ff4 fs7 fc0 sc0 ls0 ws0">used if the primary network connection goes do<span class="_ _0"/>wn, as sho<span class="_ _0"/>wn in Figure 4-6.</div><a class="" href="http://liveupdate.symantec.com"><div class="d m1" style="border-style:none;position:absolute;left:112.300287px;bottom:551.395314px;width:113.572700px;height:12.857000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://liveupdate.symantecliveupdate.com"><div class="d m1" style="border-style:none;position:absolute;left:263.473923px;bottom:553.122298px;width:161.430000px;height:11.429000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>