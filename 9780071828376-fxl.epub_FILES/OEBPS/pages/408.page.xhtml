<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf198" class="pf w2 h2" data-page-no="198"><div class="pc pc198 w2 h2"><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">385</span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">system that has ne<span class="_ _0"/>ver been seen before (e<span class="_ _0"/>xtremely unlikely<span class="_ _2"/>, but we’<span class="_ _0"/>ll giv<span class="_ _0"/>e the system </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">the benet of the doubt for this scenario).</div><div class="t m0 x4 hd y11e ff4 fs7 fc0 sc0 lsb ws16">An administrator recei<span class="_ _0"/>ves the alert from the NIDS system and in<span class="_ _0"/>v<span class="_ _0"/>estigates the </div><div class="t m0 x3 hd y11f ff4 fs7 fc0 sc0 lsb ws16">of<span class="_ _0"/>fending computer<span class="_ _0"/>. Upon in<span class="_ _2"/>vestigation, this is what he discov<span class="_ _0"/>ers:</div><div class="t m0 x16 h1f y2453 ffb fse fc0 sc0 ls0 ws16">c</div><div class="t m0 x1 hd y2454 ff4 fs7 fc0 sc0 ls0 ws0">The network communication is originating from an e<span class="_ _0"/>xecutable in the </div><div class="t m0 x1 hd y781 ff4 fs7 fc0 sc0 ls0 ws0">C:\Program Files\xfmanager\ directory<span class="_ _2"/>.</div><div class="t m0 x16 h1f y2455 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2456 ff4 fs7 fc0 sc0 lsb ws16">The end user explains to the in<span class="_ _2"/>vestigator that the xfmanager program in </div><div class="t m0 x1 hd y1fdf ff4 fs7 fc0 sc0 ls0 ws0">question is the XFinances Manager<span class="_ _0"/>, which is a critical part of the user’<span class="_ _2"/>s job </div><div class="t m0 x1 hd y1fe0 ff4 fs7 fc0 sc0 ls0 ws0">function.</div><div class="t m0 x16 h1f y1fe1 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1fe2 ff4 fs7 fc0 sc0 ls0 ws0">The ex<span class="_ _0"/>ecutable lename is xfupdate.ex<span class="_ _0"/>e.</div><div class="t m0 x16 h1f y2457 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2458 ff4 fs7 fc0 sc0 ls0 ws0">There are no indications of this ex<span class="_ _0"/>ecutable doing anything malicious.</div><div class="t m0 x1 h1f y2459 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y245a ff4 fs7 fc0 sc0 ls0 ws0">If you attempt to close the process, it prompts the user with a warning that </div><div class="t m0 x94 hd y245b ff4 fs7 fc0 sc0 ls0 ws0">the XFinances Manager will need to be updated manually if the program is </div><div class="t m0 x94 hd y245c ff4 fs7 fc0 sc0 ls0 ws0">closed.</div><div class="t m0 x1 h1f y245d ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y245e ff4 fs7 fc0 sc0 ls0 ws0">If the end user accepts the prompt, the process stays closed (does not </div><div class="t m0 x94 hd y245f ff4 fs7 fc0 sc0 ls0 ws0">auto-restart).</div><div class="t m0 x1 h1f y2460 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2461 ff4 fs7 fc0 sc0 ls0 ws0">Even though the process has a re<span class="_ _0"/>gistry entry to enable it to automatically </div><div class="t m0 x94 hd y2462 ff4 fs7 fc0 sc0 ls0 ws0">start, if you remov<span class="_ _0"/>e the registry entry<span class="_ _3"/>, it is not automatically re-created.</div><div class="t m0 x1 h1f y2463 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2464 ff4 fs7 fc0 sc0 ls0 ws0">All network communication is via HTTP to update.xf-software.com.</div><div class="t m0 x1 h1f y2465 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2466 ff4 fs7 fc0 sc0 ls0 ws0">Upon observing all HTTP trafc, it appears the software is querying the </div><div class="t m0 x94 hd y2467 ff4 fs7 fc0 sc0 ls0 ws0">server to see if an update is a<span class="_ _0"/>v<span class="_ _0"/>ailable.</div><div class="t m0 x1 h1f y2468 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2469 ff4 fs7 fc0 sc0 lsb ws16">If the in<span class="_ _0"/>v<span class="_ _0"/>estigator visits the update.xf-software.com website, it looks </div><div class="t m0 x94 hd y246a ff4 fs7 fc0 sc0 ls0 ws0">exactly lik<span class="_ _0"/>e the legitimate (xfsoftware.com) website complete with logos </div><div class="t m0 x94 hd y246b ff4 fs7 fc0 sc0 ls0 ws0">and appropriate text.</div><div class="t m0 x16 h1f y246c ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y246d ff4 fs7 fc0 sc0 lsb ws16">If the in<span class="_ _0"/>v<span class="_ _0"/>estigator is extremely unusual and decides he must be e<span class="_ _0"/>xtremely </div><div class="t m0 x1 hd y246e ff4 fs7 fc0 sc0 ls0 ws0">precautious, re<span class="_ _0"/>verse-engineer the e<span class="_ _0"/>xecutable, and understand e<span class="_ _0"/>very single byte </div><div class="t m0 x1 hd y246f ff4 fs7 fc0 sc0 ls0 ws0">of the program, here’<span class="_ _2"/>s what he would nd:</div><div class="t m0 x1 h1f y2470 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2471 ff4 fs7 fc0 sc0 ls0 ws31">The ex<span class="_ _0"/>ecutable queries only the specied remote server and only via HTTP<span class="_ _1b"/>.</div><div class="t m0 x1 h1f y2472 ffb fse fc0 sc0 ls0 ws31">c</div><div class="t m0 x94 hd y2473 ff4 fs7 fc0 sc0 ls0 ws0">If the HTTP response is a string containing “update=,<span class="_ _2"/>” the le specied </div><div class="t m0 x94 hd y2474 ff4 fs7 fc0 sc0 ls0 ws0">by a URL after the update parameter is do<span class="_ _0"/>wnloaded with an HTTP GET </div><div class="t m0 x94 hd y2475 ff4 fs7 fc0 sc0 ls0 ws0">request.</div><div class="t m0 x1 h1f y2476 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2477 ff4 fs7 fc0 sc0 ls0 ws0">The le is sav<span class="_ _0"/>ed in the same directory as the update software and e<span class="_ _0"/>xecuted.</div><div class="t m0 x1 h1f y2478 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2479 ff4 fs7 fc0 sc0 ls0 ws0">A log is created of the upgrade, and the ne<span class="_ _0"/>w version of the XFManager is </div><div class="t m0 x94 hd y247a ff4 fs7 fc0 sc0 ls0 ws0">marked in the re<span class="_ _0"/>gistry key for the XFManager<span class="_ _2"/>.</div><div class="t m0 x1 h1f y247b ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y247c ff4 fs7 fc0 sc0 ls0 ws0">The updater program then returns to normal operation.</div><a class="" href="http://xfsoftware.com"><div class="d m1" style="border-style:none;position:absolute;left:290.370370px;bottom:285.460317px;width:72.000000px;height:13.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>