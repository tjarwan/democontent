<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf73" class="pf w2 h2" data-page-no="73"><div class="pc pc73 w2 h2"><img class="bi x3c y327 w4 h47" alt="" src="bg73.png"/><div class="t m0 x3b h10 y83 ff1 fs9 fc0 sc0 lsa ws0">92<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x16 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">The main cav<span class="_ _0"/>eat here is that the DNS server must be congured to allo<span class="_ _0"/>w recursi<span class="_ _0"/>ve </div><div class="t m0 x3c hd y11d ff4 fs7 fc0 sc0 ls0 ws0">queries, which makes it vulnerable. Ho<span class="_ _0"/>we<span class="_ _0"/>ver<span class="_ _2"/>, I have seen this vulnerability at man<span class="_ _0"/>y </div><div class="t m0 x3c hd y11e ff4 fs7 fc0 sc0 lsb ws16">organizations. Man<span class="_ _0"/>y network administrators seem to think this is not a serious </div><div class="t m0 x3c hd y15c ff4 fs7 fc0 sc0 ls0 ws0">vulnerability that must be corrected. That is a great opportunity for us to use it to our </div><div class="t m0 x3c hd y15d ff4 fs7 fc0 sc0 ls0 ws0">adv<span class="_ _0"/>antage.</div><div class="t m0 x16 hd y15e ff4 fs7 fc0 sc0 ls0 ws0">If a DNS server does not ha<span class="_ _0"/>ve the answer to a query from a client, it can be </div><div class="t m0 x3c hd y15f ff4 fs7 fc0 sc0 ls0 ws0">congured to respond to a client in one of two basic modes: iterati<span class="_ _0"/>ve or recursi<span class="_ _0"/>v<span class="_ _0"/>e. </div><div class="t m0 x3c hd y160 ff4 fs7 fc0 sc0 ls0 ws0">An iterati<span class="_ _0"/>ve query is when the DNS serv<span class="_ _0"/>er responds with a list of other DNS servers </div><div class="t m0 x3c hd y161 ff4 fs7 fc0 sc0 ls0 ws0">that the client can then query directly<span class="_ _2"/>. <span class="_ _0"/>A recursi<span class="_ _0"/>v<span class="_ _0"/>e query occurs when the DNS server </div><div class="t m0 x3c hd y273 ff4 fs7 fc0 sc0 ls0 ws0">asks other DNS servers for the answer and returns the result directly to the client. </div><div class="t m0 x3c hd y274 ff4 fs7 fc0 sc0 ls0 ws0">Both of these request types are sho<span class="_ _0"/>wn in Figures 4-4(a) and 4-4(b).</div><div class="t m0 x16 hd y275 ff4 fs7 fc0 sc0 ls0 ws0">If the DNS server is congured for recursi<span class="_ _0"/>v<span class="_ _0"/>e queries, it might then cache that </div><div class="t m0 x3c hd y165 ff4 fs7 fc0 sc0 ls0 ws0">record to respond faster to an<span class="_ _0"/>y other clients that request that resource. This means </div><div class="t m0 x3c hd y166 ff4 fs7 fc0 sc0 ls0 ws0">that if we ask the DNS server for a record we kno<span class="_ _0"/>w it doesn’<span class="_ _0"/>t own and the DNS </div><div class="t m0 x3c h21 ya58 ff1 fs2 fc0 sc0 ls0 ws0">Figure 4-4<span class="_ _21"> </span><span class="ffc">Recursive and iterative DNS queries</span></div><div class="t m0 x3e h3e ya59 ffd fs10 fc0 sc0 ls0 ws0">1. Client Query; what is</div><div class="t m0 x3e h3e ya5a ffd fs10 fc0 sc0 ls0 ws27"> www.somesite.com</div><div class="t m0 x95 h3e ya5b ffd fs10 fc0 sc0 ls0 ws0">4. www.somesite.com is</div><div class="t m0 x95 h3e ya5c ffd fs10 fc0 sc0 ls0 ws27"> at <span class="_ _57"/>1.2.3.4</div><div class="t m0 x99 h3e ya59 ffd fs10 fc0 sc0 ls0 ws0">2. What is</div><div class="t m0 x99 h3e ya5a ffd fs10 fc0 sc0 ls0 ws27"> www.somesite.com</div><div class="t m0 x9a h3e ya5d ffd fs10 fc0 sc0 ls0 ws0">I don’t know, I’ll</div><div class="t m0 x9b h3e ya5e ffd fs10 fc0 sc0 ls0 ws0">go nd out</div><div class="t m0 x43 h48 ya5f ff10 fs10 fc0 sc0 ls0 ws0">Recursice DNS Query</div><div class="t m0 x3f h3e ya60 ffd fs10 fc0 sc0 ls0 ws0">3. www.somesite.com is</div><div class="t m0 x3f h3e ya61 ffd fs10 fc0 sc0 ls0 ws27"> at <span class="_ _57"/>1.2.3.4</div><div class="t m0 x9c h3e ya62 ffd fs10 fc0 sc0 ls0 ws0">DNS Server<span class="_ _58"> </span>DNS Server</div><div class="t m0 x89 h3e ya63 ffd fs10 fc0 sc0 ls0 ws0">Client</div><div class="t m0 x95 h3e ya64 ffd fs10 fc0 sc0 ls0 ws0"><span class="fc5 sc0">4. www.somesite.com is</span></div><div class="t m0 x95 h3e ya65 ffd fs10 fc0 sc0 ls0 ws27"><span class="fc5 sc0"> at </span><span class="_ _57"/><span class="fc5 sc0">1.2.3.4</span></div><div class="t m0 x3e h3e ya66 ffd fs10 fc0 sc0 ls0 ws0">1. Client Query; what is</div><div class="t m0 x3e h3e ya67 ffd fs10 fc0 sc0 ls0 ws27"> www.somesite.com</div><div class="t m0 x95 h3e ya68 ffd fs10 fc0 sc0 ls0 ws0">2. Idon’t know, but</div><div class="t m0 x95 h3e ya69 ffd fs10 fc0 sc0 ls0 ws0"> <span class="_ _59"> </span>you can ask 8.8.8.8</div><div class="t m0 x5b h48 ya6a ff10 fs10 fc0 sc0 ls0 ws0">Iterative DNS Query</div><div class="t m0 x3f h3e ya6b ffd fs10 fc0 sc0 ls0 ws0">3. What is</div><div class="t m0 x3f h3e ya6c ffd fs10 fc0 sc0 ls0 ws27"> www.somesite.com</div><div class="t m0 x9c h3e ya6d ffd fs10 fc0 sc0 ls0 ws0">DNS Server</div><div class="t m0 x2a h3e ya6e ffd fs10 fc0 sc0 ls0 ws0">DNS Server</div><div class="t m0 x2d h3e ya6f ffd fs10 fc0 sc0 ls0 ws0"><span class="fc5 sc0">8</span>.8.8.8</div><div class="t m0 x89 h3e ya70 ffd fs10 fc0 sc0 ls0 ws0">Client</div><div class="t m0 x22 h49 ya71 ff2 fse fc0 sc0 ls0 ws0">A</div><div class="t m0 x22 h49 ya72 ff2 fse fc0 sc0 ls0 ws0">B</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>