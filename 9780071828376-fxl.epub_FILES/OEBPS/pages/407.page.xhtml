<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf197" class="pf w2 h2" data-page-no="197"><div class="pc pc197 w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">384<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">create using these techniques will be prime examples of e<span class="_ _0"/>xploitless exploits. Instead </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">of relying on technical vulnerabilities, we will program our backdoor to perform </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 ls0 ws0">certain actions that appear normal and appropriate, keeping in mind what the end </div><div class="t m0 x3 hd y210 ff4 fs7 fc0 sc0 lsb ws16">user or in<span class="_ _0"/>v<span class="_ _0"/>estigators will see and what they will assume.</div><div class="t m0 x4 hd y120 ff4 fs7 fc0 sc0 ls0 ws0">As our backdoors will always be created with consideration for our enemies, there </div><div class="t m0 x3 hd y121 ff4 fs7 fc0 sc0 ls0 ws0">are three primary enemies we must consider when crafting our backdoor:</div><div class="t m0 x16 h1f y12b7 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y12b8 ff4 fs7 fc0 sc0 ls0 ws0">End users at the ke<span class="_ _0"/>yboard</div><div class="t m0 x16 h1f y12b9 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y12ba ff4 fs7 fc0 sc0 lsc ws17">Administrators or in<span class="_ _0"/>v<span class="_ _0"/>estigators</div><div class="t m0 x16 h1f y12bb ffb fse fc0 sc0 ls0 ws17">c</div><div class="t m0 x1 hd y12bc ff4 fs7 fc0 sc0 ls0 ws0">Anti-malware softw<span class="_ _0"/>are</div><div class="t m0 x4 hd y2436 ff4 fs7 fc0 sc0 ls0 ws0">Obviously<span class="_ _3"/>, we have to remain hidden from end users using the compromised </div><div class="t m0 x3 hd y2437 ff4 fs7 fc0 sc0 ls0 ws0">system and pre<span class="_ _0"/>vent them from being made a<span class="_ _0"/>ware that there is any security-</div><div class="t m0 x3 hd y2438 ff4 fs7 fc0 sc0 ls0 ws0">related issues with the system. Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, this is such a tri<span class="_ _0"/>vial task that we will not </div><div class="t m0 x3 hd y2439 ff4 fs7 fc0 sc0 ls0 ws0">necessarily cov<span class="_ _0"/>er anything to specically deal with end users. Instead, we’<span class="_ _0"/>ll abide </div><div class="t m0 x3 hd y243a ff4 fs7 fc0 sc0 ls0 ws0">by a fe<span class="_ _0"/>w general rules for av<span class="_ _0"/>oiding attention from the end user<span class="_ _0"/>, including waiting </div><div class="t m0 x3 hd y243b ff4 fs7 fc0 sc0 ls0 ws0">to perform any potentially “noisy” actions until there has been no input from the </div><div class="t m0 x3 hd y243c ff4 fs7 fc0 sc0 ls0 ws0">ke<span class="_ _0"/>yboard or mouse, stopping the activity if we notice input, and not performing </div><div class="t m0 x3 hd y243d ff4 fs7 fc0 sc0 ls0 ws0">anything that w<span class="_ _0"/>ould interfere with the end users’ “normal” operations.</div><div class="t m0 x4 hd y243e ff4 fs7 fc0 sc0 ls0 ws0">Anti-malware softw<span class="_ _0"/>are, which includes anti<span class="_ _0"/>virus software, host intrusion </div><div class="t m0 x3 hd y243f ff4 fs7 fc0 sc0 ls0 ws0">detection systems (HIDS), network intrusion detection systems (NIDS), and others, </div><div class="t m0 x3 hd y2440 ff4 fs7 fc0 sc0 ls0 ws0">must be accounted for and not made aw<span class="_ _0"/>are of our activities; ho<span class="_ _0"/>we<span class="_ _0"/>ver<span class="_ _2"/>, as with end </div><div class="t m0 x3 hd y2441 ff4 fs7 fc0 sc0 ls0 ws0">users, there is very little that must be done in a concerted w<span class="_ _0"/>ay to av<span class="_ _0"/>oid detection by </div><div class="t m0 x3 hd y2442 ff4 fs7 fc0 sc0 ls0 ws0">these systems.</div><div class="t m0 x4 hd y2443 ff4 fs7 fc0 sc0 ls0 ws0">Remember in our discussion of these systems in Chapter 1 that most of these </div><div class="t m0 x3 hd y2444 ff4 fs7 fc0 sc0 ls0 ws0">systems are signature based and thus easily bypassed by writing our unique software. </div><div class="t m0 x3 hd y2445 ff4 fs7 fc0 sc0 ls0 ws0">Even NIDS operate almost e<span class="_ _0"/>xclusi<span class="_ _0"/>vely on signatures. <span class="_ _2"/>Anomaly-based systems are </div><div class="t m0 x3 hd y2446 ff4 fs7 fc0 sc0 ls0 ws0">becoming more common; ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, the technology is not reliable enough to detect </div><div class="t m0 x3 hd y2447 ff4 fs7 fc0 sc0 ls0 ws0">the extremely small “anomalies” that we will introduce into the netw<span class="_ _0"/>ork.</div><div class="t m0 x4 hd y2448 ff4 fs7 fc0 sc0 ls0 ws0">Many of these systems, which are not e<span class="_ _0"/>xclusi<span class="_ _0"/>vely signature based, rely on </div><div class="t m0 x3 hd y2449 ff4 fs7 fc0 sc0 ls0 ws0">baselines of network acti<span class="_ _0"/>vity and can easily alert when large di<span class="_ _0"/>v<span class="_ _0"/>ersions from this </div><div class="t m0 x3 hd y244a ff4 fs7 fc0 sc0 ls0 ws0">baseline occur<span class="_ _0"/>, such as too much network trafc, certain kinds of trafc, or other </div><div class="t m0 x3 hd y244b ff4 fs7 fc0 sc0 ls0 ws0">glaring issues. Even if these systems “detect” our trafc that had ne<span class="_ _0"/>v<span class="_ _0"/>er been seen </div><div class="t m0 x3 hd y244c ff4 fs7 fc0 sc0 ls0 ws0">before, we will craft e<span class="_ _0"/>very element of our backdoor and communications to lead an </div><div class="t m0 x3 hd y244d ff4 fs7 fc0 sc0 lsb ws16">in<span class="_ _0"/>v<span class="_ _0"/>estigating party to believ<span class="_ _0"/>e that it is legitimate trafc.</div><div class="t m0 x4 hd y244e ff4 fs7 fc0 sc0 ls0 ws0">Let’<span class="_ _2"/>s consider an example backdoor that encompasses ev<span class="_ _0"/>erything we just </div><div class="t m0 x3 hd y244f ff4 fs7 fc0 sc0 ls0 ws0">described. Rather than utilizing rootkit functionality to hide the core components </div><div class="t m0 x3 hd y2450 ff4 fs7 fc0 sc0 ls0 ws0">of our backdoor<span class="_ _0"/>, which reports back to the command-and-control serv<span class="_ _0"/>er and </div><div class="t m0 x3 hd y2451 ff4 fs7 fc0 sc0 ls0 ws0">exltrates data, we choose to hide in plain sight. Let’<span class="_ _2"/>s ev<span class="_ _0"/>en assume that a heuristics </div><div class="t m0 x3 hd y2452 ff4 fs7 fc0 sc0 ls0 ws0">or anomaly-based NIDS has agged our network trafc because it is outbound to a </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>