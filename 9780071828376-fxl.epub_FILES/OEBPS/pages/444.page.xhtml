<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf1bc" class="pf w2 h2" data-page-no="1bc"><div class="pc pc1bc w2 h2"><img class="bi xaf y2082 w4 h9f" alt="" src="bg1bc.png"/><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">421</span></div><div class="t m0 x3 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">exit our backdoor<span class="_ _2"/>, and have the w<span class="_ _0"/>atchdog sleep for a specied period, after which it </div><div class="t m0 x3 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">checks if the process is still running and, if not, reloads our backdoor:</div><div class="t m0 x16 h1f y10ae ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y10af ff4 fs7 fc0 sc0 ls0 ws0">regedit.e<span class="_ _0"/>xe</div><div class="t m0 x16 h1f y10b0 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y10b1 ff4 fs7 fc0 sc0 ls0 ws0">regedt32.e<span class="_ _0"/>xe</div><div class="t m0 x16 h1f y10b2 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y10b3 ff4 fs7 fc0 sc0 ls0 ws0">taskmgr<span class="_ _2"/>.exe</div><div class="t m0 x3 h16 y27fd ff1 fsb fc0 sc0 ls0 ws0">Backdooring Legitimate Software</div><div class="t m0 x3 hd y27fe ff4 fs7 fc0 sc0 ls0 ws0">As a nal example, let’<span class="_ _2"/>s consider an extreme scenario where all of the <span class="_ _0"/>TCP and UDP </div><div class="t m0 x3 hd y27ff ff4 fs7 fc0 sc0 ls0 ws0">ports to and from a host are ltered, except for <span class="_ _0"/>TCP port 22 as sho<span class="_ _0"/>wn in Figure 10-2. </div><div class="t m0 x3 hd y2800 ff4 fs7 fc0 sc0 ls0 ws0">Port 22 is typically used for the Secure Shell (SSH), so let’<span class="_ _2"/>s see how we might be </div><div class="t m0 x3 hd y2801 ff4 fs7 fc0 sc0 ls0 ws0">able to backdoor a system and maintain communications in this scenario.</div><div class="t m0 x3 h21 y2802 ff1 fs2 fc0 sc0 ls0 ws0">Figure 10-2<span class="_ _21"> </span><span class="ffc">Firewall restricted host – only port 22 allowed (all por<span class="_ _1"/>ts rewalled except </span></div><div class="t m0 xf4 h21 y2803 ffc fs2 fc0 sc0 ls0 ws0">TCP 22)</div><div class="t m0 xe8 h22 y2804 ffd fs5 fc0 sc0 ls0 ws0">Internet</div><div class="t m0 x4f h22 y2805 ffd fs5 fc0 sc0 ls0 ws0">Firewall</div><div class="t m0 x4f h22 y2806 ffd fs5 fc0 sc0 ls0 ws0">1. Blocks all outbound communication</div><div class="t m0 x4f h22 y2807 ffd fs5 fc0 sc0 ls0 ws0">2. Allows only Port 22 for remote administration from the Internet</div><div class="t m0 xf5 h22 y2808 ffd fs5 fc0 sc0 ls0 ws0">Attacker</div><div class="t m0 xf6 h22 y2809 ffd fs5 fc0 sc0 ls0 ws0">Internal</div><div class="t m0 xbb h22 y280a ffd fs5 fc0 sc0 ls0 ws0">Network</div><div class="t m0 x1d h22 y280b ffd fs5 fc0 sc0 ls0 ws0">Target Host running</div><div class="t m0 x8c h22 y280c ffd fs5 fc0 sc0 ls0 ws0">only SSH Service</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>