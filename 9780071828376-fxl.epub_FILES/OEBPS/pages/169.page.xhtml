<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pfa9" class="pf w2 h2" data-page-no="a9"><div class="pc pca9 w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">146<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">so understanding what we just accomplished with the vi search and replace and the </div><div class="t m0 x3 h3f y11d fff fs7 fc0 sc0 ls0 ws0">grep<span class="ff4"> commands pre<span class="_ _0"/>viously is a good starting point. <span class="_ _0"/>W<span class="_ _2"/>e’ll focus on using the Perl </span></div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">language as well as the built-in re<span class="_ _0"/>gex functionality<span class="_ _3"/>.</div><div class="t m0 x3 h40 yfc5 fff fs5 fc0 sc0 ls0 ws0">&lt;A HREF="/directory/People/SmithJohn"&gt;Smith, John&lt;/A&gt;, VP of Sales&lt;BR&gt;</div><div class="t m0 x3 h40 yfc6 fff fs5 fc0 sc0 ls0 ws0">&lt;A HREF="/directory/People/SmithKim"&gt;Smith, Kim&lt;/A&gt;, Secretary to the </div><div class="t m0 x3 h40 yfc7 fff fs5 fc0 sc0 ls0 ws0">President&lt;BR&gt;</div><div class="t m0 x3 h40 yfc8 fff fs5 fc0 sc0 ls0 ws0">&lt;A HREF="/directory/People/SolomonJacob"&gt;Solomon, Jacob&lt;/A&gt;, Technical </div><div class="t m0 x3 h40 yfc9 fff fs5 fc0 sc0 ls0 ws0">Assistant II&lt;BR&gt;</div><div class="t m0 x4 hd yfca ff4 fs7 fc0 sc0 ls0 ws0">Here is another example of an actual structure I’<span class="_ _2"/>ve seen in an online directory<span class="_ _2"/>. </div><div class="t m0 x3 hd yfcb ff4 fs7 fc0 sc0 ls0 ws0">In this case, each entry is a link to a specic page for that person. <span class="_ _0"/>W<span class="_ _3"/>e have a fe<span class="_ _0"/>w </div><div class="t m0 x3 hd yfcc ff4 fs7 fc0 sc0 ls0 ws0">options here, not the least of which is to output all of the rele<span class="_ _0"/>vant links to a separate </div><div class="t m0 x3 hd yfcd ff4 fs7 fc0 sc0 ls0 ws0">le and then do<span class="_ _0"/>wnload the content of all the remote links just as we did before using </div><div class="t m0 x3 h3f yfce fff fs7 fc0 sc0 ls0 ws0">wget<span class="ff4">. <span class="_ _0"/>W<span class="_ _3"/>e would then perform the nal parsing of the user data from those les. </span></div><div class="t m0 x4 hd yfcf ff4 fs7 fc0 sc0 lsb ws16">Again, you will most likely e<span class="_ _0"/>xperience a unique format (if ev<span class="_ _0"/>en only slightly) </div><div class="t m0 x3 hd yfd0 ff4 fs7 fc0 sc0 lsb ws16">with each target or<span class="_ _0"/>ganization. Using the techniques we discussed pre<span class="_ _0"/>viously<span class="_ _2"/>, you </div><div class="t m0 x3 hd yfd1 ff4 fs7 fc0 sc0 ls0 ws0">should be able to tackle any format you encounter<span class="_ _2"/>.</div><div class="t m0 x3 h4 yfd2 ff2 fs1 fc0 sc0 ls0 ws0">Director<span class="_ _1"/>y Har<span class="_ _1"/>vesting HTML T<span class="_ _2"/>ables</div><div class="t m0 x3 hd yfd3 ff4 fs7 fc0 sc0 ls0 ws0">It is also common for data from personnel directories to be returned within HTML </div><div class="t m0 x3 hd yfd4 ff4 fs7 fc0 sc0 ls0 ws0">tables. In the follo<span class="_ _0"/>wing code, you’ll see another real-world e<span class="_ _0"/>xample of a personnel </div><div class="t m0 x3 hd yfd5 ff4 fs7 fc0 sc0 ls0 ws0">directory I’<span class="_ _2"/>ve seen. This is just two ro<span class="_ _0"/>ws from an HTML le with man<span class="_ _0"/>y entries in a </div><div class="t m0 x3 hd yfd6 ff4 fs7 fc0 sc0 ls0 ws0">single HTML table.</div><div class="t m0 x3 h40 yfd7 fff fs5 fc0 sc0 ls0 ws0">&lt;table&gt;</div><div class="t m0 x3 h40 yfd8 fff fs5 fc0 sc0 ls0 ws0">&lt;tr&gt;&lt;td&gt;</div><div class="t m0 x3 h40 yfd9 fff fs5 fc0 sc0 ls0 ws0">Smith, John</div><div class="t m0 x3 h40 yfda fff fs5 fc0 sc0 ls0 ws0">&lt;/td&gt;&lt;td&gt;</div><div class="t m0 x3 h40 yfdb fff fs5 fc0 sc0 ls0 ws0">&lt;a href="email-user.php?id=2976"&gt;email&lt;/a&gt;</div><div class="t m0 x3 h40 yfdc fff fs5 fc0 sc0 ls0 ws0">&lt;/td&gt;&lt;td&gt;555-1212&lt;/td&gt;&lt;td&gt;Student Solution Center&lt;/td&gt;&lt;td&gt;WeakTarget NYC </div><div class="t m0 x3 h40 yfdd fff fs5 fc0 sc0 ls0 ws0">Office&lt;/td&gt;&lt;td&gt;3rd floor&lt;/td&gt;</div><div class="t m0 x3 h40 yfde fff fs5 fc0 sc0 ls0 ws0">&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;</div><div class="t m0 x3 h40 yfdf fff fs5 fc0 sc0 ls0 ws0">Smith, Jason</div><div class="t m0 x3 h40 yfe0 fff fs5 fc0 sc0 ls0 ws0">&lt;/td&gt;&lt;td&gt;</div><div class="t m0 x3 h40 yfe1 fff fs5 fc0 sc0 ls0 ws0">&lt;a href="email-user.php?id=3615"&gt;email&lt;/a&gt;</div><div class="t m0 x3 h40 yfe2 fff fs5 fc0 sc0 ls0 ws0">&lt;/td&gt;&lt;td&gt;555-3434&lt;/td&gt;&lt;td&gt;Marketing Department&lt;/td&gt;&lt;td&gt;WeakTarget </div><div class="t m0 x3 h40 yfe3 fff fs5 fc0 sc0 ls0 ws0">Headquarters&lt;/td&gt;&lt;td&gt;4th floor&lt;/td&gt;</div><div class="t m0 x3 h40 yfe4 fff fs5 fc0 sc0 ls0 ws0">&lt;/tr&gt;</div><div class="t m0 x3 h40 yfe5 fff fs5 fc0 sc0 ls0 ws0">–-- SNIP –-</div><div class="t m0 x3 h40 yfe6 fff fs5 fc0 sc0 ls0 ws0">&lt;/table&gt;</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>