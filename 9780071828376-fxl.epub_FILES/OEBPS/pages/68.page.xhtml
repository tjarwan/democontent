<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf44" class="pf w2 h2" data-page-no="44"><div class="pc pc44 w2 h2"><div class="t m0 xa h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 2: Empirical Data<span class="_ _9"> </span><span class="ff1 fs9 lsa">45</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">If a certicate was signed by a certication<span class="_ _27"> </span>authority that used the MD5 hashing </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">algorithm, it is susceptible to collision attacks. <span class="_ _2"/>Apparently<span class="_ _0"/>, the authors of Flame </div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">discov<span class="_ _0"/>ered a Microsoft certicate that was not only signed using MD5, b<span class="_ _0"/>ut also </div><div class="t m0 x3 hd y15c ff4 fs7 fc0 sc0 ls0 ws0">was congured to allo<span class="_ _0"/>w signing of software. <span class="_ _0"/>This allo<span class="_ _0"/>wed the attackers to create a </div><div class="t m0 x3 hd y15d ff4 fs7 fc0 sc0 ls0 ws0">certicate with a public and pri<span class="_ _0"/>vate k<span class="_ _0"/>ey pair that the<span class="_ _0"/>y controlled, but yet were able to </div><div class="t m0 x3 hd y271 ff4 fs7 fc0 sc0 ls0 ws0">create a hash v<span class="_ _0"/>alue that was v<span class="_ _0"/>alid. Flame would then use this fraudulent certicate to </div><div class="t m0 x3 hd y272 ff4 fs7 fc0 sc0 ls0 ws0">sign ex<span class="_ _0"/>ecutables to be installed as <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws update packages.</div><div class="t m0 x4 hd y160 ff4 fs7 fc0 sc0 ls0 ws0">Initially<span class="_ _2"/>, Flame infected roughly 1,000 machines in the government, education, </div><div class="t m0 x3 hd y161 ff4 fs7 fc0 sc0 ls0 ws0">and pri<span class="_ _0"/>vate sectors. <span class="_ _0"/>Where do you think the majority of the infections were located? </div><div class="t m0 x3 hd y273 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou guessed it, Iran! <span class="_ _0"/>Although initially there was no direct indication of who w<span class="_ _0"/>as </div><div class="t m0 x3 hd y274 ff4 fs7 fc0 sc0 ls0 ws0">behind the attack, Kaspersky Labs analyzed the mal<span class="_ _0"/>ware and concluded that it </div><div class="t m0 x3 hd y275 ff4 fs7 fc0 sc0 ls0 ws0">had a “strong relationship” with Stuxnet. Most of this similarity was due to Flame </div><div class="t m0 x3 hd y276 ff4 fs7 fc0 sc0 ls0 ws0">exploiting some of the same zero-day vulnerabilities as Stuxnet. Kaspersk<span class="_ _0"/>y Labs </div><div class="t m0 x3 hd y277 ff4 fs7 fc0 sc0 ls0 ws0">found that Flame used the same LNK vulnerability as Stuxnet to infect USB dri<span class="_ _0"/>ves </div><div class="t m0 x3 hd y278 ff4 fs7 fc0 sc0 ls0 ws0">and auto-start installation of the worm on computers that used the dri<span class="_ _0"/>ve. Flame also </div><div class="t m0 x3 hd y279 ff4 fs7 fc0 sc0 ls0 ws0">used the same print spooler vulnerability as Stuxnet to copy itself to computers on </div><div class="t m0 x3 hd y5ea ff4 fs7 fc0 sc0 ls0 ws0">the local network.</div><div class="t m0 x4 hd y5eb ff4 fs7 fc0 sc0 ls0 ws0">Kaspersky Labs also performed an analysis of the types of les that Flame </div><div class="t m0 x3 hd y5ec ff4 fs7 fc0 sc0 ls0 ws0">was attempting to send to its command-and-control serv<span class="_ _0"/>ers and found that it was </div><div class="t m0 x3 hd y5ed ff4 fs7 fc0 sc0 ls0 ws0">specically seeking PDFs, text les, and <span class="_ _2"/>AutoCAD les. This also indicated Flame </div><div class="t m0 x3 hd y5ee ff4 fs7 fc0 sc0 ls0 ws0">was a general espionage toolkit and was not designed for a specic attack lik<span class="_ _0"/>e </div><div class="t m0 x3 hd y5ef ff4 fs7 fc0 sc0 lsb ws16">Stuxnet. Kaspersky Labs noted that after gaining media attention, those controlling </div><div class="t m0 x3 hd y5f0 ff4 fs7 fc0 sc0 ls0 ws0">Flame sent the “kill” command, which instructed Flame to remov<span class="_ _0"/>e all traces of itself </div><div class="t m0 x3 hd y5f1 ff4 fs7 fc0 sc0 ls0 ws0">from infected machines by securely wiping itself. In June 2012, approximately one </div><div class="t m0 x3 hd y5f2 ff4 fs7 fc0 sc0 lsb ws16">month after rst gaining media attention, a <span class="ff5 ls0 ws0">W<span class="_ _3"/>ashington P<span class="_ _2"/>ost<span class="ff4"> article re<span class="_ _0"/>vealed that </span></span></div><div class="t m0 x3 hd y5f3 ff4 fs7 fc0 sc0 ls0 ws0">Flame was de<span class="_ _0"/>veloped by the NSA, CIA, and the Israeli military at least v<span class="_ _0"/>e years </div><div class="t m0 x3 hd y5f4 ff4 fs7 fc0 sc0 ls0 ws0">prior as part of the Olympic Games project.</div><div class="t m0 x3 h7 y5f5 ff1 fs3 fc0 sc0 ls0 ws0">Antivirus Responses</div><div class="t m0 x3 hd y5f6 ff4 fs7 fc0 sc0 ls0 ws0">It’<span class="_ _2"/>s important to note that antivirus vendors create signatures to detect these w<span class="_ _0"/>orms </div><div class="t m0 x3 hd y5f7 ff4 fs7 fc0 sc0 ls0 ws0">as they are disco<span class="_ _0"/>vered. Ho<span class="_ _0"/>we<span class="_ _0"/>ver<span class="_ _2"/>, just because a vendor has a signature for a specic </div><div class="t m0 x3 hd y5f8 ff4 fs7 fc0 sc0 ls0 ws0">virus does not mean that hosts will not be infected with v<span class="_ _0"/>ariants of the virus. Even </div><div class="t m0 x3 hd y5f9 ff4 fs7 fc0 sc0 ls0 ws0">with such a small set of infected hosts, the Flame virus had many dif<span class="_ _0"/>ferent v<span class="_ _0"/>ariants. </div><div class="t m0 x3 hd y5fa ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _3"/>oday<span class="_ _0"/>, there are anti<span class="_ _0"/>virus signatures for v<span class="_ _0"/>ariants of Stuxnet, Duqu, and Flame.</div><div class="t m0 x4 hd y5fb ff4 fs7 fc0 sc0 ls0 ws0">In later chapters, you’ll learn just ho<span class="_ _0"/>w easy it is to a<span class="_ _0"/>void signature-based </div><div class="t m0 x3 hd y5fc ff4 fs7 fc0 sc0 ls0 ws0">technologies like anti<span class="_ _0"/>virus software. Ultimately<span class="_ _3"/>, antivirus software isn’<span class="_ _0"/>t really </div><div class="t m0 x3 hd y5fd ff4 fs7 fc0 sc0 ls0 ws0">stopping <span class="_ _2"/>APTs from using this malware, but it does mak<span class="_ _0"/>e it easier to identify who </div><div class="t m0 x3 hd y5fe ff4 fs7 fc0 sc0 ls0 ws0">is behind an attack in the future if you can determine that a worm is a v<span class="_ _0"/>ariant of </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>