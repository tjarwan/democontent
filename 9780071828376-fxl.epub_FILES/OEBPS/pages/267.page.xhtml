<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf10b" class="pf w2 h2" data-page-no="10b"><div class="pc pc10b w2 h2"><img class="bi x94 y1959 w6 h57" alt="" src="bg10b.png"/><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">244<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">connecti<span class="_ _0"/>vity<span class="_ _2"/>. These ne<span class="_ _0"/>w de<span class="_ _0"/>vices tend to get more and more absurd ev<span class="_ _0"/>ery year—just </div><div class="t m0 x3 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">check out the wireless bathroom scale! It’<span class="_ _2"/>s exciting to consider the horribly insecure </div><div class="t m0 x3 hd y174 ff4 fs7 fc0 sc0 lsb ws16">de<span class="_ _0"/>vices that will be created for us to easily hop into target or<span class="_ _0"/>ganizations in the future.</div><div class="t m0 x94 h2f yccb ffe fs9 fc0 sc0 ls0 ws16">NOTE</div><div class="t m0 x94 h14 yccc ff9 fs7 fc0 sc0 ls0 ws0">I have worked with some organizations that actually don’t allow wireless cards in their laptops </div><div class="t m0 x94 h14 yccd ff9 fs7 fc0 sc0 ls0 ws0">unless specically approved and controlled. However<span class="_ _2"/>, these organizations may forget the same </div><div class="t m0 x94 h14 y195a ff9 fs7 fc0 sc0 ls0 ws0">controls on the phones they choose to use.</div><div class="t m0 x4 hd yccf ff4 fs7 fc0 sc0 ls0 ws0">Our method of choice for compromising wireless clients is to create our o<span class="_ _0"/>wn </div><div class="t m0 x3 hd ycd0 ff4 fs7 fc0 sc0 ls0 ws0">access point that either client de<span class="_ _0"/>vices will connect to automatically or the end user </div><div class="t m0 x3 hd ycd1 ff4 fs7 fc0 sc0 ls0 ws0">will be incenti<span class="_ _0"/>vized to connect to. T<span class="_ _3"/>wo main elements are at play here that will allo<span class="_ _0"/>w </div><div class="t m0 x3 hd ycd2 ff4 fs7 fc0 sc0 ls0 ws0">us to exploit client de<span class="_ _0"/>vices. First, automated tasks are happening in the background </div><div class="t m0 x3 hd y195b ff4 fs7 fc0 sc0 ls0 ws0">without necessarily being initiated or visible to the person using the de<span class="_ _0"/>vice, and </div><div class="t m0 x3 hd y195c ff4 fs7 fc0 sc0 ls0 ws0">second, there are actions started by and visible to the user of the client de<span class="_ _0"/>vice.</div><div class="t m0 x94 h2f y195d ffe fs9 fc0 sc0 ls0 ws0">NOTE</div><div class="t m0 x94 h14 y195e ff9 fs7 fc0 sc0 ls0 ws0">If you’re unfamiliar with how much trafc is generated by client devices automatically<span class="_ _2"/>, I </div><div class="t m0 x94 h14 y195f ff9 fs7 fc0 sc0 ls0 ws0">recommend you capture all of the trafc generated by your devices upon connection to a wireless </div><div class="t m0 x94 h14 y1960 ff9 fs7 fc0 sc0 ls0 ws0">network, or better yet, sit at a coffee shop for ten minutes and see how much trafc you observe.</div><div class="t m0 x4 hd y1961 ff4 fs7 fc0 sc0 ls0 ws0">Once we hav<span class="_ _0"/>e positi<span class="_ _0"/>vely identied a client de<span class="_ _0"/>vice as belonging to the tar<span class="_ _0"/>get </div><div class="t m0 x3 hd y1962 ff4 fs7 fc0 sc0 lsb ws16">organization using the methods pre<span class="_ _0"/>viously discussed, we’ll w<span class="_ _0"/>ant to keep a record </div><div class="t m0 x3 hd y1963 ff4 fs7 fc0 sc0 ls0 ws0">of the MA<span class="_ _0"/>C addresses of these clients so that we can specically tar<span class="_ _0"/>get them in this </div><div class="t m0 x3 hd y1964 ff4 fs7 fc0 sc0 ls0 ws23">step. <span class="_ _0"/>W<span class="_ _3"/>e’ll actually be able to use this information to restrict which clients can access </div><div class="t m0 x3 hd y1965 ff4 fs7 fc0 sc0 ls0 ws0">our access point, thus av<span class="_ _0"/>oiding the noise of an<span class="_ _0"/>y client devices that are not o<span class="_ _0"/>wned by </div><div class="t m0 x3 hd y1966 ff4 fs7 fc0 sc0 lsb ws16">the target or<span class="_ _0"/>ganization. Once a client de<span class="_ _0"/>vice has connected to our access point, we </div><div class="t m0 x3 hd y1967 ff4 fs7 fc0 sc0 ls0 ws0">will attempt to manipulate insecure protocols in addition to simply capturing and </div><div class="t m0 x3 hd y1968 ff4 fs7 fc0 sc0 ls0 ws0">logging all cleartext trafc. If these technical approaches don’<span class="_ _0"/>t work, we can still use </div><div class="t m0 x3 hd y1969 ff4 fs7 fc0 sc0 ls0 ws0">a blended social engineering attack to fall back on as well.</div><div class="t m0 x4 hd y196a ff4 fs7 fc0 sc0 ls0 ws0">The primary methods we will use to manipulate trafc ensure that all trafc will </div><div class="t m0 x3 hd y196b ff4 fs7 fc0 sc0 ls0 ws0">o<span class="_ _0"/>w through our system, which is quite simple since we’ll be handing out the DHCP </div><div class="t m0 x3 hd y196c ff4 fs7 fc0 sc0 ls0 ws0">conguration. The basic setup looks lik<span class="_ _0"/>e Figure 7-16.</div><div class="t m0 x4 hd y196d ff4 fs7 fc0 sc0 ls15 ws0">In Figure 7-17, we hav<span class="_ _0"/>e a client de<span class="_ _0"/>vice congured via DHCP and our access </div><div class="t m0 x3 hd y196e ff4 fs7 fc0 sc0 ls15 ws16">point is both the default gate<span class="_ _0"/>way as well as the DNS serv<span class="_ _0"/>er<span class="_ _2"/>. If we have a client<span class="_ _0"/> </div><div class="t m0 x3 hd y196f ff4 fs7 fc0 sc0 ls15 ws0">with statically congured DNS servers, this w<span class="_ _0"/>on’t be a problem for us. Since all </div><div class="t m0 x3 hd y1970 ff4 fs7 fc0 sc0 ls15 ws0">trafc must o<span class="_ _0"/>w through us, we can simply mangle the packets using iptables </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>