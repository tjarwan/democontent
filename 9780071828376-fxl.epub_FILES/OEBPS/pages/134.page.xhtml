<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf86" class="pf w2 h2" data-page-no="86"><div class="pc pc86 w2 h2"><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">111</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">Besides just remote access systems, I hav<span class="_ _0"/>e found some very interesting web </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">systems connected to the Internet. Identifying these systems can provide some useful </div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 lsb ws16">information on our target or<span class="_ _0"/>ganization. Some of these systems include</div><div class="t m0 x16 h1f yc63 ffb fse fc0 sc0 ls0 ws16">c</div><div class="t m0 x1 hd yc64 ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _2"/>eleconference and videoconference systems</div><div class="t m0 x16 h1f yc65 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd yc66 ff4 fs7 fc0 sc0 ls0 ws0">Server and system administration tools</div><div class="t m0 x16 h1f yc67 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd yc68 ff4 fs7 fc0 sc0 ls0 ws0">Security camera systems</div><div class="t m0 x16 h1f yc69 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd yc6a ff4 fs7 fc0 sc0 ls0 ws0">Phone management systems</div><div class="t m0 x4 hd yc6b ff4 fs7 fc0 sc0 ls0 ws0">Also at the end of this task, remember to take a step back and ask yourself what </div><div class="t m0 x3 hd yc6c ff4 fs7 fc0 sc0 lsb ws16">the systems you’<span class="_ _0"/>v<span class="_ _0"/>e identied tell you about the target or<span class="_ _0"/>ganization. <span class="_ _2"/>Are they mostly </div><div class="t m0 x3 hd yc6d ff4 fs7 fc0 sc0 ls0 ws0">Microsoft Internet Information Services (IIS) systems, or are they obscure, cludgy </div><div class="t m0 x3 hd yc6e ff4 fs7 fc0 sc0 ls0 ws0">systems? Do they only ha<span class="_ _0"/>ve a fe<span class="_ _0"/>w <span class="_ _2"/>Apache systems exposed to the Internet? <span class="_ _2"/>Are </div><div class="t m0 x3 hd yc6f ff4 fs7 fc0 sc0 ls0 ws0">there indications that the banners or system information may hav<span class="_ _0"/>e been changed to </div><div class="t m0 x3 hd yc70 ff4 fs7 fc0 sc0 ls0 ws0">mislead a would-be attacker?</div><div class="t m0 x4 hd yc71 ff4 fs7 fc0 sc0 ls0 ws0">First, we want to identify the hosts from our port scan that ha<span class="_ _0"/>ve common web </div><div class="t m0 x3 hd yc72 ff4 fs7 fc0 sc0 ls0 ws0">services. The most common ports to look for are 80, 443, 8080, and 8443. F<span class="_ _0"/>or this, </div><div class="t m0 x3 hd yc73 ff4 fs7 fc0 sc0 ls0 ws0">we will turn to good ol’ reliable nmap. If you follo<span class="_ _0"/>wed the previous nmap e<span class="_ _0"/>xample, </div><div class="t m0 x3 hd yc74 ff4 fs7 fc0 sc0 ls0 ws0">you will hav<span class="_ _0"/>e a le with a .gnmap extension for each nmap scan. <span class="_ _0"/>This is the grepable </div><div class="t m0 x3 h3f yc75 ff4 fs7 fc0 sc0 ls0 ws0">output format from nmap. <span class="_ _0"/>W<span class="_ _3"/>e want to <span class="fff">grep</span> this le for common web service ports. </div><div class="t m0 x3 h3f yc76 ff4 fs7 fc0 sc0 ls0 ws20">The best way to do this is to run <span class="fff">grep</span> for each port and output that to its o<span class="_ _0"/>wn le, as </div><div class="t m0 x3 hd yc77 ff4 fs7 fc0 sc0 ls0 ws0">sho<span class="_ _0"/>wn next. Note that you’ll ha<span class="_ _0"/>v<span class="_ _0"/>e to change the “output.gnmap” to the actual name </div><div class="t m0 x3 hd yc78 ff4 fs7 fc0 sc0 ls0 ws0">of the gnmap le.</div><div class="t m0 x3 h44 yc79 fff fse fc0 sc0 ls0 ws0"># grep for all hosts with port 80</div><div class="t m0 x3 h44 yc7a fff fse fc0 sc0 ls0 ws0">grep 80/open/tcp ouput.gnmap | cut -d “ “ -f2 &gt;&gt; port80-hosts.txt</div><div class="t m0 x3 h44 yc7b fff fse fc0 sc0 ls0 ws0"># grep for all hosts with port 443</div><div class="t m0 x3 h44 yc7c fff fse fc0 sc0 ls0 ws0">grep 443/open/tcp ouput.gnmap | cut -d “ “ -f2 &gt;&gt; port443-hosts.txt</div><div class="t m0 x3 h44 yc7d fff fse fc0 sc0 ls0 ws0"># grep for all hosts with port 8080</div><div class="t m0 x3 h44 yc7e fff fse fc0 sc0 ls0 ws0">grep 8080/open/tcp ouput.gnmap | cut -d “ “ -f2 &gt;&gt; port8080-hosts.txt</div><div class="t m0 x3 h44 yc7f fff fse fc0 sc0 ls0 ws0"># grep for all hosts with port 8443</div><div class="t m0 x3 h44 yc80 fff fse fc0 sc0 ls0 ws0">grep 8443/open/tcp ouput.gnmap | cut -d “ “ -f2 &gt;&gt; port8443-hosts.txt</div><div class="t m0 x4 hd yc81 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou should also revie<span class="_ _0"/>w the output of the nmap le to identify as many HTTP-</div><div class="t m0 x3 hd yc82 ff4 fs7 fc0 sc0 ls0 ws0">related services as possible that might be on nonstandard ports. In the example ne<span class="_ _0"/>xt, </div><div class="t m0 x3 h3f yc83 ff4 fs7 fc0 sc0 ls0 ws0">we <span class="fff">grep</span> the output of an nmap scan for “open http” and we can see a single HTTP </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>