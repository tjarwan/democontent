<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf80" class="pf w2 h2" data-page-no="80"><div class="pc pc80 w2 h2"><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">105</span></div><div class="t m0 x3 h44 yb3f fff fse fc0 sc0 ls0 ws0">Updated:        2013-06-13</div><div class="t m0 x3 h44 yb40 fff fse fc0 sc0 ls0 ws0">Ref:            http://whois.arin.net/rest/org/CDI-41</div><div class="t m0 x3 h44 yb41 fff fse fc0 sc0 ls0 ws0">--- SNIP ---</div><div class="t m0 x4 hd ybbb ff4 fs7 fc0 sc0 ls0 ws0">Looks like we’<span class="_ _2"/>ve just conrmed this subnet is associated with our target </div><div class="t m0 x3 hd ybbc ff4 fs7 fc0 sc0 lsb ws16">organization. In addition, it looks lik<span class="_ _0"/>e we’<span class="_ _0"/>v<span class="_ _0"/>e conrmed our original suspicion that </div><div class="t m0 x3 hd ybbd ff4 fs7 fc0 sc0 ls0 ws0">the California T<span class="_ _3"/>echnology <span class="_ _0"/>Agenc<span class="_ _0"/>y manages the technology for many California </div><div class="t m0 x3 hd ybbe ff4 fs7 fc0 sc0 ls0 ws0">gov<span class="_ _0"/>ernment agencies. </div><div class="t m0 x3 h7 ybbf ff1 fs3 fc0 sc0 ls0 ws0">BGP Internet Peers</div><div class="t m0 x3 hd ybc0 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can obtain even more information using the looking glass serv<span class="_ _0"/>ers. <span class="_ _0"/>W<span class="_ _3"/>e can </div><div class="t m0 x3 h3f ybc1 ff4 fs7 fc0 sc0 lsb ws16">identify the ISPs the target or<span class="_ _0"/>ganization uses. Let’<span class="_ _2"/>s use the <span class="fff ls0 ws0">show<span class="_ _5b"> </span>ip bgp paths</span></div><div class="t m0 x3 hd ybc2 ff4 fs7 fc0 sc0 ls0 ws20">command to display all the current <span class="_ _2"/>AS paths known to the router<span class="_ _2"/>. W<span class="_ _3"/>e can also use the </div><div class="t m0 x3 hd ybc3 ff4 fs7 fc0 sc0 ls0 ws0">same regular e<span class="_ _0"/>xpression we used before to sho<span class="_ _0"/>w all the paths that end with <span class="_ _0"/>AS 1226, </div><div class="t m0 x3 hd ybc4 ff4 fs7 fc0 sc0 ls0 ws0">as sho<span class="_ _0"/>wn here: </div><div class="t m0 x3 h44 ybc5 fff fse fc0 sc0 ls0 ws0">route-views&gt;show ip bgp paths _1226$</div><div class="t m0 x3 h44 ybc6 fff fse fc0 sc0 ls0 ws0">Address    Hash Refcount Metric Path</div><div class="t m0 x3 h44 ybc7 fff fse fc0 sc0 ls0 ws0">0x14E913D4  263        1      0 2497 209 7385 1226 i</div><div class="t m0 x3 h44 ybc8 fff fse fc0 sc0 ls0 ws0">0x465D55F0  284       14      0 701 7018 1226 ?</div><div class="t m0 x3 h44 ybc9 fff fse fc0 sc0 ls0 ws0">0x268C3370  502       16      0 3277 3267 3356 7385 1226 i</div><div class="t m0 x3 h44 ybca fff fse fc0 sc0 ls0 ws0">0x4AA71E2C  748        1      0 4436 6939 7385 1226 i</div><div class="t m0 x3 h44 ybcb fff fse fc0 sc0 ls0 ws0">0x434D5098  757        7      0 286 7018 1226 i</div><div class="t m0 x3 h44 ybcc fff fse fc0 sc0 ls0 ws0">0x3B1FB62C  759       14      0 286 7018 1226 ?</div><div class="t m0 x3 h44 ybcd fff fse fc0 sc0 ls0 ws0">0x41B8CFA0  811        1      0 7018 174 7385 1226 i</div><div class="t m0 x3 h44 ybce fff fse fc0 sc0 ls0 ws0">0x215628BC 1712        2      0 7575 6453 7922 7385 1226 i</div><div class="t m0 x3 h44 ybcf fff fse fc0 sc0 ls0 ws0">0x41EC3118 1721        1      0 3277 3267 3356 7018 1226 i</div><div class="t m0 x3 h44 ybd0 fff fse fc0 sc0 ls0 ws0">0x71329994 2508       14      0 4436 4323 1226 1226 1226 1226 1226 ?</div><div class="t m0 x3 h44 ybd1 fff fse fc0 sc0 ls0 ws0">0x278AADCC 2510        6      0 4436 4323 1226 1226 1226 1226 1226 i</div><div class="t m0 x3 h44 ybd2 fff fse fc0 sc0 ls0 ws0">0x50F92530 2591        8      0 1221 4637 209 7385 1226 i</div><div class="t m0 x3 h44 ybd3 fff fse fc0 sc0 ls0 ws0">0x3CEB29A0 2656       14      0 2497 7018 1226 ?</div><div class="t m0 x3 h44 ybd4 fff fse fc0 sc0 ls0 ws0">--- SNIP ---</div><div class="t m0 x3 h44 ybd5 fff fse fc0 sc0 ls0 ws0">route-views&gt;</div><div class="t m0 x4 hd ybd6 ff4 fs7 fc0 sc0 ls0 ws0">As you can see in this example, the number groupings on the right side are the </div><div class="t m0 x3 hd ybd7 ff4 fs7 fc0 sc0 ls0 ws0">paths to 1226 by <span class="_ _2"/>AS number<span class="_ _0"/>. <span class="_ _0"/>What you’<span class="_ _2"/>re looking for are all the unique numbers </div><div class="t m0 x3 hd ybd8 ff4 fs7 fc0 sc0 ls0 ws0">before 1226. In this case, we see there are three unique numbers before <span class="_ _2"/>AS 1226: </div><div class="t m0 x3 hd ybd9 ff4 fs7 fc0 sc0 ls0 ws0">7385, 7018, and 4323.</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>