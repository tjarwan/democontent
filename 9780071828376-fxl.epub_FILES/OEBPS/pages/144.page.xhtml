<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf90" class="pf w2 h2" data-page-no="90"><div class="pc pc90 w2 h2"><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">121</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">Another great source to identify important locations is by using geo-IP data. </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">Geo-IP data allo<span class="_ _0"/>ws us to identify a geographic region that an IP address ultimately </div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">routes to. Unfortunately<span class="_ _2"/>, this isn’t alw<span class="_ _0"/>ays accurate, and e<span class="_ _0"/>ven when it is accurate, it </div><div class="t m0 x3 hd y15c ff4 fs7 fc0 sc0 ls0 ws0">can be a large area, sometimes just telling you the city where an IP address is in use.</div><div class="t m0 x4 hd y15d ff4 fs7 fc0 sc0 ls0 ws0">This is simply a limitation of the fact that IP addresses are not really tied to </div><div class="t m0 x3 hd y15e ff4 fs7 fc0 sc0 ls0 ws0">a specic geographic location, as well as the fact that the<span class="_ _0"/>y can change and be </div><div class="t m0 x3 hd y15f ff4 fs7 fc0 sc0 ls0 ws0">distributed or “sold” to be used an<span class="_ _0"/>ywhere in the world. <span class="_ _0"/>These databases must be </div><div class="t m0 x3 hd y160 ff4 fs7 fc0 sc0 lsb ws16">constructed manually by continuously identifying which ISPs or organizations use </div><div class="t m0 x3 hd y161 ff4 fs7 fc0 sc0 lsb ws16">which IP addresses and where those organizations are located geographically<span class="_ _3"/>.</div><div class="t m0 x4 hd y162 ff4 fs7 fc0 sc0 ls0 ws0">This information has plenty of legitimate uses. F<span class="_ _0"/>or example, you may ha<span class="_ _0"/>ve </div><div class="t m0 x3 hd y163 ff4 fs7 fc0 sc0 ls0 ws0">noticed advertisements being tailored to you for local b<span class="_ _0"/>usinesses while watching </div><div class="t m0 x3 hd y164 ff4 fs7 fc0 sc0 ls0 ws0">videos on sites such as <span class="_ _3"/>Y<span class="_ _3"/>ouT<span class="_ _0"/>ube. In man<span class="_ _0"/>y cases, this is because the site is using </div><div class="t m0 x3 hd y165 ff4 fs7 fc0 sc0 ls0 ws0">geo-IP data to determine which general area you are in.</div><div class="t m0 x4 hd y166 ff4 fs7 fc0 sc0 ls0 ws0">Many sites will pro<span class="_ _0"/>vide access to this data for a fee, but you can check out a free </div><div class="t m0 x3 hd y167 ff4 fs7 fc0 sc0 lsb ws16">database of geo-IP data at http://de<span class="_ _0"/>v<span class="_ _2"/>.maxmind.com/geoip/legacy/geolite/. MaxMind </div><div class="t m0 x3 hd y168 ff4 fs7 fc0 sc0 ls0 ws0">provides this data in both binary and CSV format. I prefer to use the CSV format, </div><div class="t m0 x3 h3f y239 ff4 fs7 fc0 sc0 ls0 ws0">as it makes simple <span class="fff">grep</span> lookups easy<span class="_ _2"/>. Using this information, we can track the IP </div><div class="t m0 x3 hd y23a ff4 fs7 fc0 sc0 ls0 ws0">addresses obtained during pre<span class="_ _0"/>vious steps to identify or verify the geographic location </div><div class="t m0 x3 hd y23b ff4 fs7 fc0 sc0 lsb ws16">of the organization’<span class="_ _2"/>s assets. This can be important to help distinguish which person </div><div class="t m0 x3 hd yd7b ff4 fs7 fc0 sc0 ls0 ws0">or department might support distinct systems.</div><div class="t m0 x3 h4 yd7c ff2 fs1 fc0 sc0 ls0 ws0">Data from the Phone System</div><div class="t m0 x3 hd y7ce ff4 fs7 fc0 sc0 ls0 ws0">There are a myriad of ways to use phones to perform reconnaissance on our tar<span class="_ _0"/>get </div><div class="t m0 x3 hd yd7d ff4 fs7 fc0 sc0 lsb ws16">organization. <span class="_ _0"/>W<span class="_ _3"/>e can manually analyze the phone systems and phone numbers in use </div><div class="t m0 x3 hd y2bd ff4 fs7 fc0 sc0 lsb ws16">at the target or<span class="_ _0"/>ganization, b<span class="_ _0"/>ut for now<span class="_ _3"/>, let’<span class="_ _0"/>s look at a great automated way to quickly </div><div class="t m0 x3 hd yd7e ff4 fs7 fc0 sc0 ls0 ws0">identify ke<span class="_ _0"/>y information.</div><div class="t m0 x4 hd y2bf ff4 fs7 fc0 sc0 ls0 ws0">The technique of war dialing has been around for quite some time. In fact, there </div><div class="t m0 x3 hd yd7f ff4 fs7 fc0 sc0 ls0 ws0">was a mo<span class="_ _0"/>vie called <span class="ff5">W<span class="_ _3"/>ar Games<span class="ff4"> that demonstrated the technique back in the early </span></span></div><div class="t m0 x3 hd yd80 ff4 fs7 fc0 sc0 ls0 ws0">1980s. Using a war dialing program, we can automatically dial a range of phone </div><div class="t m0 x3 hd y38f ff4 fs7 fc0 sc0 ls0 ws0">numbers to determine what is on the other line. Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, the technology has </div><div class="t m0 x3 hd yd81 ff4 fs7 fc0 sc0 ls0 ws0">adv<span class="_ _0"/>anced a lot since the 1980s and now<span class="_ _3"/>, rather than using an analog modem to dial a </div><div class="t m0 x3 hd yd82 ff4 fs7 fc0 sc0 ls0 ws0">series of phone numbers, we can utilize <span class="_ _2"/>V<span class="_ _1b"/>oice over IP (V<span class="_ _1b"/>oIP) technology and get the </div><div class="t m0 x3 hd yd83 ff4 fs7 fc0 sc0 ls0 ws0">job done in a fraction of the time.</div><div class="t m0 x4 hd yd84 ff4 fs7 fc0 sc0 ls0 ws0">Our tool of choice here is <span class="_ _0"/>W<span class="_ _3"/>arvox. <span class="_ _0"/>W<span class="_ _2"/>arv<span class="_ _0"/>ox is a Ruby application that provides </div><div class="t m0 x3 hd yd85 ff4 fs7 fc0 sc0 ls0 ws0">a nice web interface, making it e<span class="_ _0"/>xtremely easy to use. <span class="_ _0"/>W<span class="_ _0"/>ith <span class="_ _0"/>W<span class="_ _3"/>arvox, you can scan </div><div class="t m0 x3 hd yd86 ff4 fs7 fc0 sc0 ls0 ws0">using many “phone lines” at once to get really great speeds. Not only can you use </div><div class="t m0 x3 hd y893 ff4 fs7 fc0 sc0 ls0 ws0">multiple lines, but you can also use multiple pro<span class="_ _0"/>viders.</div><a class="" href="http://dev.maxmind.com/geoip/legacy/geolite/"><div class="d m1" style="border-style:none;position:absolute;left:234.739229px;bottom:472.913076px;width:205.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>