<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf41" class="pf w2 h2" data-page-no="41"><div class="pc pc41 w2 h2"><img class="bi x66 y589 w6 h2e" alt="" src="bg41.png"/><div class="t m0 x29 h10 y83 ff1 fs9 fc0 sc0 lsa ws0">42<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x28 hd y172 ff4 fs7 fc0 sc0 lsb ws16">belie<span class="_ _0"/>ve the information was gi<span class="_ _0"/>v<span class="_ _0"/>en to the press purposefully to garner support for </div><div class="t m0 x28 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">Obama in the 2012 Presidential election.</div><div class="t m0 x16 hd y19a ff4 fs7 fc0 sc0 lsb ws16">This threat needs to be reconsidered, gi<span class="_ _0"/>ven the alle<span class="_ _0"/>gation that the U.S. government </div><div class="t m0 x28 hd y19b ff4 fs7 fc0 sc0 ls0 ws0">was supposedly the primary creator behind Stuxnet, in addition to the fact that it </div><div class="t m0 x28 hd y19c ff4 fs7 fc0 sc0 ls0 ws0">used certicates stolen from T<span class="_ _3"/>aiwanese companies. Looking at the components of </div><div class="t m0 x28 hd y19d ff4 fs7 fc0 sc0 ls0 ws0">Stuxnet, there is very little that seems completely unusual or elite. Ho<span class="_ _0"/>we<span class="_ _0"/>ver<span class="_ _2"/>, when </div><div class="t m0 x28 hd y178 ff4 fs7 fc0 sc0 ls0 ws0">you put it all together and look at the efcacy of the attacks, you ha<span class="_ _0"/>ve to be at least a </div><div class="t m0 x28 hd y179 ff4 fs7 fc0 sc0 ls0 ws0">little amazed.</div><div class="t m0 x28 h4 y58a ff2 fs1 fc0 sc0 ls0 ws0">Duqu: The APT Reconnaissance W<span class="_ _0"/>orm</div><div class="t m0 x28 hd y58b ff4 fs7 fc0 sc0 ls0 ws0">Although automated malware is not the only tool in an <span class="_ _2"/>APT’<span class="_ _2"/>s arsenal, another </div><div class="t m0 x28 hd y58c ff4 fs7 fc0 sc0 ls0 ws0">extremely interesting e<span class="_ _0"/>xample is the Duqu worm, which was disco<span class="_ _0"/>vered in </div><div class="t m0 x28 hd y58d ff4 fs7 fc0 sc0 ls0 ws0">September 2011 and is named because a fe<span class="_ _0"/>w of the les it creates start with the </div><div class="t m0 x28 hd y518 ff4 fs7 fc0 sc0 ls0 ws0">prex DQ. Experts hav<span class="_ _0"/>e analyzed the Duqu virus and, based on similarities in size, </div><div class="t m0 x28 hd y58e ff4 fs7 fc0 sc0 ls0 ws0">complexity<span class="_ _3"/>, target, and operations of the two worms, concluded that it w<span class="_ _0"/>as written by </div><div class="t m0 x28 hd y58f ff4 fs7 fc0 sc0 lsb ws16">the same organization that created Stuxnet. It is belie<span class="_ _0"/>v<span class="_ _0"/>ed that the creator of Duqu had </div><div class="t m0 x28 hd y590 ff4 fs7 fc0 sc0 ls0 ws0">access to the source code of Stuxnet.</div><div class="t m0 x16 hd y591 ff4 fs7 fc0 sc0 ls0 ws0">Duqu is dif<span class="_ _0"/>ferent from Stuxnet in that no true payload was e<span class="_ _0"/>ver observ<span class="_ _0"/>ed. Instead, </div><div class="t m0 x28 hd y592 ff4 fs7 fc0 sc0 lsb ws16">it appeared that the primary purpose of the worm was to gather intelligence on </div><div class="t m0 x28 hd y593 ff4 fs7 fc0 sc0 ls0 ws0">specic targets. <span class="_ _0"/>The infected hosts were limited, as it appears that the preferred </div><div class="t m0 x28 hd y594 ff4 fs7 fc0 sc0 ls0 ws0">deli<span class="_ _0"/>very method was a true spearhead phishing attack via e-mail. Unique e-mails </div><div class="t m0 x28 hd y595 ff4 fs7 fc0 sc0 ls0 ws0">were identied as deli<span class="_ _0"/>vering v<span class="_ _0"/>ariants of the worm to Iranian tar<span class="_ _0"/>gets.</div><div class="t m0 x16 hd y596 ff4 fs7 fc0 sc0 lsb ws16">The operation of Duqu is also extremely stealthy and well written. <span class="_ _0"/>The only </div><div class="t m0 x28 hd y597 ff4 fs7 fc0 sc0 ls0 ws0">exploit observ<span class="_ _0"/>ed was in the deli<span class="_ _0"/>very method. <span class="_ _0"/>The tar<span class="_ _0"/>gets of the phishing e-mails </div><div class="t m0 x28 hd y598 ff4 fs7 fc0 sc0 ls0 ws0">were enticed into opening an attached Microsoft <span class="_ _0"/>W<span class="_ _3"/>ord document. The <span class="_ _0"/>W<span class="_ _2"/>ord </div><div class="t m0 x28 hd y599 ff4 fs7 fc0 sc0 ls0 ws0">document included a custom font that exploited a k<span class="_ _0"/>ernel vulnerability in the </div><div class="t m0 x28 hd y59a ff4 fs7 fc0 sc0 ls0 ws0">win32k.sys le that allo<span class="_ _0"/>wed arbitrary code ex<span class="_ _0"/>ecution. The e<span class="_ _0"/>xploit CVE-2011-3402 </div><div class="t m0 x28 hd y59b ff4 fs7 fc0 sc0 ls0 ws0">would later be patched by Microsoft in MS11-087. It is interesting to note that this </div><div class="t m0 x28 hd y59c ff4 fs7 fc0 sc0 ls0 ws0">vulnerability is not exploited by a memory o<span class="_ _0"/>vero<span class="_ _0"/>w condition either<span class="_ _0"/>, similar to </div><div class="t m0 x28 hd y59d ff4 fs7 fc0 sc0 ls0 ws0">Stuxnet.</div><div class="t m0 x16 hd y59e ff4 fs7 fc0 sc0 ls0 ws0">Upon opening the document, a dropper DLL was loaded into memory<span class="_ _2"/>. This </div><div class="t m0 x28 hd y59f ff4 fs7 fc0 sc0 ls0 ws0">dropper was loaded under the services.e<span class="_ _0"/>xe process, allo<span class="_ _0"/>wing the dropper to remain </div><div class="t m0 x28 hd y5a0 ff4 fs7 fc0 sc0 ls0 ws0">ex<span class="_ _0"/>ecuting e<span class="_ _0"/>ven if the <span class="_ _0"/>W<span class="_ _3"/>ord le was closed. The dropper then w<span class="_ _0"/>aited for ten minutes </div><div class="t m0 x28 hd y5a1 ff4 fs7 fc0 sc0 ls0 ws0">of ke<span class="_ _0"/>yboard and mouse inactivity to be<span class="_ _0"/>gin installing the meat of the backdoor<span class="_ _2"/>.</div><div class="t m0 x66 h2f y5a2 ffe fs9 fc0 sc0 ls0 ws0">NOTE</div><div class="t m0 x66 h14 y5a3 ff9 fs7 fc0 sc0 ls0 ws0">A dropper is a small program designed to deploy a larger attack tool. The design and execution of </div><div class="t m0 x66 h14 y5a4 ff9 fs7 fc0 sc0 ls0 ws0">droppers can vary greatly based on their criteria. We will explore different options for designing </div><div class="t m0 x66 h14 y5a5 ff9 fs7 fc0 sc0 ls0 ws0">and writing droppers in a future chapter<span class="_ _2"/>.</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>