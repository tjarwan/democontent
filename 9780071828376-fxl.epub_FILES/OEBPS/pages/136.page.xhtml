<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf88" class="pf w2 h2" data-page-no="88"><div class="pc pc88 w2 h2"><img class="bi x3 yca6 wa h4e" alt="" src="bg88.png"/><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">113</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">The use of webshot is extremely straightforw<span class="_ _0"/>ard. The required options to run are </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">sho<span class="_ _0"/>wn in the previous e<span class="_ _0"/>xample. There are only tw<span class="_ _0"/>o:</div><div class="t m0 x16 h1f y4c7 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y4c8 ff4 fs7 fc0 sc0 ls0 ws0">-i gi<span class="_ _0"/>ves the input le list.</div><div class="t m0 x16 h1f y4c9 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y4ca ff4 fs7 fc0 sc0 ls0 ws0">-t species a title for the output HTML le.</div><div class="t m0 x4 hd yca7 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can also choose to spoof the browser user agent with the -u option. The input </div><div class="t m0 x3 hd yca8 ff4 fs7 fc0 sc0 ls0 ws0">le is a list of target URLs. <span class="_ _1b"/>Y<span class="_ _3"/>ou must specify the protocol to use—for example, </div><div class="t m0 x3 hd yca9 ff4 fs7 fc0 sc0 ls0 ws0">HTTP or HTTPS—as well as the port if it’<span class="_ _2"/>s a nonstandard port. <span class="_ _2"/>Y<span class="_ _1b"/>ou can also use </div><div class="t m0 x3 hd ycaa ff4 fs7 fc0 sc0 ls0 ws0">either IP addresses or hostnames. Follo<span class="_ _0"/>wing is a sample tar<span class="_ _0"/>get list:</div><div class="t m0 x3 h44 ycab fff fse fc0 sc0 ls0 ws0">Contents of in.txt</div><div class="t m0 x3 h44 ycac fff fse fc0 sc0 ls0 ws0">http://192.168.1.1</div><div class="t m0 x3 h44 ycad fff fse fc0 sc0 ls0 ws0">https://192.168.1.2</div><div class="t m0 x3 h44 ycae fff fse fc0 sc0 ls0 ws0">http://192.168.1.3:999</div><div class="t m0 x3 h44 ycaf fff fse fc0 sc0 ls0 ws0">https://192.168.1.3:8443</div><div class="t m0 x3 h44 ycb0 fff fse fc0 sc0 ls0 ws0">http://www.weak-target.com</div><div class="t m0 x4 hd ycb1 ff4 fs7 fc0 sc0 ls0 ws0">The information obtained from the HTTP headers is listed in the follo<span class="_ _0"/>wing table.</div><div class="t m0 x20 h1d ycb2 ff1 fs7 fc0 sc0 ls0 ws0">Name<span class="_ _61"> </span>Description<span class="_ _62"> </span>Example</div><div class="t m0 x20 h6 ycb3 ff4 fs2 fc0 sc0 ls0 ws0">HTTP Response<span class="_ _24"> </span>The numeric and plain-English </div><div class="t m0 xa9 h6 ycb4 ff4 fs2 fc0 sc0 ls0 ws0">description of the HTTP return code.</div><div class="t m0 x48 h6 ycb3 ff4 fs2 fc0 sc0 ls0 ws0">200 OK</div><div class="t m0 x48 h6 ycb4 ff4 fs2 fc0 sc0 ls0 ws0">301 HTTP Redirect</div><div class="t m0 x48 h6 ycb5 ff4 fs2 fc0 sc0 ls0 ws0">404 Not Found</div><div class="t m0 x20 h6 ycb6 ff4 fs2 fc0 sc0 ls0 ws0">Final URI<span class="_ _63"> </span>The nal location of the requested URL </div><div class="t m0 xa9 h6 ycb7 ff4 fs2 fc0 sc0 ls0 ws0">after a redirect.</div><div class="t m0 x48 h6 ycb6 ff4 fs2 fc0 sc0 ls0 ws0">http://weak-target.com/admin/</div><div class="t m0 x48 h6 ycb8 ff4 fs2 fc0 sc0 ls0 ws0">login.php</div><div class="t m0 x20 h6 ycb9 ff4 fs2 fc0 sc0 ls0 ws0">Server<span class="_ _64"> </span>The server header returned by the </div><div class="t m0 xa9 h6 ycba ff4 fs2 fc0 sc0 ls0 ws0">server<span class="_ _2"/>.</div><div class="t m0 x48 h6 ycb9 ff4 fs2 fc0 sc0 ls0 ws0">Microsoft-IIS/8.0</div><div class="t m0 x48 h6 ycbb ff4 fs2 fc0 sc0 ls0 ws0">Apache/2.2.3 (Red Hat)</div><div class="t m0 x20 h6 ycbc ff4 fs2 fc0 sc0 ls0 ws0">Cert-Subject<span class="_ _65"> </span>Subject information from the certicate. </div><div class="t m0 xa9 h6 ycbd ff4 fs2 fc0 sc0 ls0 ws0">This can include useful information, </div><div class="t m0 xa9 h6 ycbe ff4 fs2 fc0 sc0 ls0 ws0">including location, department names, </div><div class="t m0 xa9 h6 ycbf ff4 fs2 fc0 sc0 ls0 ws0">and DNS names.</div><div class="t m0 x48 h6 ycc0 ff4 fs2 fc0 sc0 ls0 ws0">/C=US/ST=NY/L=Albany/</div><div class="t m0 x48 h6 ycc1 ff4 fs2 fc0 sc0 ls0 ws0">OU=W<span class="_ _2"/>eakT<span class="_ _2"/>arget Inc/</div><div class="t m0 x48 h6 ycc2 ff4 fs2 fc0 sc0 ls0 ws0">OU=SecOps/</div><div class="t m0 x48 h6 ycc3 ff4 fs2 fc0 sc0 ls0 ws0">CN=admin.weaktarget.com</div><div class="t m0 x20 h6 ycc4 ff4 fs2 fc0 sc0 ls0 ws0">Set-Cookie<span class="_ _66"> </span>Any v<span class="_ _0"/>alues set within a cookie.<span class="_ _42"> </span>UID=tdub;GUID=admin</div><div class="t m0 x20 h6 ycc5 ff4 fs2 fc0 sc0 ls0 ws0">X-Powered-By<span class="_ _30"> </span>Lists technologies that support the web </div><div class="t m0 xa9 h6 ycc6 ff4 fs2 fc0 sc0 ls0 ws0">application.</div><div class="t m0 x48 h6 ycc5 ff4 fs2 fc0 sc0 ls0 ws0">ASP<span class="_ _3"/>.NET</div><div class="t m0 x48 h6 ycc6 ff4 fs2 fc0 sc0 ls0 ws0">PHP/5.1.2</div><div class="t m0 x20 h6 ycc7 ff4 fs2 fc0 sc0 ls0 ws0">T<span class="_ _0"/>itle<span class="_ _67"> </span>The title of the nal web page.<span class="_ _3a"> </span>W<span class="_ _2"/>eakT<span class="_ _2"/>arget Remote </div><div class="t m0 x48 h6 ycc8 ff4 fs2 fc0 sc0 ls0 ws0">Administration Portal</div><div class="t m0 x4 hd ycc9 ff4 fs7 fc0 sc0 ls0 ws0">All of this information obtained from the HTTP headers and certicate </div><div class="t m0 x3 hd ycca ff4 fs7 fc0 sc0 ls0 ws0">information can help us identify the type and purpose of the identied web server<span class="_ _2"/>. </div><a class="" href="http://weak-target.com/admin/login.php"><div class="d m1" style="border-style:none;position:absolute;left:391.957672px;bottom:326.578987px;width:121.000000px;height:11.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://weak-target.com/admin/login.php"><div class="d m1" style="border-style:none;position:absolute;left:391.957672px;bottom:312.066515px;width:38.000000px;height:11.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>