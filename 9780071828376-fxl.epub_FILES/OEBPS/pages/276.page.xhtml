<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf114" class="pf w2 h2" data-page-no="114"><div class="pc pc114 w2 h2"><div class="t m0 xa3 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 7: Phase III: Remote T<span class="_ _0"/>argeting<span class="_ _9"> </span><span class="ff1 fs9 lsa">253</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">Here’<span class="_ _2"/>s an example of user JSmith attempting to authenticate:</div><div class="t m0 x3 h44 y1a39 fff fse fc0 sc0 ls0 ws0">root@kali:/usr/local/var/log/radius# cat freeradius-server-wpe.log</div><div class="t m0 x3 h44 y1a3a fff fse fc0 sc0 ls0 ws0">mschap: Wed Mar 12 00:18:16 2014</div><div class="t m0 x3 h44 y1a3b fff fse fc0 sc0 ls0 ws0">        username: JSmith</div><div class="t m0 x3 h44 y1a3c fff fse fc0 sc0 ls0 ws0">        challenge: 15:d6:95:18:82:fb:f0:ca</div><div class="t m0 x3 h44 y1a3d fff fse fc0 sc0 ls0 ws0">        response: cf:76:f6:d5:cb:35:4a:a5:c2:14:a3:3e:5f:be:70:da:10:</div><div class="t m0 x3 h44 y1a3e fff fse fc0 sc0 ls0 ws0">a4:5b:e1:36:ae:91:fb</div><div class="t m0 x3 h44 y1a3f fff fse fc0 sc0 ls0 ws0">        john NETNTLM: JSmith:$NETNTLM$15d6951882fbf0ca$cf76f6d5cb354a</div><div class="t m0 x3 h44 y1a40 fff fse fc0 sc0 ls0 ws0">a5c214a33e5fbe70da10a45be136ae91fb</div><div class="t m0 x4 hd y1a41 ff4 fs7 fc0 sc0 ls0 ws0">Let’<span class="_ _2"/>s take this password hash and see if we can crack it. <span class="_ _2"/>All we have to do is put </div><div class="t m0 x3 hd y1a42 ff4 fs7 fc0 sc0 ls0 ws0">the line with the hash into a text le. If we ha<span class="_ _0"/>ve multiple hashes, we can add them all </div><div class="t m0 x3 hd y1a43 ff4 fs7 fc0 sc0 ls0 ws0">on their o<span class="_ _0"/>wn line. The contents of the hash le should look like this:</div><div class="t m0 x3 h44 y1a44 fff fse fc0 sc0 ls0 ws0">JSmith:$NETNTLM$15d6951882fbf0ca$cf76f6d5cb354aa5c214a33e5fbe70da10a4</div><div class="t m0 x3 h44 y1a45 fff fse fc0 sc0 ls0 ws0">5be136ae91fb</div><div class="t m0 x4 hd y1a46 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can then re off John the Ripper at the password hashes. In its simplest form, </div><div class="t m0 x3 hd y1a47 ff4 fs7 fc0 sc0 ls0 ws0">we can see that we don’t e<span class="_ _0"/>v<span class="_ _0"/>en need any options for John the Ripper:</div><div class="t m0 x3 h44 y1a48 fff fse fc0 sc0 ls0 ws0">root@klap:~# john hash.txt</div><div class="t m0 x3 h44 y1a49 fff fse fc0 sc0 ls0 ws0">Loaded 1 password hash (NTLMv1 C/R MD4 DES (ESS MD5) [32/32])</div><div class="t m0 x3 h44 y1a4a fff fse fc0 sc0 ls0 ws0">password1        (JSmith)</div><div class="t m0 x3 h44 y1a4b fff fse fc0 sc0 ls0 ws0">guesses: 1  time: 0:00:00:00 DONE (Wed Mar 12 00:31:52 2014)  c/s: </div><div class="t m0 x3 h44 y1a4c fff fse fc0 sc0 ls0 ws0">5170  trying: 123456 - random</div><div class="t m0 x3 h44 y1a4d fff fse fc0 sc0 ls0 ws0">Use the "--show" option to display all of the cracked passwords </div><div class="t m0 x3 h44 y1a4e fff fse fc0 sc0 ls0 ws0">reliably</div><div class="t m0 x3 h44 y1a4f fff fse fc0 sc0 ls0 ws0">root@klap:~#</div><div class="t m0 x4 hd y1a50 ff4 fs7 fc0 sc0 ls0 ws0">If you don’t wish to use an e<span class="_ _0"/>xternal access point, you’ll ha<span class="_ _0"/>ve to use the hostapd </div><div class="t m0 x3 h3f y1a51 ff4 fs7 fc0 sc0 ls0 ws0">package, as the <span class="fff">airbase-ng</span> tool doesn’t currently support <span class="_ _0"/>WP<span class="_ _1b"/>A-Enterprise mode. </div><div class="t m0 x3 hd y1a52 ff4 fs7 fc0 sc0 ls0 ws0">I hav<span class="_ _0"/>e had problems many times with hostapd. <span class="_ _0"/>These are usually as simple as dri<span class="_ _0"/>ver </div><div class="t m0 x3 hd y1a53 ff4 fs7 fc0 sc0 ls0 ws0">issues and problems with support for specic wireless cards, which are relati<span class="_ _0"/>vely </div><div class="t m0 x3 hd y1a54 ff4 fs7 fc0 sc0 ls0 ws0">easy to x; ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, it can still be frustrating when alternati<span class="_ _0"/>ve tools lik<span class="_ _0"/>e airbase tend </div><div class="t m0 x3 hd y1a55 ff4 fs7 fc0 sc0 ls0 ws0">to “just work.<span class="_ _3"/>”</div><div class="t m0 x4 hd y1a56 ff4 fs7 fc0 sc0 ls0 ws0">Kali comes with a hostapd package, but at the time of this writing, the hostapd </div><div class="t m0 x3 hd y1a57 ff4 fs7 fc0 sc0 ls0 ws0">version in Kali is 1.0, while hostapd v<span class="_ _0"/>ersion 2.1 is av<span class="_ _0"/>ailable. <span class="_ _0"/>T<span class="_ _3"/>o use hostapd, rst </div><div class="t m0 x3 hd y1a58 ff4 fs7 fc0 sc0 ls0 ws0">check out the list of supported wireless cards and dri<span class="_ _0"/>vers at http://hostap.epitest</div><div class="t m0 x3 hd y1a59 ff4 fs7 fc0 sc0 ls0 ws0">./hostapd/. The v<span class="_ _0"/>ersion that comes preinstalled with Kali should still work for our </div><div class="t m0 x3 hd y1a5a ff4 fs7 fc0 sc0 ls0 ws0">needs, but if necessary<span class="_ _3"/>, you can download the latest v<span class="_ _0"/>ersion from the same website. </div><a class="" href="http://hostap.epitest.fi/hostapd/"><div class="d m1" style="border-style:none;position:absolute;left:411.307634px;bottom:139.126228px;width:87.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://hostap.epitest.fi/hostapd/"><div class="d m1" style="border-style:none;position:absolute;left:94.452003px;bottom:123.404384px;width:52.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>