<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf19b" class="pf w2 h2" data-page-no="19b"><div class="pc pc19b w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">388<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">In particular<span class="_ _0"/>, we can monitor for an<span class="_ _0"/>y access to any les related to our backdoor<span class="_ _0"/>, </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">such as Explorer bro<span class="_ _0"/>wsing to a directory<span class="_ _2"/>, right-clicking a le, browsing to a re<span class="_ _0"/>gistry </div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">ke<span class="_ _0"/>y<span class="_ _2"/>, and more.</div><div class="t m0 x3 h4 ybf7 ff2 fs1 fc0 sc0 ls0 ws0">Responding to Thy Enemy</div><div class="t m0 x3 hd ybf8 ff4 fs7 fc0 sc0 ls0 ws0">Once we’<span class="_ _2"/>ve identied an ev<span class="_ _0"/>ent that could be indicati<span class="_ _0"/>ve of someone attempting to </div><div class="t m0 x3 hd ybf9 ff4 fs7 fc0 sc0 lsb ws16">in<span class="_ _0"/>v<span class="_ _0"/>estigate our backdoor<span class="_ _0"/>, we can respond to that e<span class="_ _0"/>vent. Some of our options include </div><div class="t m0 x3 hd ybfa ff4 fs7 fc0 sc0 ls0 ws0">the follo<span class="_ _0"/>wing:</div><div class="t m0 x16 h1f y249a ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y249b ff4 fs7 fc0 sc0 ls0 ws0">Recoil. Stop certain acti<span class="_ _0"/>vities or communication and wait for a specic time or </div><div class="t m0 x1 hd y249c ff4 fs7 fc0 sc0 lsc ws17">e<span class="_ _0"/>vent to start the backdoor again.</div><div class="t m0 x16 h1f y249d ffb fse fc0 sc0 ls0 ws17">c</div><div class="t m0 x1 hd y249e ff4 fs7 fc0 sc0 ls0 ws0">Close all backdoor processes except for the w<span class="_ _0"/>atchdog process and wait for </div><div class="t m0 x1 hd y249f ff4 fs7 fc0 sc0 ls0 ws0">logof<span class="_ _0"/>f/logon or reboot.</div><div class="t m0 x16 h1f y24a0 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y24a1 ff4 fs7 fc0 sc0 ls0 ws0">Securely erase all traces of the backdoor<span class="_ _2"/>.</div><div class="t m0 x4 hd y24a2 ff4 fs7 fc0 sc0 ls0 ws0">Depending on the e<span class="_ _0"/>vents we detect, recoiling and simply limiting the things an </div><div class="t m0 x3 hd y24a3 ff4 fs7 fc0 sc0 lsb ws16">in<span class="_ _0"/>v<span class="_ _0"/>estigator might notice can be effecti<span class="_ _0"/>v<span class="_ _0"/>e. If the backdoor is deployed in a scenario </div><div class="t m0 x3 hd y24a4 ff4 fs7 fc0 sc0 ls0 ws0">where it is better for us to lose access to the compromised system than potentially </div><div class="t m0 x3 hd y24a5 ff4 fs7 fc0 sc0 ls0 ws0">allo<span class="_ _0"/>w someone to detect and analyze the backdoor<span class="_ _0"/>, then we can simply ha<span class="_ _0"/>ve the </div><div class="t m0 x3 hd y24a6 ff4 fs7 fc0 sc0 ls0 ws0">backdoor securely delete itself.</div><div class="t m0 x4 hd y24a7 ff4 fs7 fc0 sc0 ls0 ws0">In addition, if it is acceptable to delete the backdoor entirely and lose access to the </div><div class="t m0 x3 hd y24a8 ff4 fs7 fc0 sc0 lsb ws16">compromised system, then we can perform one last action to mislead an in<span class="_ _0"/>v<span class="_ _0"/>estigator </div><div class="t m0 x3 hd y24a9 ff4 fs7 fc0 sc0 ls0 ws0">with a red herring. This red herring can tak<span class="_ _0"/>e on many forms, b<span class="_ _0"/>ut the simplest is to </div><div class="t m0 x3 hd y24aa ff4 fs7 fc0 sc0 ls0 ws0">deploy a well-kno<span class="_ _0"/>wn virus, spyw<span class="_ _0"/>are, adware, or any other mal<span class="_ _0"/>ware. <span class="_ _0"/>Thus, when the </div><div class="t m0 x3 hd y24ab ff4 fs7 fc0 sc0 lsb ws16">in<span class="_ _0"/>v<span class="_ _0"/>estigator detects the virus, they might assume that they ha<span class="_ _0"/>v<span class="_ _0"/>e discov<span class="_ _0"/>ered what they </div><div class="t m0 x3 hd y24ac ff4 fs7 fc0 sc0 ls0 ws0">are looking for and will not attribute the infection to a more tar<span class="_ _0"/>geted attack.</div><div class="t m0 x4 hd y24ad ff4 fs7 fc0 sc0 ls0 ws0">Finally<span class="_ _2"/>, it can be extremely important to create functionality within the backdoor </div><div class="t m0 x3 hd y24ae ff4 fs7 fc0 sc0 lsb ws16">to mislead an administrator who might be in<span class="_ _0"/>v<span class="_ _0"/>estigating the backdoor on a liv<span class="_ _0"/>e test </div><div class="t m0 x3 hd y24af ff4 fs7 fc0 sc0 ls0 ws0">system such as a virtual machine or e<span class="_ _0"/>ven a dedicated computer<span class="_ _2"/>. In this case, there </div><div class="t m0 x3 hd y24b0 ff4 fs7 fc0 sc0 lsb ws16">are some additional options that can mislead an in<span class="_ _0"/>v<span class="_ _0"/>estigator as to the operation of </div><div class="t m0 x3 hd y24b1 ff4 fs7 fc0 sc0 ls0 ws0">a backdoor<span class="_ _0"/>, thus allo<span class="_ _0"/>wing them to “clean” infected systems without learning of our </div><div class="t m0 x3 hd y24b2 ff4 fs7 fc0 sc0 ls0 ws0">true functionality<span class="_ _2"/>.</div><div class="t m0 x4 hd y24b3 ff4 fs7 fc0 sc0 ls0 ws0">I hav<span class="_ _0"/>e experienced this rsthand during se<span class="_ _0"/>v<span class="_ _0"/>eral penetration tests when using </div><div class="t m0 x3 hd y24b4 ff4 fs7 fc0 sc0 ls0 ws0">malware deli<span class="_ _0"/>v<span class="_ _0"/>ered through a phishing campaign. <span class="_ _2"/>After identication of the initial </div><div class="t m0 x3 hd y24b5 ff4 fs7 fc0 sc0 ls0 ws0">infections to end users, administrators infected li<span class="_ _0"/>ve “test” systems to analyze the </div><div class="t m0 x3 hd y24b6 ff4 fs7 fc0 sc0 ls0 ws0">function and network communications of the backdoor<span class="_ _2"/>. Let’<span class="_ _0"/>s understand the o<span class="_ _0"/>w </div><div class="t m0 x3 hd y24b7 ff4 fs7 fc0 sc0 ls0 ws0">of their analysis and see ho<span class="_ _0"/>w we can mislead them ev<span class="_ _0"/>en when they ha<span class="_ _0"/>ve a complete </div><div class="t m0 x3 hd y24b8 ff4 fs7 fc0 sc0 ls0 ws0">understanding of ho<span class="_ _0"/>w the dropper works.</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>