<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf82" class="pf w2 h2" data-page-no="82"><div class="pc pc82 w2 h2"><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">107</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">There we hav<span class="_ _0"/>e it. <span class="_ _2"/>At this point, using BGP alone, and without sending a single </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 lsb ws16">packet to our tar<span class="_ _0"/>get organization, we’<span class="_ _2"/>ve identied 24 distinct subnets in use, three </div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">ISPs, a hot site for disaster recov<span class="_ _0"/>ery<span class="_ _2"/>, and a partridge in a pear tree.</div><div class="t m0 x3 h4 ybf7 ff2 fs1 fc0 sc0 ls0 ws0">System and Ser<span class="_ _1"/>vice Identication</div><div class="t m0 x3 hd ybf8 ff4 fs7 fc0 sc0 lsb ws16">After identifying all of the subnets o<span class="_ _0"/>wned by the target or<span class="_ _0"/>ganization, we’ll want </div><div class="t m0 x3 hd ybf9 ff4 fs7 fc0 sc0 ls0 ws0">to identify all of the systems and services exposed to the Internet. Performing port </div><div class="t m0 x3 hd ybfa ff4 fs7 fc0 sc0 ls0 ws0">scans and ping sweeps is arguably one of the most basic things we’<span class="_ _0"/>ll cov<span class="_ _0"/>er in this </div><div class="t m0 x3 hd y37c ff4 fs7 fc0 sc0 ls0 ws0">book. On your way to becoming an <span class="_ _2"/>APT hacker<span class="_ _0"/>, you will necessarily ha<span class="_ _0"/>ve to master </div><div class="t m0 x3 hd ybfb ff4 fs7 fc0 sc0 ls0 ws0">the techniques of ef<span class="_ _0"/>fectiv<span class="_ _0"/>e port scanning. Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, just to be complete, we’<span class="_ _0"/>ll cov<span class="_ _0"/>er </div><div class="t m0 x3 hd y5ff ff4 fs7 fc0 sc0 ls0 ws0">some of the most useful information you can look for<span class="_ _2"/>.</div><div class="t m0 x4 hd y493 ff4 fs7 fc0 sc0 ls0 ws0">The most important thing for us is to identify systems, services, and information </div><div class="t m0 x3 hd ybfc ff4 fs7 fc0 sc0 ls0 ws0">that will be used in future attack phases. There are some re<span class="_ _0"/>wall and intrusion </div><div class="t m0 x3 hd ybfd ff4 fs7 fc0 sc0 ls0 ws0">pre<span class="_ _0"/>vention systems that may block our requests or otherwise gi<span class="_ _0"/>ve us unusable </div><div class="t m0 x3 hd ybfe ff4 fs7 fc0 sc0 ls0 ws0">data if it detects our acti<span class="_ _0"/>vities. Thus, we want to emplo<span class="_ _0"/>y two scans: one “slo<span class="_ _0"/>w and </div><div class="t m0 x3 hd y600 ff4 fs7 fc0 sc0 ls0 ws0">lo<span class="_ _0"/>w” and another “hard and fast.<span class="_ _2"/>” The order you choose to emplo<span class="_ _0"/>y depends on the </div><div class="t m0 x3 hd y601 ff4 fs7 fc0 sc0 lsb ws16">organization you’<span class="_ _2"/>re scanning. If you think they might ha<span class="_ _0"/>ve technologies in place that </div><div class="t m0 x3 hd y602 ff4 fs7 fc0 sc0 ls0 ws0">will detect or block your port scans, you may want to start with the slo<span class="_ _0"/>w and lo<span class="_ _0"/>w </div><div class="t m0 x3 hd y49a ff4 fs7 fc0 sc0 ls0 ws0">approach.</div><div class="t m0 x4 hd ybff ff4 fs7 fc0 sc0 lsb ws16">On the other hand, if there are indications that the target or<span class="_ _0"/>ganization is like 95 </div><div class="t m0 x3 hd yc00 ff4 fs7 fc0 sc0 lsb ws16">percent of all organizations and w<span class="_ _0"/>on’t notice our scanning, we can start with a hard </div><div class="t m0 x3 hd yc01 ff4 fs7 fc0 sc0 lsb ws16">and fast scan. Remember that e<span class="_ _0"/>very or<span class="_ _0"/>ganization is constantly being scanned by </div><div class="t m0 x3 hd yc02 ff4 fs7 fc0 sc0 ls0 ws0">automated programs, so our scans probably won’<span class="_ _0"/>t set off an<span class="_ _0"/>y major alarms. Even </div><div class="t m0 x3 hd yc03 ff4 fs7 fc0 sc0 ls0 ws0">though we can assume that much of our scanning will go unnoticed, we still want to </div><div class="t m0 x3 hd y606 ff4 fs7 fc0 sc0 ls0 ws0">take the precaution of using a bounce box or proxy for our scanning.</div><div class="t m0 x4 hd y607 ff4 fs7 fc0 sc0 ls0 ws0">For our rst quick and dirty scan, we’<span class="_ _0"/>ll use the most basic options of nmap, as in </div><div class="t m0 x3 hd yc04 ff4 fs7 fc0 sc0 ls0 ws0">the follo<span class="_ _0"/>wing example.</div><div class="t m0 x3 h44 yc05 fff fse fc0 sc0 ls0 ws0">nmap -sS -oA weak.standard 1.1.1.0/24</div><div class="t m0 x4 hd yc06 ff4 fs7 fc0 sc0 ls0 ws0">The -sS option tells nmap to perform SYN scans, also kno<span class="_ _0"/>wn as “half-open” </div><div class="t m0 x3 hd yc07 ff4 fs7 fc0 sc0 ls0 ws0">scans, in which the TCP handshak<span class="_ _0"/>e is not completed. The -oA option tells nmap to </div><div class="t m0 x3 hd yc08 ff4 fs7 fc0 sc0 ls0 ws0">sav<span class="_ _0"/>e output in all supported formats: XML, grepable, and nmap. The lenames will </div><div class="t m0 x3 hd yc09 ff4 fs7 fc0 sc0 ls0 ws0">each begin with the prex “weak.standard.<span class="_ _3"/>”</div><div class="t m0 x4 hd yc0a ff4 fs7 fc0 sc0 ls0 ws0">Make sure you alw<span class="_ _0"/>ays sav<span class="_ _0"/>e the output from your tools. Not only do you want to </div><div class="t m0 x3 hd yc0b ff4 fs7 fc0 sc0 lsb ws16">av<span class="_ _0"/>oid ha<span class="_ _0"/>ving to unnecessarily scan the targets again, b<span class="_ _0"/>ut you also want to ha<span class="_ _0"/>ve that </div><div class="t m0 x3 hd yc0c ff4 fs7 fc0 sc0 lsb ws16">historical data. For e<span class="_ _0"/>xample, if you’<span class="_ _0"/>re tar<span class="_ _0"/>geting an or<span class="_ _0"/>ganization over a long period, </div><div class="t m0 x3 hd yc0d ff4 fs7 fc0 sc0 lsb ws16">you can easily compare the results to identify any ne<span class="_ _0"/>w systems. <span class="_ _2"/>Again, this can be </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>