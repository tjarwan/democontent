<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf112" class="pf w2 h2" data-page-no="112"><div class="pc pc112 w2 h2"><img class="bi xaf y19fb w4 h71" alt="" src="bg112.png"/><div class="t m0 xa3 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 7: Phase III: Remote T<span class="_ _0"/>argeting<span class="_ _9"> </span><span class="ff1 fs9 lsa">251</span></div><div class="t m0 x3 hd y19fc ff4 fs7 fc0 sc0 ls0 ws0">point and get them to authenticate to our rogue RADIUS server<span class="_ _2"/>. By doing this, </div><div class="t m0 x3 hd y19fd ff4 fs7 fc0 sc0 ls0 ws0">we’ll obtain a hashed copy of the user’<span class="_ _2"/>s password, which we can then attempt to </div><div class="t m0 x3 hd y19fe ff4 fs7 fc0 sc0 ls0 ws0">brute-force. The <span class="_ _0"/>WP<span class="_ _1b"/>A-Enterprise architecture is shown in Figure 7-18.</div><div class="t m0 x94 h2f y19ff ffe fs9 fc0 sc0 ls0 ws0">NOTE</div><div class="t m0 x94 h14 y1a00 ff9 fs7 fc0 sc0 ls0 ws0">The only conguration that can stop this attack is if the client devices are congured for mutual </div><div class="t m0 x94 h14 y1a01 ff9 fs7 fc0 sc0 ls0 ws0">authentication. That is, the client device will also authenticate that the access point is an authorized </div><div class="t m0 x94 h14 y1a02 ff9 fs7 fc0 sc0 ls0 ws0">access point.</div><div class="t m0 x4 hd y1a03 ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _3"/>o execute this attack, we’ll use the freeradius-WPE or <span class="_ _0"/>W<span class="_ _2"/>ireless Pwnage Edition </div><div class="t m0 x3 hd y1a04 ff4 fs7 fc0 sc0 ls0 ws0">on a Kali system to act as the RADIUS server that authenticates end users. <span class="_ _0"/>W<span class="_ _3"/>e’ll </div><div class="t m0 x3 hd y1a05 ff4 fs7 fc0 sc0 lsb ws16">congure the access point to authenticate users against this RADIUS server and then </div><div class="t m0 x3 hd y1a06 ff4 fs7 fc0 sc0 ls0 ws0">congure the wireless network as normal. <span class="_ _0"/>These steps hav<span class="_ _0"/>e been tested on Kali 1.0.6 </div><div class="t m0 x3 hd y1a07 ff4 fs7 fc0 sc0 ls0 ws0">and freeradius-server<span class="_ _0"/>-wpe version 2.1.12. If you’<span class="_ _2"/>re having an<span class="_ _0"/>y issues, make sure </div><div class="t m0 x3 hd y1a08 ff4 fs7 fc0 sc0 ls0 ws0">you’<span class="_ _2"/>re using the same versions. <span class="_ _0"/>All of these tasks should be performed as the root </div><div class="t m0 x3 hd y1a09 ff4 fs7 fc0 sc0 ls0 ws0">user<span class="_ _2"/>. The rst thing is to do<span class="_ _0"/>wnload the freeradius-wpe package and install it with the </div><div class="t m0 x3 hd y1a0a ff4 fs7 fc0 sc0 ls0 ws0">follo<span class="_ _0"/>wing commands:</div><div class="t m0 x3 h44 y1a0b fff fse fc0 sc0 ls0 ws0">git clone https://github.com/brad-anton/freeradius-wpe.git</div><div class="t m0 x3 h44 y1a0c fff fse fc0 sc0 ls0 ws0">cd freeradius-wpe/</div><div class="t m0 x3 h44 y1a0d fff fse fc0 sc0 ls0 ws0">dpkg --install freeradius-server-wpe_2.1.12-1_i386.deb</div><div class="t m0 x3 h44 y1a0e fff fse fc0 sc0 ls0 ws0">ldconfig</div><div class="t m0 x4 h3f y1a0f ff4 fs7 fc0 sc0 ls0 ws0">No<span class="_ _0"/>w change the directory to the RADIUS directory and run the <span class="fff">bootstrap</span></div><div class="t m0 x3 hd y1a10 ff4 fs7 fc0 sc0 ls0 ws0">command as sho<span class="_ _0"/>wn:</div><div class="t m0 x3 h44 y1a11 fff fse fc0 sc0 ls0 ws0">cd /usr/local/etc/raddb/certs/</div><div class="t m0 x3 h44 y1a12 fff fse fc0 sc0 ls0 ws0">./bootstrap</div><div class="t m0 x3 h21 y1a13 ff1 fs2 fc0 sc0 ls0 ws0">Figure 7-18<span class="_ _21"> </span><span class="ffc">WP<span class="_ _3"/>A-Enterprise architecture</span></div><div class="t m0 x9a h3e y1a14 ffd fs10 fc0 sc0 ls0 ws0">WPA-Enterprise</div><div class="t m0 xcd h3e y1a15 ffd fs10 fc0 sc0 ls0 ws0">Access Point</div><div class="t m0 x93 h3e y1a16 ffd fs10 fc0 sc0 ls0 ws0">User Submits Unique</div><div class="t m0 xd4 h3e y1a17 ffd fs10 fc0 sc0 ls0 ws0">User Credentials</div><div class="t m0 xbb h3e y1a18 ffd fs10 fc0 sc0 ls0 ws0">Backend RADIUS</div><div class="t m0 xd5 h3e y1a19 ffd fs10 fc0 sc0 ls0 ws0">Authentication Server</div><div class="t m0 xd6 h3e y1a1a ffd fs10 fc0 sc0 ls0 ws0">Wireless Client</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>