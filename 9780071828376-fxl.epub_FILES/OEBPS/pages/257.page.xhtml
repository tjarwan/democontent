<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf101" class="pf w2 h2" data-page-no="101"><div class="pc pc101 w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">234<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">collecting a certain amount of packets, which are then used to deduce the ke<span class="_ _0"/>y<span class="_ _2"/>. The </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">amount of packets can v<span class="_ _0"/>ary greatly between networks, b<span class="_ _0"/>ut generally<span class="_ _2"/>, the amount </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 ls0 ws0">I’<span class="_ _2"/>ve needed is somewhere between 20,000 and 200,000 pack<span class="_ _0"/>ets. I know that seems </div><div class="t m0 x3 hd y210 ff4 fs7 fc0 sc0 ls0 ws0">like a lar<span class="_ _0"/>ge spread, but e<span class="_ _0"/>v<span class="_ _0"/>en with only a moderately busy netw<span class="_ _0"/>ork, we can reach the </div><div class="t m0 x3 hd y211 ff4 fs7 fc0 sc0 ls0 ws0">200,000-packet mark in just a fe<span class="_ _0"/>w hours.</div><div class="t m0 x4 hd y212 ff4 fs7 fc0 sc0 ls0 ws20">Y<span class="_ _1b"/>ou can crack a WEP k<span class="_ _0"/>ey entirely passi<span class="_ _0"/>vely<span class="_ _3"/>, that is, by not sending a single packet </div><div class="t m0 x3 hd y398 ff4 fs7 fc0 sc0 ls0 ws0">to the target access point. <span class="_ _0"/>W<span class="_ _3"/>e can also speed up the process with an activ<span class="_ _0"/>e attack in </div><div class="t m0 x3 hd y399 ff4 fs7 fc0 sc0 ls0 ws0">which we monitor for a specic packet and then replay this packet man<span class="_ _0"/>y times.</div><div class="t m0 x4 hd y124 ff4 fs7 fc0 sc0 ls0 ws0">The fastest I’<span class="_ _2"/>ve e<span class="_ _0"/>ver cracked a <span class="_ _2"/>WEP key by only passi<span class="_ _0"/>vely monitoring w<span class="_ _0"/>as just </div><div class="t m0 x3 hd y125 ff4 fs7 fc0 sc0 ls0 ws0">ov<span class="_ _0"/>er one hour<span class="_ _0"/>, in which I had collected about 100,000 packets from the netw<span class="_ _0"/>ork. The </div><div class="t m0 x3 hd y126 ff4 fs7 fc0 sc0 ls0 ws0">fastest I’<span class="_ _2"/>ve e<span class="_ _0"/>ver cracked a <span class="_ _2"/>WEP key using the acti<span class="_ _0"/>ve method w<span class="_ _0"/>as within about 15 </div><div class="t m0 x3 hd y39a ff4 fs7 fc0 sc0 ls0 ws0">minutes after collecting about 20,000 packets.</div><div class="t m0 x4 hd y39b ff4 fs7 fc0 sc0 ls0 ws0">Passi<span class="_ _0"/>v<span class="_ _0"/>ely collecting <span class="_ _0"/>WEP encrypted packets is as easy as it sounds. The best tool </div><div class="t m0 x3 hd y39c ff4 fs7 fc0 sc0 ls0 ws0">to capture these packets is airodump, part of the aircrack-ng suite. Since airodump </div><div class="t m0 x3 hd y39d ff4 fs7 fc0 sc0 ls0 ws0">is built for compromising wireless netw<span class="_ _0"/>orks, the default display gi<span class="_ _0"/>ves us v<span class="_ _0"/>aluable </div><div class="t m0 x3 hd y39e ff4 fs7 fc0 sc0 ls0 ws0">information with little uf<span class="_ _0"/>f.</div><div class="t m0 x4 h3f y39f ff4 fs7 fc0 sc0 ls0 ws0">First, we need to put our interface into monitor mode using the <span class="fff">airmon-ng</span></div><div class="t m0 x3 hd y162b ff4 fs7 fc0 sc0 ls0 ws0">command as follo<span class="_ _0"/>ws:</div><div class="t m0 x3 h44 y1850 fff fse fc0 sc0 ls0 ws0">root@kali:/# airmon-ng start wlan0</div><div class="t m0 x3 h44 y1851 fff fse fc0 sc0 ls0 ws0">--- SNIP ---</div><div class="t m0 x3 h44 y1852 fff fse fc0 sc0 ls0 ws0">Interface   Chipset           Driver</div><div class="t m0 x3 h44 y1853 fff fse fc0 sc0 ls0 ws0">wlan0       Intel 5300AGN     iwlwifi - [phy0]</div><div class="t m0 x3 h44 y1854 fff fse fc0 sc0 ls0 ws0">                        (monitor mode enabled on mon0)</div><div class="t m0 x4 hd y1855 ff4 fs7 fc0 sc0 ls0 ws0">After we identify the BSSID and channel of the target netw<span class="_ _0"/>ork, we can congure </div><div class="t m0 x3 hd y1856 ff4 fs7 fc0 sc0 ls0 ws0">airodump to monitor only that network using the follo<span class="_ _0"/>wing command:</div><div class="t m0 x3 h44 y1857 fff fse fc0 sc0 ls0 ws0">root@kali:~# airodump-ng -w out -c 1 --bssid 02:E9:FF:34:E7:F4 mon0</div><div class="t m0 x4 hd y1858 ff4 fs7 fc0 sc0 ls0 ws0">In the pre<span class="_ _0"/>vious example, we’<span class="_ _2"/>re telling airodump to save all the les with the prex </div><div class="t m0 x3 hd y1859 ff4 fs7 fc0 sc0 ls0 ws0">out (-w out), to listen only on channel 1 and not channel hop (-c 1), and to only log </div><div class="t m0 x3 hd y185a ff4 fs7 fc0 sc0 ls0 ws0">packets for the tar<span class="_ _0"/>get BSSID of 02:E9:FF:34:E7:F4 ( --bssid 02:E9:FF:34:E7:F4), </div><div class="t m0 x3 hd y185b ff4 fs7 fc0 sc0 ls0 ws0">and the nal option is the monitor mode interface to listen on. </div><div class="t m0 x3 h40 y185c fff fs5 fc0 sc0 ls0 ws0">CH  1 ][ Elapsed: 30 mins ][ 2014-03-10 18:45 ][ fixed channel mon0: -1</div><div class="t m0 x3 h40 y185d fff fs5 fc0 sc0 ls0 ws0">BSSID              PWR RXQ  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH </div><div class="t m0 x3 h40 y185e fff fs5 fc0 sc0 ls0 ws0">ESSID</div><div class="t m0 x3 h40 y185f fff fs5 fc0 sc0 ls0 ws0">02:E9:FF:34:E7:F4   -1   0    13896    60040   70   1  54 . WEP  WEP</div><div class="t m0 x3 h40 y1860 fff fs5 fc0 sc0 ls0 ws0">WeakNet</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>