<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf7c" class="pf w2 h2" data-page-no="7c"><div class="pc pc7c w2 h2"><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">101</span></div><div class="t m0 x3 h44 yb3f fff fse fc0 sc0 ls0 ws0">  3257 7018 1226</div><div class="t m0 x3 h44 yb40 fff fse fc0 sc0 ls0 ws0">    89.149.178.10 (inaccessible) from 89.149.178.10 (213.200.87.91)</div><div class="t m0 x3 h44 yb41 fff fse fc0 sc0 ls0 ws0">      Origin IGP, metric 10, localpref 100, valid, external</div><div class="t m0 x3 h44 yb42 fff fse fc0 sc0 ls0 ws0">      Community: 3257:8093 3257:30150 3257:50002 3257:51100 </div><div class="t m0 x3 h44 yb43 fff fse fc0 sc0 ls0 ws0">3257:51102</div><div class="t m0 x3 h44 yb44 fff fse fc0 sc0 ls0 ws0">--- SNIP ---</div><div class="t m0 x3 h44 yb45 fff fse fc0 sc0 ls0 ws0">route-views&gt;</div><div class="t m0 x4 hd yb46 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou can see by the rst line of output that the route to this network is being </div><div class="t m0 x3 hd yb47 ff4 fs7 fc0 sc0 lsb ws16">advertised as a /16 subnet. <span class="_ _0"/>That means the organization that manages this system </div><div class="t m0 x3 hd yb48 ff4 fs7 fc0 sc0 ls0 ws0">probably o<span class="_ _0"/>wns the entire 134.186.0.0 through 134.186.255.255 IP address range. </div><div class="t m0 x3 hd yb49 ff4 fs7 fc0 sc0 ls0 ws0">The next line tells us the router has 32 distinct paths to the destination subnet. K<span class="_ _0"/>eep </div><div class="t m0 x3 hd yb4a ff4 fs7 fc0 sc0 lsb ws16">in mind this is 32 paths—this does not mean the target or<span class="_ _0"/>ganization has 32 unique </div><div class="t m0 x3 hd yb4b ff4 fs7 fc0 sc0 ls0 ws0">connections to the Internet.</div><div class="t m0 x4 hd yb4c ff4 fs7 fc0 sc0 ls0 ws0">The most meaningful thing for us is the fourth line of output:</div><div class="t m0 x65 hd yb4d ff4 fs7 fc0 sc0 ls0 ws0">3277 3267 9002 7385 1226</div><div class="t m0 x4 hd yb4e ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou’ll notice that sev<span class="_ _0"/>eral lines look similar<span class="_ _0"/>, with what appears to be a some<span class="_ _0"/>what </div><div class="t m0 x3 hd yb4f ff4 fs7 fc0 sc0 ls0 ws0">random string of numbers. <span class="_ _2"/>Although this may look like a random string of numbers, </div><div class="t m0 x3 hd yb50 ff4 fs7 fc0 sc0 ls0 ws0">these are actually the paths to the destination network as a series of <span class="_ _2"/>AS numbers. </div><div class="t m0 x3 hd yb51 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou’ll observe that all of the lines with the <span class="_ _2"/>AS path number end with 1226. This </div><div class="t m0 x3 hd yb52 ff4 fs7 fc0 sc0 ls0 ws0">means that the 1226 <span class="_ _2"/>AS number is the last public hop for the 134.186.0.0/16 subnet.</div><div class="t m0 x4 hd yb53 ff4 fs7 fc0 sc0 lsb ws1d">W<span class="_ _3"/>e can assume this is probably the <span class="_ _0"/>ASN for our target or<span class="_ _0"/>ganization, b<span class="_ _0"/>ut let’<span class="_ _2"/>s see if </div><div class="t m0 x3 hd yb54 ff4 fs7 fc0 sc0 ls0 ws0">we’<span class="_ _2"/>re correct. W<span class="_ _3"/>e can search the <span class="_ _0"/>ARIN website with just the number 1226, or we can </div><div class="t m0 x3 h3f yb55 ff4 fs7 fc0 sc0 ls0 ws0">use the <span class="fff">whois</span> command. <span class="_ _0"/>When searching for an <span class="_ _2"/>AS, we can prepend the number </div><div class="t m0 x3 hd yb56 ff4 fs7 fc0 sc0 ls0 ws0">with “<span class="_ _3"/>AS,<span class="_ _0"/>” as sho<span class="_ _0"/>wn in the follo<span class="_ _0"/>wing code:</div><div class="t m0 x3 h44 yb57 fff fse fc0 sc0 ls0 ws0">user@kali:~$ whois AS1226</div><div class="t m0 x3 h44 yb58 fff fse fc0 sc0 ls0 ws0">--- SNIP ---</div><div class="t m0 x3 h44 yb59 fff fse fc0 sc0 ls0 ws0">ASNumber:       1226</div><div class="t m0 x3 h44 yb5a fff fse fc0 sc0 ls0 ws0">ASName:         CTA-42-AS1226</div><div class="t m0 x3 h44 yb5b fff fse fc0 sc0 ls0 ws0">ASHandle:       AS1226</div><div class="t m0 x3 h44 yb5c fff fse fc0 sc0 ls0 ws0">RegDate:        1991-02-28</div><div class="t m0 x3 h44 yb5d fff fse fc0 sc0 ls0 ws0">Updated:        2012-10-10</div><div class="t m0 x3 h44 yb5e fff fse fc0 sc0 ls0 ws0">Ref:            http://whois.arin.net/rest/asn/AS1226</div><div class="t m0 x3 h44 yb5f fff fse fc0 sc0 ls0 ws0">OrgName:        California Technology Agency</div><div class="t m0 x3 h44 yb60 fff fse fc0 sc0 ls0 ws0">OrgId:          CTA-42</div><div class="t m0 x3 h44 yb61 fff fse fc0 sc0 ls0 ws0">Address:        P.O. Box 1810</div><div class="t m0 x3 h44 yb62 fff fse fc0 sc0 ls0 ws0">City:           Rancho Cordova</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>