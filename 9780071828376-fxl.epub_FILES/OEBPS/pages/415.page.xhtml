<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf19f" class="pf w2 h2" data-page-no="19f"><div class="pc pc19f w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">392<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x16 h1f y447 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y448 ff4 fs7 fc0 sc0 ls0 ws0">Really Simple Syndication (RSS) feed systems</div><div class="t m0 x16 h1f y7a2 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y7a3 ff4 fs7 fc0 sc0 ls0 ws0">Chat or instant messaging systems</div><div class="t m0 x16 h1f y7a4 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y7a5 ff4 fs7 fc0 sc0 ls0 ws0">Software update systems</div><div class="t m0 x4 hd y7a6 ff4 fs7 fc0 sc0 ls0 ws0">Next, we must consider the destination IP addresses that the backdoor will </div><div class="t m0 x3 hd y7a7 ff4 fs7 fc0 sc0 ls0 ws0">communicate with. Many modern netw<span class="_ _0"/>ork monitoring systems can include the </div><div class="t m0 x3 hd y7a8 ff4 fs7 fc0 sc0 ls0 ws0">country associated with an IP address. In addition, some systems may provide the </div><div class="t m0 x3 hd y7a9 ff4 fs7 fc0 sc0 ls0 ws0">Whois or <span class="_ _2"/>American Registry for Internet Numbers (ARIN)–related data. <span class="_ _2"/>Although </div><div class="t m0 x3 hd y7aa ff4 fs7 fc0 sc0 ls0 ws0">a specic country may not necessarily raise any red ags, if your softw<span class="_ _0"/>are claims </div><div class="t m0 x3 hd y7ab ff4 fs7 fc0 sc0 ls0 ws0">to be from a specic company b<span class="_ _0"/>ut is communicating with an IP address in an </div><div class="t m0 x3 hd y7ac ff4 fs7 fc0 sc0 ls0 ws0">unrelated country or in an abnormal network range, such as a pri<span class="_ _0"/>v<span class="_ _0"/>ate <span class="_ _0"/>V<span class="_ _2"/>irtual Pri<span class="_ _0"/>v<span class="_ _0"/>ate </div><div class="t m0 x3 hd y7ad ff4 fs7 fc0 sc0 lsb ws16">Server (VPS) hosting pro<span class="_ _0"/>vider<span class="_ _0"/>, this can encourage an administrator to in<span class="_ _0"/>v<span class="_ _0"/>estigate </div><div class="t m0 x3 hd y7ae ff4 fs7 fc0 sc0 ls0 ws0">further<span class="_ _2"/>. Because identifying DNS, Whois, and <span class="_ _2"/>ARIN information is considered </div><div class="t m0 x3 hd y7af ff4 fs7 fc0 sc0 ls0 ws0">to be a fundamental task e<span class="_ _0"/>ven for a edgling network administrator<span class="_ _2"/>, you should </div><div class="t m0 x3 hd y250c ff4 fs7 fc0 sc0 lsb ws16">assume this information will be in<span class="_ _0"/>v<span class="_ _0"/>estigated by anyone looking into the backdoor </div><div class="t m0 x3 hd y250d ff4 fs7 fc0 sc0 ls0 ws16">communications.</div><div class="t m0 x4 hd y250e ff4 fs7 fc0 sc0 ls0 ws0">Choosing the correct communication protocol is also a critical step. T<span class="_ _2"/>raditionally<span class="_ _0"/>, </div><div class="t m0 x3 hd y250f ff4 fs7 fc0 sc0 ls0 ws0">many backdoors and <span class="_ _0"/>T<span class="_ _0"/>rojan software ha<span class="_ _0"/>ve used the IRC, or Internet Relay Chat </div><div class="t m0 x3 hd y2510 ff4 fs7 fc0 sc0 ls0 ws0">system, for communication with the operator and C2 server<span class="_ _2"/>. T<span class="_ _3"/>oday<span class="_ _2"/>, this is way </div><div class="t m0 x3 hd y2511 ff4 fs7 fc0 sc0 ls0 ws0">too obvious a choice and w<span class="_ _0"/>ould be considered a huge red ag by any network </div><div class="t m0 x3 hd y2512 ff4 fs7 fc0 sc0 ls0 ws0">administrator<span class="_ _2"/>.</div><div class="t m0 x4 hd y2513 ff4 fs7 fc0 sc0 ls0 ws0">If you were to ask any netw<span class="_ _0"/>ork administrator today which protocol is the most </div><div class="t m0 x3 hd y2514 ff4 fs7 fc0 sc0 ls0 ws0">common they observ<span class="_ _0"/>e passing through their re<span class="_ _0"/>wall, they will almost al<span class="_ _0"/>ways reply </div><div class="t m0 x3 hd y2515 ff4 fs7 fc0 sc0 ls0 ws0">HTTP or HTTPS. For this reason, HTTP is a great choice and will be the protocol </div><div class="t m0 x3 hd y2516 ff4 fs7 fc0 sc0 ls15 ws0">we focus on in this chapter<span class="_ _2"/>. By blending in with the vast majority of network<span class="_ _0"/> </div><div class="t m0 x3 hd y2517 ff4 fs7 fc0 sc0 ls15 ws0">trafc, <span class="ls0">we can guarantee the continued operation of our backdoor e<span class="_ _0"/>ven when our </span></div><div class="t m0 x3 hd y2518 ff4 fs7 fc0 sc0 lsb ws16">protocol is directly interrogated.</div><div class="t m0 x4 hd y2519 ff4 fs7 fc0 sc0 ls0 ws0">By using an HTTP-based protocol, we can also easily choose to communicate </div><div class="t m0 x3 hd y251a ff4 fs7 fc0 sc0 ls0 ws0">ov<span class="_ _0"/>er an encrypted tunnel via HTTPS without much additional ef<span class="_ _0"/>fort in our </div><div class="t m0 x3 hd y251b ff4 fs7 fc0 sc0 ls0 ws0">source code. <span class="_ _2"/>Although it may seem immediately advantageous to protect our </div><div class="t m0 x3 hd y251c ff4 fs7 fc0 sc0 ls0 ws0">communication from prying eyes by utilizing encryption, we must rst consider ho<span class="_ _0"/>w </div><div class="t m0 x3 hd y251d ff4 fs7 fc0 sc0 ls0 ws0">that will af<span class="_ _0"/>fect the perception of our trafc. In many cases, it may be better for us to </div><div class="t m0 x3 hd y251e ff4 fs7 fc0 sc0 ls0 ws0">hide in plain sight and not utilize encryption.</div><div class="t m0 x4 hd y251f ff4 fs7 fc0 sc0 ls0 ws0">There are also some network monitoring systems capable of intercepting and </div><div class="t m0 x3 hd y2520 ff4 fs7 fc0 sc0 ls0 ws0">vie<span class="_ _0"/>wing trafc secured by Secure Sockets Layer (SSL) and T<span class="_ _2"/>ransport Layer Security </div><div class="t m0 x3 hd y2521 ff4 fs7 fc0 sc0 ls15 ws0">(TLS), such as HTTPS. These systems basically implement “sanctioned” SSL<span class="_ _0"/> </div><div class="t m0 x3 hd y2522 ff4 fs7 fc0 sc0 ls15 ws0">man-<span class="ls0">in-the-middle attacks by utilizing trusted root certicates to generate certicates </span></div><div class="t m0 x3 hd y2523 ff4 fs7 fc0 sc0 ls0 ws0">on the y<span class="_ _2"/>. Thus, if we choose to implement encryption, we’ll w<span class="_ _0"/>ant to include </div><div class="t m0 x3 hd y2524 ff4 fs7 fc0 sc0 ls0 ws0">the ability to detect if our communication is being tampered with and respond </div><div class="t m0 x3 hd y2525 ff4 fs7 fc0 sc0 ls0 ws0">appropriately<span class="_ _2"/>.</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>