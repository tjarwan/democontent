<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf118" class="pf w2 h2" data-page-no="118"><div class="pc pc118 w2 h2"><div class="t m0 xa3 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 7: Phase III: Remote T<span class="_ _0"/>argeting<span class="_ _9"> </span><span class="ff1 fs9 lsa">257</span></div><div class="t m0 x16 h1f y447 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y448 ff4 fs7 fc0 sc0 ls0 ws0">Proxy the user connection to the legitimate site</div><div class="t m0 x16 h1f y7a2 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y7a3 ff4 fs7 fc0 sc0 ls0 ws0">Record all GET and POST requests</div><div class="t m0 x16 h1f y7a4 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y7a5 ff4 fs7 fc0 sc0 ls0 ws0">Inject hidden iframes to steal cookies</div><div class="t m0 x16 h1f y936 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y937 ff4 fs7 fc0 sc0 lsb ws16">Inject hidden iframe to gather <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws credentials</div><div class="t m0 x16 h1f y1acc ffb fse fc0 sc0 ls0 ws16">c</div><div class="t m0 x1 hd y1acd ff4 fs7 fc0 sc0 ls0 ws0">Inject hidden iframe with signed Jav<span class="_ _0"/>a applet</div><div class="t m0 x16 h1f y1ace ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1acf ff4 fs7 fc0 sc0 ls0 ws0">Inject hidden iframe with bro<span class="_ _0"/>wser_autopwn</div><div class="t m0 x16 h1f y1ad0 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1ad1 ff4 fs7 fc0 sc0 ls0 ws0">Host malicious ex<span class="_ _0"/>ecutable and prompt user to install to use hotspot</div><div class="t m0 x4 hd y1ad2 ff4 fs7 fc0 sc0 lsb ws16">Cookie stealing isn’t the most ef<span class="_ _0"/>fecti<span class="_ _0"/>ve attack against major websites an<span class="_ _0"/>y more </div><div class="t m0 x3 hd y1ad3 ff4 fs7 fc0 sc0 ls0 ws0">since the introduction of security ags like Secure, HostOnly<span class="_ _2"/>, and HTTPOnly ags. </div><div class="t m0 x3 hd y1ad4 ff4 fs7 fc0 sc0 lsb ws16">Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, it’<span class="_ _2"/>s still common to nd custom applications at organizations that don’<span class="_ _0"/>t </div><div class="t m0 x3 hd y1ad5 ff4 fs7 fc0 sc0 ls0 ws0">hav<span class="_ _0"/>e these cookie ags set.</div><div class="t m0 x4 hd y1ad6 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e’ll also deliv<span class="_ _0"/>er a specially crafted iframe that references a le with a UNC </div><div class="t m0 x3 hd y1ad7 ff4 fs7 fc0 sc0 ls0 ws0">(Uni<span class="_ _0"/>versal Naming Con<span class="_ _0"/>v<span class="_ _0"/>ention) path in an attempt to grab the user’<span class="_ _2"/>s hashed </div><div class="t m0 x3 hd y1ad8 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _0"/>indo<span class="_ _0"/>ws password. Finally<span class="_ _3"/>, we’ll fall back on some of the exploits we discussed in </div><div class="t m0 x3 hd y1ad9 ff4 fs7 fc0 sc0 ls0 ws0">the pre<span class="_ _0"/>vious chapter using browser_autopwn or a signed Ja<span class="_ _0"/>v<span class="_ _0"/>a applet. <span class="_ _0"/>W<span class="_ _3"/>e can also </div><div class="t m0 x3 hd y1ada ff4 fs7 fc0 sc0 ls0 ws0">choose to take more of a social engineering tactic and prompt the user to install an </div><div class="t m0 x3 hd y1adb ff4 fs7 fc0 sc0 ls0 ws0">ex<span class="_ _0"/>ecutable to access the hotspot. This might seem lik<span class="_ _0"/>e a low-tech approach that </div><div class="t m0 x3 hd y1adc ff4 fs7 fc0 sc0 ls0 ws0">might be too simple, but this has actually w<span class="_ _0"/>orked for me on se<span class="_ _0"/>veral occasions.</div><div class="t m0 x3 h7 y1add ff1 fs3 fc0 sc0 ls0 ws0">Logging</div><div class="t m0 x3 hd y1ade ff4 fs7 fc0 sc0 ls0 ws0">There will be so much happening on our access point, much of which is happening </div><div class="t m0 x3 hd y1adf ff4 fs7 fc0 sc0 ls0 ws0">simultaneously<span class="_ _2"/>, that it can sometimes be hard to decode and understand it all at once. </div><div class="t m0 x3 hd y1ae0 ff4 fs7 fc0 sc0 ls0 ws0">Thus, we want to record as much information as possible, so if we are unsuccessful </div><div class="t m0 x3 hd y1ae1 ff4 fs7 fc0 sc0 lsb ws16">in our rst attempt, we can come back again for a future attack and be better </div><div class="t m0 x3 hd y1ae2 ff4 fs7 fc0 sc0 ls0 ws0">prepared to target a specic weakness. Some of the specic things we’<span class="_ _0"/>ll want to </div><div class="t m0 x3 hd y1ae3 ff4 fs7 fc0 sc0 ls0 ws0">record and re<span class="_ _0"/>view include</div><div class="t m0 x16 h1f y1ae4 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1ae5 ff4 fs7 fc0 sc0 ls0 ws0">Record all network trafc in a PCAP le</div><div class="t m0 x16 h1f y1ae6 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1ae7 ff4 fs7 fc0 sc0 ls0 ws0">Log all DNS requests made by the client</div><div class="t m0 x16 h1f y1ae8 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1ae9 ff4 fs7 fc0 sc0 ls0 ws0">Log all HTTP requests and information</div><div class="t m0 x16 h1f y1aea ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y1aeb ff4 fs7 fc0 sc0 ls0 ws0">Log and correlate all MA<span class="_ _0"/>C addresses IP addresses and hostnames </div><div class="t m0 x4 hd y1aec ff4 fs7 fc0 sc0 ls0 ws0">By recording all of the network trafc into a PCAP le, we can be sure that we </div><div class="t m0 x3 hd y1aed ff4 fs7 fc0 sc0 ls0 ws0">can analyze e<span class="_ _0"/>verything that happened. <span class="_ _0"/>W<span class="_ _3"/>e can utilize W<span class="_ _2"/>ireshark to easily explore the </div><div class="t m0 x3 hd y1aee ff4 fs7 fc0 sc0 ls0 ws0">network trafc, b<span class="_ _0"/>ut there are other good options to perform automatic analysis of </div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>