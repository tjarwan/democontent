<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf18f" class="pf w2 h2" data-page-no="18f"><div class="pc pc18f w2 h2"><img class="bi x94 y1413 w6 h2e" alt="" src="bg18f.png"/><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">376<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x4 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">Thus, if an operating system is loaded, the decryption ke<span class="_ _0"/>ys will be stored in </div><div class="t m0 x3 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">memory<span class="_ _2"/>, ev<span class="_ _0"/>en when there are no users logged in to the operating system. <span class="_ _2"/>All we </div><div class="t m0 x3 hd y19a ff4 fs7 fc0 sc0 ls0 ws0">need to do is “cold boot” the system, essentially rebooting the system without going </div><div class="t m0 x3 hd y291 ff4 fs7 fc0 sc0 ls0 ws0">through a proper shutdo<span class="_ _0"/>wn and booting to another minimal OS, such as booting </div><div class="t m0 x3 hd y424 ff4 fs7 fc0 sc0 ls0 ws0">to a li<span class="_ _0"/>ve Linux USB image. <span class="_ _0"/>W<span class="_ _3"/>e can then copy the contents of the memory chips to </div><div class="t m0 x3 hd y425 ff4 fs7 fc0 sc0 ls0 ws0">another dri<span class="_ _0"/>ve to e<span class="_ _0"/>xamine later and extract the decryption ke<span class="_ _0"/>y<span class="_ _2"/>.</div><div class="t m0 x4 hd y426 ff4 fs7 fc0 sc0 ls0 ws0">In addition, we can extend the time that the data will remain in the memory chips </div><div class="t m0 x3 hd y427 ff4 fs7 fc0 sc0 ls0 ws0">by making them extremely cold. One common w<span class="_ _0"/>ay is to use a can of compressed air<span class="_ _0"/>, </div><div class="t m0 x3 hd y428 ff4 fs7 fc0 sc0 ls0 ws0">typically sold to clean of<span class="_ _0"/>f computer equipment. If you turn the can upside down and </div><div class="t m0 x3 hd y429 ff4 fs7 fc0 sc0 ls0 ws0">spray the chips, the air will make the chips e<span class="_ _0"/>xtremely cold, greatly increasing the </div><div class="t m0 x3 hd yaa1 ff4 fs7 fc0 sc0 ls0 ws0">time the data stays on them.</div><div class="t m0 x4 hd yaa2 ff4 fs7 fc0 sc0 ls12 ws0">There are also commercial programs, for example, the F<span class="_ _0"/>orensic Disk Decryptor </div><div class="t m0 x3 hd y121f ff4 fs7 fc0 sc0 ls12 ws0">av<span class="_ _0"/>ailable from Elcomsoft, which can obtain the decryption k<span class="_ _0"/>eys for BitLocker<span class="_ _2"/>, PGP<span class="_ _3"/>, </div><div class="t m0 x3 hd y1220 ff4 fs7 fc0 sc0 ls12 ws0">and T<span class="_ _2"/>ruecrypt! The tool supports three methods for obtaining the decryption ke<span class="_ _0"/>ys. If </div><div class="t m0 x3 hd y1221 ff4 fs7 fc0 sc0 ls12 ws0">the system is po<span class="_ _0"/>wered on and you hav<span class="_ _0"/>e administrati<span class="_ _0"/>ve credentials, you can obtain a </div><div class="t m0 x3 hd y1222 ff4 fs7 fc0 sc0 ls12 ws0">memory dump using a tool such as MoonSols <span class="_ _0"/>W<span class="_ _0"/>indo<span class="_ _0"/>ws Memory T<span class="_ _3"/>oolkit. If the system </div><div class="t m0 x3 hd y2372 ff4 fs7 fc0 sc0 ls12 ws0">is po<span class="_ _0"/>wered off, you can obtain the k<span class="_ _0"/>eys from a hibernation le. Finally<span class="_ _3"/>, you can also<span class="_ _1"/> </div><div class="t m0 x3 hd y2373 ff4 fs7 fc0 sc0 ls12 ws0">obtain the decryption ke<span class="_ _0"/>ys with a FireW<span class="_ _0"/>ire attack while the computer is po<span class="_ _0"/>wered on.</div><div class="t m0 x4 hd y2374 ff4 fs7 fc0 sc0 ls0 ws0">Certain FireW<span class="_ _0"/>ire de<span class="_ _0"/>vices are allo<span class="_ _0"/>wed direct memory access (DMA) to increase </div><div class="t m0 x3 hd y1224 ff4 fs7 fc0 sc0 ls0 ws0">performance. <span class="_ _3"/>Y<span class="_ _3"/>es, that is correct—certain FireW<span class="_ _0"/>ire devices can directly manipulate </div><div class="t m0 x3 hd y1225 ff4 fs7 fc0 sc0 ls0 ws0">memory up to 4GB. Using the Inception tool from www<span class="_ _2"/>.breaknenter<span class="_ _0"/>.or<span class="_ _0"/>g, we can </div><div class="t m0 x3 hd y1226 ff4 fs7 fc0 sc0 lsb ws16">perform multiple attacks against po<span class="_ _0"/>wered-on systems with FireW<span class="_ _0"/>ire ports.</div><div class="t m0 x4 hd y2375 ff4 fs7 fc0 sc0 ls16 ws0">Install the Inception tool on a portable system with a FireW<span class="_ _0"/>ire interface as follo<span class="_ _0"/>ws:</div><div class="t m0 x3 h44 y2376 fff fse fc0 sc0 ls0 ws0">root@kali:~# git clone https://github.com/carmaa/inception.git</div><div class="t m0 x4 h3f y2377 ff4 fs7 fc0 sc0 ls12 ws0">Then start with the <span class="fff">incept</span> command. T<span class="_ _3"/>o dump all memory up to 4 GB, use incept </div><div class="t m0 x3 hd y2378 ff4 fs7 fc0 sc0 ls12 ws0">with the -D switch as sho<span class="_ _0"/>wn next. <span class="_ _3"/>Y<span class="_ _1b"/>ou can then analyze the contents of the dump with</div><div class="t m0 x3 h44 y2379 fff fse fc0 sc0 ls0 ws0">root@kali:~# incept -D </div><div class="t m0 x4 hd y237a ff4 fs7 fc0 sc0 ls0 ws0">In addition, Inception can unlock a booted system that does not currently hav<span class="_ _0"/>e </div><div class="t m0 x3 hd y237b ff4 fs7 fc0 sc0 ls0 ws0">a user logged in—that is, it is past the FDE password b<span class="_ _0"/>ut waiting for the user </div><div class="t m0 x3 hd y237c ff4 fs7 fc0 sc0 ls0 ws0">credentials. This is done by nonpersistent in-memory patching, which means that </div><div class="t m0 x3 hd y237d ff4 fs7 fc0 sc0 ls0 ws0">once you reboot the system, there is no indication of its acti<span class="_ _0"/>vities.</div><div class="t m0 x94 h2f y237e ffe fs9 fc0 sc0 ls0 ws0">NOTE</div><div class="t m0 x94 h14 y237f ff9 fs7 fc0 sc0 ls0 ws0">Even if the system has a BIOS password set, you don’t need to clear the BIOS password, although </div><div class="t m0 x94 h14 y2380 ff9 fs7 fc0 sc0 ls0 ws0">this is a trivial task. Instead, you can remove the hard drive, use an external hard drive mount, </div><div class="t m0 x94 h14 y2381 ff9 fs7 fc0 sc0 ls0 ws0">backdoor the bootloader<span class="_ _2"/>, and then replace the hard drive back in the system.</div><a class="" href="http://www.breaknenter.org"><div class="d m1" style="border-style:none;position:absolute;left:365.351474px;bottom:377.372638px;width:97.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>