<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf85" class="pf w2 h2" data-page-no="85"><div class="pc pc85 w2 h2"><div class="t m0 xc h10 y83 ff1 fs9 fc0 sc0 lsa ws0">110<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x57 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou can check out the masscan program and download it at https://github<span class="_ _0"/>.com/</div><div class="t m0 x57 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">robertdavidgraham/masscan. </div><div class="t m0 x58 hd y11e ff4 fs7 fc0 sc0 ls0 ws0">The basic usage of masscan can be seen in the follo<span class="_ _0"/>wing output. In this example, </div><div class="t m0 x57 hd y11f ff4 fs7 fc0 sc0 ls0 ws0">we’<span class="_ _2"/>ve specied a list of individual ports to scan. <span class="_ _0"/>W<span class="_ _3"/>e can just as easily scan a range </div><div class="t m0 x57 hd y120 ff4 fs7 fc0 sc0 ls0 ws0">of ports. For e<span class="_ _0"/>xample, we can scan the standard port range with -p1-1024, or we can </div><div class="t m0 x57 hd y121 ff4 fs7 fc0 sc0 ls0 ws0">scan all ports with -p1-65535. <span class="_ _0"/>W<span class="_ _3"/>e then will save the output as an XML le called </div><div class="t m0 x57 h3f y398 ff4 fs7 fc0 sc0 ls0 ws0">masscan.xml. This mak<span class="_ _0"/>es it easy to <span class="fff">grep</span> for important data. Finally<span class="_ _2"/>, we giv<span class="_ _0"/>e it the </div><div class="t m0 x57 hd y399 ff4 fs7 fc0 sc0 ls0 ws0">target range of addresses—in this case, the entire Class <span class="_ _2"/>A 10 network.</div><div class="t m0 x58 hd y124 ff4 fs7 fc0 sc0 lsb ws16">W<span class="_ _0"/>ith a decent machine and a good gigabit connection, you can easily complete </div><div class="t m0 x57 hd y125 ff4 fs7 fc0 sc0 ls0 ws0">this scan in less than two minutes! F<span class="_ _0"/>or a class <span class="_ _0"/>A netw<span class="_ _0"/>ork, that’<span class="_ _2"/>s 16,777,214 hosts. </div><div class="t m0 x57 hd y126 ff4 fs7 fc0 sc0 ls0 ws0">That’<span class="_ _2"/>s right—over 16 million hosts in less than two minutes: pretty impressi<span class="_ _0"/>v<span class="_ _0"/>e. </div><div class="t m0 x57 hd y39a ff4 fs7 fc0 sc0 ls0 ws0">Masscan also has a feature that allo<span class="_ _0"/>ws you to pause the scan and resume at any time, </div><div class="t m0 x57 hd y39b ff4 fs7 fc0 sc0 ls0 ws0">which can obviously be helpful when scanning v<span class="_ _0"/>ery large netw<span class="_ _0"/>ork ranges:</div><div class="t m0 x57 h44 yc4e fff fse fc0 sc0 ls0 ws0">masscan -p21,22,23,80,139,443,445,8080 -oX masscan.xml 10.0.0.0/8</div><div class="t m0 x58 hd yc4f ff4 fs7 fc0 sc0 ls0 ws0">The only shortcomings of masscan are that it’<span class="_ _2"/>s limited to basic functionality of </div><div class="t m0 x57 hd yc50 ff4 fs7 fc0 sc0 ls0 ws0">port scanning. So it doesn’t ha<span class="_ _0"/>ve the ability to do service identication or an<span class="_ _0"/>y of </div><div class="t m0 x57 hd yc51 ff4 fs7 fc0 sc0 ls0 ws0">the other adv<span class="_ _0"/>anced features that nmap has, but it’<span class="_ _2"/>s denitely a great place to start. </div><div class="t m0 x57 hd yc52 ff4 fs7 fc0 sc0 ls0 ws0">Ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, by starting with masscan, you can rst identify li<span class="_ _0"/>ve hosts and ports to then </div><div class="t m0 x57 hd yc53 ff4 fs7 fc0 sc0 ls0 ws0">feed to nmap to do additional service identication. </div><div class="t m0 x58 hd yc54 ff4 fs7 fc0 sc0 ls0 ws0">There’<span class="_ _2"/>s another good project that looks promising called ZMap, which you can </div><div class="t m0 x57 hd yc55 ff4 fs7 fc0 sc0 ls0 ws0">do<span class="_ _0"/>wnload at https://github<span class="_ _0"/>.com/zmap/zmap. <span class="_ _2"/>Although currently the functionality is </div><div class="t m0 x57 hd yc56 ff4 fs7 fc0 sc0 ls0 ws0">almost identical to masscan, the project is still acti<span class="_ _0"/>vely under de<span class="_ _0"/>velopment and will </div><div class="t m0 x57 hd yc57 ff4 fs7 fc0 sc0 ls0 ws0">likely include some of the service identication and scripting features of nmap. <span class="_ _0"/>The </div><div class="t m0 x57 hd yc58 ff4 fs7 fc0 sc0 ls0 ws0">makers of ZMap state that it is “capable of performing a complete scan of the IPv4 </div><div class="t m0 x57 hd yc59 ff4 fs7 fc0 sc0 ls0 ws0">address space in under 45 minutes”—that sounds pretty impressi<span class="_ _0"/>ve as well.</div><div class="t m0 x57 h4 yc5a ff2 fs1 fc0 sc0 ls0 ws0">W<span class="_ _0"/>eb Ser<span class="_ _1"/>vice Enumeration</div><div class="t m0 x57 hd yc5b ff4 fs7 fc0 sc0 ls0 ws0">No<span class="_ _0"/>w that we hav<span class="_ _0"/>e the information from port scanning our target netw<span class="_ _0"/>ork, let’<span class="_ _2"/>s </div><div class="t m0 x57 hd yc5c ff4 fs7 fc0 sc0 ls0 ws0">identify a fe<span class="_ _0"/>w important services. One of the main types of services we want to </div><div class="t m0 x57 hd yc5d ff4 fs7 fc0 sc0 ls0 ws0">identify are remote access services. Many times, these systems will operate o<span class="_ _0"/>ver a </div><div class="t m0 x57 hd yc5e ff4 fs7 fc0 sc0 ls0 ws0">standard web port or at least hav<span class="_ _0"/>e some type of helper web service.</div><div class="t m0 x58 hd yc5f ff4 fs7 fc0 sc0 lsb ws16">Organizations today are k<span class="_ _0"/>een on providing end users with a method to remotely </div><div class="t m0 x57 hd yc60 ff4 fs7 fc0 sc0 lsb ws16">access ke<span class="_ _0"/>y systems in a way that’<span class="_ _2"/>s familiar and easy<span class="_ _2"/>. Thus, many or<span class="_ _0"/>ganizations are </div><div class="t m0 x57 hd yc61 ff4 fs7 fc0 sc0 ls0 ws0">using Secure Sockets Layer (SSL) or web <span class="_ _2"/>VPN systems, web e-mail access, or some </div><div class="t m0 x57 hd yc62 ff4 fs7 fc0 sc0 ls0 ws0">other related web portal system.</div><a class="" href="https://github.com/robertdavidgraham/masscan"><div class="d m1" style="border-style:none;position:absolute;left:411.307634px;bottom:695.437642px;width:83.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="https://github.com/robertdavidgraham/masscan"><div class="d m1" style="border-style:none;position:absolute;left:92.033258px;bottom:679.715797px;width:127.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="https://github.com/zmap/zmap"><div class="d m1" style="border-style:none;position:absolute;left:160.967498px;bottom:359.232048px;width:136.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>