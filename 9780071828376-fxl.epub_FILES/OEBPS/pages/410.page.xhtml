<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf19a" class="pf w2 h2" data-page-no="19a"><div class="pc pc19a w2 h2"><div class="t m0 x6 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 10: APT Software Backdoors<span class="_ _9"> </span><span class="ff1 fs9 lsa">387</span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">that our watchdog service has been running. <span class="_ _0"/>This can be in a log le, the registry<span class="_ _2"/>, </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">or better yet, in memory<span class="_ _2"/>. Every minute or hour the watchdog service is running, </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 ls0 ws0">we make a tally<span class="_ _2"/>. Once the tally reaches a specic number<span class="_ _0"/>, we’<span class="_ _2"/>re guaranteed that </div><div class="t m0 x3 hd y210 ff4 fs7 fc0 sc0 ls0 ws0">the watchdog has been running for at least that period of time and then it is okay to </div><div class="t m0 x3 hd y211 ff4 fs7 fc0 sc0 ls0 ws0">restore the backdoor<span class="_ _2"/>.</div><div class="t m0 x4 hd y212 ff4 fs7 fc0 sc0 ls0 ws0">Once the backdoor is restored, the watchdog can alert the command-and-control </div><div class="t m0 x3 hd y398 ff4 fs7 fc0 sc0 lsb ws16">server of the reason why the backdoor had to be restored. In this case, the w<span class="_ _0"/>atchdog </div><div class="t m0 x3 hd y399 ff4 fs7 fc0 sc0 ls0 ws0">might alert us that the autostart registry entry and xfupdate.e<span class="_ _0"/>xe le had been deleted. </div><div class="t m0 x3 hd y3c6 ff4 fs7 fc0 sc0 lsb ws16">Because these actions are clearly indicati<span class="_ _0"/>ve of a technical person in<span class="_ _0"/>v<span class="_ _0"/>estigating the </div><div class="t m0 x3 hd y4b0 ff4 fs7 fc0 sc0 ls0 ws0">system, we can then respond accordingly and adjust our acti<span class="_ _0"/>vities.</div><div class="t m0 x4 hd y126 ff4 fs7 fc0 sc0 ls0 ws0">Of course, we can also choose to hav<span class="_ _0"/>e the watchdog service deplo<span class="_ _0"/>y a different </div><div class="t m0 x3 hd y978 ff4 fs7 fc0 sc0 ls0 ws0">program in a similar fashion if the original xfupdate.e<span class="_ _0"/>xe le were deleted. <span class="_ _0"/>That way<span class="_ _2"/>, </div><div class="t m0 x3 hd y979 ff4 fs7 fc0 sc0 lsb ws16">if the same in<span class="_ _0"/>v<span class="_ _0"/>estigator were to return to the system a month later<span class="_ _0"/>, he would not be </div><div class="t m0 x3 hd y39c ff4 fs7 fc0 sc0 ls0 ws0">alerted to the reappearance of the le. <span class="_ _2"/>Although at this point, it could have been the </div><div class="t m0 x3 hd y39d ff4 fs7 fc0 sc0 ls0 ws0">legitimate softw<span class="_ _0"/>are reinstalling its own updater program, which is f<span class="_ _0"/>ar more common </div><div class="t m0 x3 hd y39e ff4 fs7 fc0 sc0 ls0 ws0">and hopefully would appear innocuous.</div><div class="t m0 x3 h4 y2481 ff2 fs1 fc0 sc0 ls0 ws0">Thy Enemies’ Actions</div><div class="t m0 x3 hd y881 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e’ll want to build intelligence into our w<span class="_ _0"/>atchdog service to monitor for ke<span class="_ _0"/>y ev<span class="_ _0"/>ents </div><div class="t m0 x3 hd y2482 ff4 fs7 fc0 sc0 ls0 ws0">that are indicati<span class="_ _0"/>ve of a technical person at the ke<span class="_ _0"/>yboard or that could be indicati<span class="_ _0"/>ve of </div><div class="t m0 x3 hd y4b6 ff4 fs7 fc0 sc0 lsb ws16">someone specically in<span class="_ _0"/>v<span class="_ _0"/>estigating our backdoor<span class="_ _0"/>.</div><div class="t m0 x4 hd y4b7 ff4 fs7 fc0 sc0 ls0 ws20">Some of this monitoring will require administrati<span class="_ _0"/>ve pri<span class="_ _0"/>vileges. Examples of e<span class="_ _0"/>v<span class="_ _0"/>ents </div><div class="t m0 x3 hd y2483 ff4 fs7 fc0 sc0 ls0 ws0">to watch for include</div><div class="t m0 x16 h1f y2484 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2485 ff4 fs7 fc0 sc0 ls0 ws0">Starting of specic ex<span class="_ _0"/>ecutables:</div><div class="t m0 x1 h1f y2486 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2487 ff4 fs7 fc0 sc0 ls0 ws0">taskmgr<span class="_ _2"/>.exe (task/process manager)</div><div class="t m0 x1 h1f y2488 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2489 ff4 fs7 fc0 sc0 ls0 ws0">regedit.e<span class="_ _0"/>xe (re<span class="_ _0"/>gistry editor)</div><div class="t m0 x1 h1f y248a ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y248b ff4 fs7 fc0 sc0 ls0 ws0">regedt32.e<span class="_ _0"/>xe (re<span class="_ _0"/>gistry editor)</div><div class="t m0 x1 h1f y248c ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y248d ff4 fs7 fc0 sc0 ls0 ws0">procmon.ex<span class="_ _0"/>e and procexp.e<span class="_ _0"/>xe (process monitor and process e<span class="_ _0"/>xplorer)</div><div class="t m0 x1 h1f y248e ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y248f ff4 fs7 fc0 sc0 ls0 ws0">solarwinds</div><div class="t m0 x1 h1f y2490 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x94 hd y2491 ff4 fs7 fc0 sc0 ls0 ws0">debuggers</div><div class="t m0 x16 h1f y2492 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2493 ff4 fs7 fc0 sc0 ls0 ws0">File searches</div><div class="t m0 x16 h1f y2494 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2495 ff4 fs7 fc0 sc0 ls0 ws0">Booting to Safe mode</div><div class="t m0 x16 h1f y2496 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2497 ff4 fs7 fc0 sc0 ls0 ws0">Administrator logins</div><div class="t m0 x16 h1f y2498 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y2499 ff4 fs7 fc0 sc0 ls0 ws0">Internet searches for names of our program or related les</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>