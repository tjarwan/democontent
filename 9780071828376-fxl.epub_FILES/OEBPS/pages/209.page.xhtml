<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pfd1" class="pf w2 h2" data-page-no="d1"><div class="pc pcd1 w2 h2"><img class="bi x94 y658 w6 h2e" alt="" src="bgd1.png"/><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">186<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x4 hd y172 ff4 fs7 fc0 sc0 ls0 ws0">Next, we w<span class="_ _0"/>ant to decide what the user should experience after the<span class="_ _0"/>y hav<span class="_ _0"/>e logged in </div><div class="t m0 x3 hd y173 ff4 fs7 fc0 sc0 ls0 ws0">or attempted to log in. <span class="_ _0"/>W<span class="_ _3"/>e have four main approaches to choose from:</div><div class="t m0 x16 h1f y10ae ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y10af ff4 fs7 fc0 sc0 ls0 ws0">Redirect the user to a legitimate website</div><div class="t m0 x16 h1f y10b0 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y10b1 ff4 fs7 fc0 sc0 ls0 ws0">Redirect the user to a “static” page on our website</div><div class="t m0 x16 h1f y10b2 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y10b3 ff4 fs7 fc0 sc0 ls0 ws0">Redirect the user to a malware deplo<span class="_ _0"/>yment page</div><div class="t m0 x16 h1f y13b2 ffb fse fc0 sc0 ls0 ws0">c</div><div class="t m0 x1 hd y13b3 ff4 fs7 fc0 sc0 ls0 ws0">Act as a proxy between the user and the legitimate website</div><div class="t m0 x4 hd y13b4 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can simply record whatever credentials the user entered and redirect the user </div><div class="t m0 x3 hd y13b5 ff4 fs7 fc0 sc0 ls0 ws0">to a legitimate website (not ours). <span class="_ _0"/>W<span class="_ _3"/>e can also redirect them to another page on </div><div class="t m0 x3 hd y13b6 ff4 fs7 fc0 sc0 ls0 ws0">our website, informing the user whether the login was a failure or success. If we’<span class="_ _2"/>re </div><div class="t m0 x3 hd y13b7 ff4 fs7 fc0 sc0 ls0 ws0">copying a le<span class="_ _0"/>gitimate website, we probably want to test the credentials by attempting </div><div class="t m0 x3 hd y13b8 ff4 fs7 fc0 sc0 ls0 ws0">to log in to the legitimate website and react based on whether the<span class="_ _0"/>y appear to be v<span class="_ _0"/>alid </div><div class="t m0 x3 hd y13b9 ff4 fs7 fc0 sc0 ls0 ws0">or not. For e<span class="_ _0"/>xample, if they’<span class="_ _2"/>re in<span class="_ _0"/>v<span class="_ _0"/>alid, we obviously want to prompt the user and </div><div class="t m0 x3 hd y13ba ff4 fs7 fc0 sc0 lsc ws17">hav<span class="_ _0"/>e them log in again.</div><div class="t m0 x94 h2f y13bb ffe fs9 fc0 sc0 ls0 ws17">NOTE</div><div class="t m0 x94 h14 y13bc ff9 fs7 fc0 sc0 ls0 ws0">I believe my record for passwords entered in one of my phishing websites by a single user is </div><div class="t m0 x94 h14 y13bd ff9 fs7 fc0 sc0 ls0 ws0">currently 12; if you beat that, please let me know<span class="_ _0"/>.</div><div class="t m0 x4 hd y13be ff4 fs7 fc0 sc0 ls0 ws0">One method I’<span class="_ _2"/>ve used in the past is to only return a “failed login” message to </div><div class="t m0 x3 hd y13bf ff4 fs7 fc0 sc0 ls0 ws0">the end user<span class="_ _2"/>. This can cause the end user to attempt to log in with a fe<span class="_ _0"/>w different </div><div class="t m0 x3 hd y13c0 ff4 fs7 fc0 sc0 ls0 ws0">passwords, essentially gi<span class="_ _0"/>ving you their history of passwords and potentially a really </div><div class="t m0 x3 hd y13c1 ff4 fs7 fc0 sc0 ls0 ws0">good set of passwords to understand ho<span class="_ _0"/>w they choose their passw<span class="_ _0"/>ords.</div><div class="t m0 x4 hd y13c2 ff4 fs7 fc0 sc0 ls0 ws0">K<span class="_ _0"/>eep in mind, though, that if the user only receiv<span class="_ _0"/>es failure messages, the<span class="_ _0"/>y might </div><div class="t m0 x3 hd y13c3 ff4 fs7 fc0 sc0 ls0 ws0">become suspicious, so you could cap the failed login messages at an arbitrary </div><div class="t m0 x3 hd y13c4 ff4 fs7 fc0 sc0 ls0 ws0">number<span class="_ _2"/>. <span class="_ _2"/>Y<span class="_ _1b"/>ou could potentially combine this with a second e-mail and inform the user </div><div class="t m0 x3 hd y13c5 ff4 fs7 fc0 sc0 ls0 ws0">that there was an issue with the website that was pre<span class="_ _0"/>v<span class="_ _0"/>enting users from correctly </div><div class="t m0 x3 hd y13c6 ff4 fs7 fc0 sc0 ls0 ws0">logging in, the issue has been xed, and users can no<span class="_ _0"/>w log in without an issue.</div><div class="t m0 x4 hd y13c7 ff4 fs7 fc0 sc0 ls0 ws0">One of the simplest methods to redirect the user is to set the HTTP header using </div><div class="t m0 x3 hd y13c8 ff4 fs7 fc0 sc0 ls0 ws0">the PHP header function, as in the follo<span class="_ _0"/>wing example. If you wish to use this option, </div><div class="t m0 x3 hd y13c9 ff4 fs7 fc0 sc0 ls0 ws0">you can’t ha<span class="_ _0"/>ve sent an<span class="_ _0"/>y data (e<span class="_ _0"/>ven an empty line) as part of the HTTP response. <span class="_ _0"/>That </div><div class="t m0 x3 hd y13ca ff4 fs7 fc0 sc0 ls0 ws0">means your PHP page must not hav<span class="_ _0"/>e any space before the opening ( &lt;?php ) brack<span class="_ _0"/>et </div><div class="t m0 x3 hd y13cb ff4 fs7 fc0 sc0 ls0 ws0">and you can’t ha<span class="_ _0"/>ve printed an<span class="_ _0"/>y data before the call to the header function.</div><div class="t m0 x3 h44 y13cc fff fse fc0 sc0 ls0 ws0">&lt;?php</div><div class="t m0 x3 h44 y13cd fff fse fc0 sc0 ls0 ws0">header( 'Location: http://portal-weaktarget.com/portal.htm' ) ;</div><div class="t m0 x3 h44 y13ce fff fse fc0 sc0 ls0 ws0">?&gt;</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>