<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf18e" class="pf w2 h2" data-page-no="18e"><div class="pc pc18e w2 h2"><div class="t m0 xb h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 9: Physical Infiltration<span class="_ _9"> </span><span class="ff1 fs9 lsa">375</span></div><div class="t m0 x3 h7 y328 ff1 fs3 fc0 sc0 ls0 ws0">Hacking Full Disk Encryption</div><div class="t m0 x3 hd y329 ff4 fs7 fc0 sc0 ls0 ws0">Even in cases where a computer is protected with full disk encryption (FDE), if we </div><div class="t m0 x3 hd y32a ff4 fs7 fc0 sc0 lsb ws16">hav<span class="_ _0"/>e physical access to the de<span class="_ _0"/>vice, there are still ways to manipulate the system. </div><div class="t m0 x3 hd y32b ff4 fs7 fc0 sc0 ls0 ws0">There are two main attacks today: e<span class="_ _0"/>vil maid and cold boot attacks. If the system </div><div class="t m0 x3 hd y32c ff4 fs7 fc0 sc0 ls0 ws0">is a desktop system and we can hide the ke<span class="_ _0"/>ylogger<span class="_ _0"/>, then we can use a traditional </div><div class="t m0 x3 hd y32d ff4 fs7 fc0 sc0 ls0 ws0">hardware ke<span class="_ _0"/>ylogger to obtain the FDE password as well.</div><div class="t m0 x4 hd y32e ff4 fs7 fc0 sc0 ls0 ws0">The e<span class="_ _0"/>vil maid attack gets its name from a scenario in which a maid of ill repute </div><div class="t m0 x3 hd y32f ff4 fs7 fc0 sc0 ls0 ws0">obtains access to a system with an encrypted hard dri<span class="_ _0"/>ve and installs a malicious </div><div class="t m0 x3 hd y330 ff4 fs7 fc0 sc0 ls0 ws0">bootloader to log the password when it is entered le<span class="_ _0"/>gitimately by the user<span class="_ _0"/>. In 2009, a </div><div class="t m0 x3 hd y331 ff4 fs7 fc0 sc0 ls0 ws0">proof-of-concept implementation of the e<span class="_ _0"/>vil maid attack was released by the group </div><div class="t m0 x3 hd y332 ff4 fs7 fc0 sc0 lsb ws16">The In<span class="_ _0"/>visible <span class="_ _0"/>Things Lab that works against <span class="_ _0"/>T<span class="_ _0"/>ruecrypt, a free and open-source FD<span class="_ _0"/>A </div><div class="t m0 x3 hd y333 ff4 fs7 fc0 sc0 ls0 ws16">package.</div><div class="t m0 x4 hd y364 ff4 fs7 fc0 sc0 ls0 ws0">T<span class="_ _3"/>o execute the attack, do<span class="_ _0"/>wnload the e<span class="_ _0"/>vil maid liv<span class="_ _0"/>e boot image from the </div><div class="t m0 x3 hd y365 ff4 fs7 fc0 sc0 ls0 ws0">In<span class="_ _0"/>visible <span class="_ _0"/>Things Lab website at http://in<span class="_ _0"/>visiblethingslab<span class="_ _0"/>.com/resources/e<span class="_ _0"/>vilmaid/</div><div class="t m0 x3 hd y366 ff4 fs7 fc0 sc0 ls0 ws0">e<span class="_ _0"/>vilmaidusb-1.01.img.</div><div class="t m0 x4 hd y146e ff4 fs7 fc0 sc0 ls0 ws0">At the time of writing, the current version w<span class="_ _0"/>as 1.01. Copy the disk image to a </div><div class="t m0 x3 h3f y1d1b ff4 fs7 fc0 sc0 ls0 ws0">USB dri<span class="_ _0"/>ve using the Linux <span class="fff">dd</span> command, as in the follo<span class="_ _0"/>wing example. Note that we </div><div class="t m0 x3 hd y22d2 ff4 fs7 fc0 sc0 ls0 ws0">don’t specify a partition on the USB dri<span class="_ _0"/>v<span class="_ _0"/>e.</div><div class="t m0 x3 h44 y235e fff fse fc0 sc0 ls0 ws0">root@kali:~# dd if=evilmaidusb-1.01.img of=/dev/sdb</div><div class="t m0 x3 h44 y235f fff fse fc0 sc0 ls0 ws0">23064+0 records in</div><div class="t m0 x3 h44 y2360 fff fse fc0 sc0 ls0 ws0">23064+0 records out</div><div class="t m0 x3 h44 y2361 fff fse fc0 sc0 ls0 ws0">11808768 bytes (12 MB) copied, 6.89372 s, 1.7 MB/s</div><div class="t m0 x3 h44 y2362 fff fse fc0 sc0 ls0 ws0">root@kali:~#</div><div class="t m0 x4 hd y2363 ff4 fs7 fc0 sc0 ls0 ws0">Next, boot to the USB dri<span class="_ _0"/>v<span class="_ _0"/>e. Once the image has nished booting, you’ll ha<span class="_ _0"/>ve a </div><div class="t m0 x3 h2c y2364 ff4 fs7 fc0 sc0 ls0 ws0">simple prompt. T<span class="_ _3"/>ype <span class="ff3">e</span> to ex<span class="_ _0"/>ecute the evil maid attack and press . <span class="_ _0"/>The system </div><div class="t m0 x3 hd y2365 ff4 fs7 fc0 sc0 ls0 ws0">will then attempt to identify and hook the T<span class="_ _2"/>ruecrypt bootloader, after which you can </div><div class="t m0 x3 hd y2366 ff4 fs7 fc0 sc0 ls0 ws0">simply reboot the computer<span class="_ _2"/>.</div><div class="t m0 x4 hd y2367 ff4 fs7 fc0 sc0 ls0 ws0">After the user has entered the password and booted the system, you’ll need to </div><div class="t m0 x3 hd y2368 ff4 fs7 fc0 sc0 ls0 ws0">return and boot to the same li<span class="_ _0"/>ve USB dri<span class="_ _0"/>ve. <span class="_ _1b"/>Y<span class="_ _3"/>ou’ll go through the same process and </div><div class="t m0 x3 h2c y2369 ff4 fs7 fc0 sc0 ls0 ws0">type <span class="ff3">e</span> after the image has nished booting. The e<span class="_ _0"/>vil maid program will detect that </div><div class="t m0 x3 hd y236a ff4 fs7 fc0 sc0 ls0 ws0">the system is already patched and display the password obtained from the user<span class="_ _2"/>. Note </div><div class="t m0 x3 hd y236b ff4 fs7 fc0 sc0 ls0 ws0">that the password is output with the rest of the output from the e<span class="_ _0"/>vil maid program, so </div><div class="t m0 x3 hd y236c ff4 fs7 fc0 sc0 ls0 ws0">don’t o<span class="_ _0"/>verlook it.</div><div class="t m0 x4 hd y236d ff4 fs7 fc0 sc0 ls0 ws0">The cold boot attack works because computers with FDE will need access to </div><div class="t m0 x3 hd y236e ff4 fs7 fc0 sc0 ls0 ws0">decrypt les on the y<span class="_ _2"/>, the decryption key must be stored in memory<span class="_ _3"/>. Most common </div><div class="t m0 x3 hd y236f ff4 fs7 fc0 sc0 ls0 ws0">RAM chips don’t immediately securely zero out the contents of memory when a </div><div class="t m0 x3 hd y2370 ff4 fs7 fc0 sc0 ls0 ws0">system is shut do<span class="_ _0"/>wn. The data can actually remain in memory for seconds or e<span class="_ _0"/>ven </div><div class="t m0 x3 hd y2371 ff4 fs7 fc0 sc0 ls0 ws0">minutes.</div><a class="" href="http://invisiblethingslab.com/resources/evilmaid/evilmaidusb-1.01.img"><div class="d m1" style="border-style:none;position:absolute;left:264.973545px;bottom:481.378685px;width:214.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://invisiblethingslab.com/resources/evilmaid/evilmaidusb-1.01.img"><div class="d m1" style="border-style:none;position:absolute;left:94.452003px;bottom:465.656841px;width:99.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>