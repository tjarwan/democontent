<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf8b" class="pf w2 h2" data-page-no="8b"><div class="pc pc8b w2 h2"><div class="t m0 xac h10 y83 ff1 fs9 fc0 sc0 lsa ws0">116<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x6f hd y11c ff4 fs7 fc0 sc0 ls0 ws0">It is important to correlate port scan information with the DNS records we’<span class="_ _2"/>ve </div><div class="t m0 x6e hd y11d ff4 fs7 fc0 sc0 ls0 ws0">identied to enumerate any unique virtual hosts.</div><div class="t m0 x6f hd y11e ff4 fs7 fc0 sc0 ls0 ws0">If we identify multiple DNS entries for a single IP address, we can simply bro<span class="_ _0"/>wse </div><div class="t m0 x6e hd y11f ff4 fs7 fc0 sc0 ls0 ws0">to those URLs in a web bro<span class="_ _0"/>wser and see if the sites appear to be different. If the sites </div><div class="t m0 x6e h3f y232 ff4 fs7 fc0 sc0 ls0 ws0">appear to be similar<span class="_ _0"/>, we can mirror them using <span class="fff">wget</span> and then look for dif<span class="_ _0"/>ferences </div><div class="t m0 x6e h3f y233 ff4 fs7 fc0 sc0 ls0 ws0">with the <span class="fff">diff</span> command. </div><div class="t m0 x6f hd y234 ff4 fs7 fc0 sc0 ls0 ws0">Y<span class="_ _1b"/>ou should also try all of the hostnames on all the web server ports identied. </div><div class="t m0 x6e hd yd0a ff4 fs7 fc0 sc0 ls0 ws0">For e<span class="_ _0"/>xample, if we identied a DNS record for a specic host and identied a web </div><div class="t m0 x6e hd yd0b ff4 fs7 fc0 sc0 ls0 ws0">server listening on port 5555 at that IP address, we should attempt to access the DNS </div><div class="t m0 x6e hd y95a ff4 fs7 fc0 sc0 ls0 ws0">name on port 5555 to identify a possible virtual host record associated with the IP </div><div class="t m0 x6e hd yd0c ff4 fs7 fc0 sc0 ls0 ws0">addresses on that port, for example:</div><div class="t m0 xad hd yd0d ff4 fs7 fc0 sc0 ls0 ws0">http://admin.weak-target.com:5555</div><div class="t m0 x6f hd yd0e ff4 fs7 fc0 sc0 ls0 ws0">If you visit a web server that is congured with <span class="_ _2"/>V<span class="_ _2"/>irtual Hosts by using the IP </div><div class="t m0 x6e hd yd0f ff4 fs7 fc0 sc0 ls0 ws0">address of the server<span class="_ _2"/>, you might be redirected to a “default” website, be shown a </div><div class="t m0 x6e hd yd10 ff4 fs7 fc0 sc0 ls0 ws0">default or generic website, or recei<span class="_ _0"/>ve an error message such as “Site <span class="_ _0"/>T<span class="_ _2"/>emporarily </div><div class="t m0 x6e hd yd11 ff4 fs7 fc0 sc0 ls0 ws0">Unav<span class="_ _0"/>ailable.<span class="_ _3"/>” </div><div class="t m0 x6f hd yd12 ff4 fs7 fc0 sc0 ls0 ws0">If you’<span class="_ _2"/>d prefer a more automated approach, you can try the hostmap tool from </div><div class="t m0 x6e hd yd13 ff4 fs7 fc0 sc0 ls0 ws0">https://github<span class="_ _0"/>.com/jekil/hostmap. Unfortunately<span class="_ _2"/>, it isn’t al<span class="_ _0"/>ways possible to identify </div><div class="t m0 x6e hd yd14 ff4 fs7 fc0 sc0 ls0 ws0">all of the virtual hosts associated with a gi<span class="_ _0"/>ven IP address. <span class="_ _0"/>The majority of the time, </div><div class="t m0 x6e hd yd15 ff4 fs7 fc0 sc0 ls0 ws0">ho<span class="_ _0"/>wev<span class="_ _0"/>er<span class="_ _0"/>, you’ll most lik<span class="_ _0"/>ely correctly identify the type of system and purpose without </div><div class="t m0 x6e hd yd16 ff4 fs7 fc0 sc0 ls0 ws0">having to deal with <span class="_ _2"/>V<span class="_ _2"/>irtual Hosts.</div><div class="t m0 x6e h7 yd17 ff1 fs3 fc0 sc0 ls0 ws0">Robot W<span class="_ _0"/>eb Data</div><div class="t m0 x6e hd yd18 ff4 fs7 fc0 sc0 ls0 ws0">Another great source of data from web servers can be obtained by analyzing the </div><div class="t m0 x6e hd yd19 ff4 fs7 fc0 sc0 ls0 ws0">robots.txt le. The purpose of the robots.txt le is to instruct web cra<span class="_ _0"/>wling agents, </div><div class="t m0 x6e hd yd1a ff4 fs7 fc0 sc0 ls0 ws0">like those used by search engines, which directories and les to a<span class="_ _0"/>void. </div><div class="t m0 x6f hd yd1b ff4 fs7 fc0 sc0 ls0 ws0">The robots.txt le is located in the root web directory<span class="_ _2"/>. <span class="_ _3"/>Y<span class="_ _3"/>ou can simply browse to </div><div class="t m0 x6e hd yd1c ff4 fs7 fc0 sc0 ls0 ws0">the target website for a robots.txt—for e<span class="_ _0"/>xample, http://www<span class="_ _2"/>.weaktarget.com/robots</div><div class="t m0 x6e hd yd1d ff4 fs7 fc0 sc0 ls0 ws0">.txt. The robots.txt le is not required, so you may simply recei<span class="_ _0"/>v<span class="_ _0"/>e a 404 not found </div><div class="t m0 x6e hd yd1e ff4 fs7 fc0 sc0 ls0 ws0">error in some cases.</div><div class="t m0 x6f hd yd1f ff4 fs7 fc0 sc0 ls0 ws0">The le is constructed of a series of disallo<span class="_ _0"/>w statements that list specic les, or </div><div class="t m0 x6e hd yd20 ff4 fs7 fc0 sc0 ls0 ws0">e<span class="_ _0"/>ven entire directories, that the web administrator doesn’<span class="_ _0"/>t want search engines to </div><div class="t m0 x6e hd yd21 ff4 fs7 fc0 sc0 ls0 ws0">spider<span class="_ _2"/>. <span class="_ _0"/>An example robots.txt le is sho<span class="_ _0"/>wn here:</div><div class="t m0 x6e h44 yd22 fff fse fc0 sc0 ls0 ws0">User-agent: *</div><div class="t m0 x6e h44 yd23 fff fse fc0 sc0 ls0 ws0">Disallow: /admin/</div><div class="t m0 x6e h44 yd24 fff fse fc0 sc0 ls0 ws0">Disallow:/search.php</div><div class="t m0 x6e h44 yd25 fff fse fc0 sc0 ls0 ws0">Disallow:/2014/test/</div><div class="t m0 x6f hd yd26 ff4 fs7 fc0 sc0 ls0 ws0">In this case, we’<span class="_ _2"/>d want to manually browse the /admin/ directory as well as </div><div class="t m0 x6e hd yd27 ff4 fs7 fc0 sc0 ls0 ws0">the /2014/test/ directory<span class="_ _2"/>. The search.php le may also be an interesting tar<span class="_ _0"/>get to </div><a class="" href="http://www.weaktarget.com/robots.txt"><div class="d m1" style="border-style:none;position:absolute;left:344.792139px;bottom:247.969766px;width:153.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://www.weaktarget.com/robots.txt"><div class="d m1" style="border-style:none;position:absolute;left:85.986395px;bottom:232.247921px;width:17.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="https://github.com/jekil/hostmap"><div class="d m1" style="border-style:none;position:absolute;left:85.986395px;bottom:414.863190px;width:146.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>