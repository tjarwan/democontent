<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf87" class="pf w2 h2" data-page-no="87"><div class="pc pc87 w2 h2"><div class="t m0 xa8 h10 y83 ff1 fs9 fc0 sc0 lsa ws0">112<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x24 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">service on a nonstandard port. Note that there are two spaces between “open” and </div><div class="t m0 x24 h3f y11d ff4 fs7 fc0 sc0 ls0 ws0">“http” in the <span class="fff">grep</span> statement.</div><div class="t m0 x24 h44 yc84 fff fse fc0 sc0 ls0 ws0">user@kali:# grep "open  http" nmap.nmap</div><div class="t m0 x24 h44 yc85 fff fse fc0 sc0 ls0 ws0">999/tcp open  http    Apache httpd 2.2.22 ((Debian))</div><div class="t m0 x24 h44 yc86 fff fse fc0 sc0 ls0 ws0">user@kali:#</div><div class="t m0 x25 hd yc87 ff4 fs7 fc0 sc0 ls0 ws0">In this case, the scan was performed with the -A option, which performs service </div><div class="t m0 x24 hd yc88 ff4 fs7 fc0 sc0 ls0 ws0">identication and version enumeration, among other things. If you w<span class="_ _0"/>anted to just </div><div class="t m0 x24 hd yc89 ff4 fs7 fc0 sc0 ls0 ws0">perform service versioning and identication, you could call nmap with the -sV </div><div class="t m0 x24 hd yc8a ff4 fs7 fc0 sc0 ls0 ws0">option. If we didn’t use either of these options, we w<span class="_ _0"/>ould simply see the default </div><div class="t m0 x24 hd yc8b ff4 fs7 fc0 sc0 lsb ws16">service name associated with TCP port 999, “garcon,<span class="_ _3"/>” which is much less useful </div><div class="t m0 x24 hd yc8c ff4 fs7 fc0 sc0 ls0 ws0">for us.</div><div class="t m0 x24 h7 yc8d ff1 fs3 fc0 sc0 ls0 ws0">W<span class="_ _0"/>eb Service Exploration</div><div class="t m0 x24 hd yc8e ff4 fs7 fc0 sc0 ls0 ws0">Using the web systems identied via port scanning and the DNS hostnames from </div><div class="t m0 x24 hd yc8f ff4 fs7 fc0 sc0 ls0 ws0">tools like dnsrecon and theharv<span class="_ _0"/>ester<span class="_ _0"/>, we can mov<span class="_ _0"/>e on to identifying exactly what </div><div class="t m0 x24 hd yc90 ff4 fs7 fc0 sc0 ls0 ws0">is being of<span class="_ _0"/>fered by these web systems. Identifying and analyzing all of the web </div><div class="t m0 x24 hd yc91 ff4 fs7 fc0 sc0 lsb ws16">systems in a target or<span class="_ _0"/>ganization can be a some<span class="_ _0"/>what daunting task, especially for very </div><div class="t m0 x24 hd yc92 ff4 fs7 fc0 sc0 lsb ws16">large or<span class="_ _0"/>ganizations. Simply bro<span class="_ _0"/>wsing the identied web systems can take a serious </div><div class="t m0 x24 hd yc93 ff4 fs7 fc0 sc0 ls0 ws0">amount of time, so we need a good way to automate this task.</div><div class="t m0 x25 hd yc94 ff4 fs7 fc0 sc0 ls0 ws0">The method I prefer is to capture screenshots of the target web systems so that </div><div class="t m0 x24 hd yc95 ff4 fs7 fc0 sc0 ls0 ws0">I can quickly analyze them and determine which systems can be used for our next </div><div class="t m0 x24 hd yc96 ff4 fs7 fc0 sc0 ls0 ws0">phase of attack. <span class="_ _0"/>W<span class="_ _3"/>e have a fe<span class="_ _0"/>w web screenshot tools a<span class="_ _0"/>vailable for us. I prefer using </div><div class="t m0 x24 hd yc97 ff4 fs7 fc0 sc0 ls0 ws0">my o<span class="_ _0"/>wn Perl script webshot.pl dev<span class="_ _0"/>eloped for this task.</div><div class="t m0 x25 hd yc98 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>ebshot’<span class="_ _0"/>s primary function is to launch each URL from an input le in a bro<span class="_ _0"/>wser </div><div class="t m0 x24 hd yc99 ff4 fs7 fc0 sc0 ls0 ws0">and then take a screenshot of the loaded website. <span class="_ _0"/>There is also valuable information </div><div class="t m0 x24 hd yc9a ff4 fs7 fc0 sc0 ls0 ws0">in the HTTP headers and SSL certicates returned by a target system, so webshot </div><div class="t m0 x24 hd yc9b ff4 fs7 fc0 sc0 ls0 ws0">returns this information as well.</div><div class="t m0 x25 hd yc9c ff4 fs7 fc0 sc0 ls0 ws0">The process taken by the webshot tool is as follo<span class="_ _0"/>ws:</div><div class="t m0 x38 hd yc9d ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _3e"> </span><span class="ff4 fs7">Connect to the target web system using a Perl library to obtain HTTP headers </span></div><div class="t m0 x85 hd yc9e ff4 fs7 fc0 sc0 ls0 ws0">and SSL certicate information.</div><div class="t m0 x38 hd yc9f ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _3e"> </span><span class="ff4 fs7 ws20">If there were no connection issues, open the target URL in the Chrome bro<span class="_ _0"/>wser<span class="_ _2"/>.</span></div><div class="t m0 x38 hd yca0 ff3 fs2 fc0 sc0 ls0 ws20">3.<span class="_ _3e"> </span><span class="ff4 fs7 ws0">If the site requires HTTPS and has a self-signed certicate, webshot accepts </span></div><div class="t m0 x85 hd yca1 ff4 fs7 fc0 sc0 ls0 ws0">any certicate w<span class="_ _0"/>arnings by sending the appropriate keys to the bro<span class="_ _0"/>wser<span class="_ _2"/>.</div><div class="t m0 x38 hd yca2 ff3 fs2 fc0 sc0 ls0 ws0">4.<span class="_ _3e"> </span><span class="ff4 fs7">T<span class="_ _3"/>ake a screenshot of the target site in Chrome bro<span class="_ _0"/>wser<span class="_ _2"/>.</span></div><div class="t m0 x38 hd yca3 ff3 fs2 fc0 sc0 ls0 ws0">5.<span class="_ _3e"> </span><span class="ff4 fs7">At the end, it creates an HTML report with all of the images, SSL, and header </span></div><div class="t m0 x85 hd yca4 ff4 fs7 fc0 sc0 ls0 ws0">information:</div><div class="t m0 x85 h44 yca5 fff fse fc0 sc0 ls0 ws0">webshot.pl -i in.txt -t "Weak Target External Sites"</div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>