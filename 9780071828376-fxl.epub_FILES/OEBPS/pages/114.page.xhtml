<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf72" class="pf w2 h2" data-page-no="72"><div class="pc pc72 w2 h2"><div class="t m0 x93 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 4: An APT Approach to Reconnaissance <span class="_ _3f"> </span><span class="ff1 fs9 lsa">91</span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 ls0 ws0">LinkedIn, google-proles, people123, and jigsa<span class="_ _0"/>w<span class="_ _2"/>. Follo<span class="_ _0"/>wing is a short example of </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 lsb ws16">using theharvester against our tar<span class="_ _0"/>get domain weak-target.com by scraping the Bing </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 ls0 ws0">search engine:</div><div class="t m0 x3 h44 ya39 fff fse fc0 sc0 ls0 ws0">user@kali:~$ theharvester -d weak-target.com -b bing</div><div class="t m0 x3 h44 ya3a fff fse fc0 sc0 ls0 ws0">--- SNIP ---</div><div class="t m0 x3 h44 ya3b fff fse fc0 sc0 ls0 ws0">[-] Searching in Bing:</div><div class="t m0 x3 h44 ya3c fff fse fc0 sc0 ls0 ws0">      Searching 50 results...</div><div class="t m0 x3 h44 ya3d fff fse fc0 sc0 ls0 ws0">      Searching 100 results...</div><div class="t m0 x3 h44 ya3e fff fse fc0 sc0 ls0 ws0">[+] Hosts found in search engines:</div><div class="t m0 x3 h44 ya3f fff fse fc0 sc0 ls0 ws0">------------------------------------</div><div class="t m0 x3 h44 ya40 fff fse fc0 sc0 ls0 ws0">65.52.103.78:www2.weak-target.com</div><div class="t m0 x3 h44 ya41 fff fse fc0 sc0 ls0 ws0">65.52.103.78:media.weak-target.com</div><div class="t m0 x3 h44 ya42 fff fse fc0 sc0 ls0 ws0">user@kali:~$</div><div class="t m0 x3 h4 ya43 ff2 fs1 fc0 sc0 ls0 ws0">DNS Zones</div><div class="t m0 x3 hd ya44 ff4 fs7 fc0 sc0 lsb ws16">Y<span class="_ _1b"/>ou should also note that organizations can (and many times do) ha<span class="_ _0"/>ve dif<span class="_ _0"/>ferent DNS </div><div class="t m0 x3 hd ya45 ff4 fs7 fc0 sc0 ls0 ws0">zones and servers for internal and e<span class="_ _0"/>xternal use for the same domain. This means that </div><div class="t m0 x3 hd ya46 ff4 fs7 fc0 sc0 lsb ws16">our target or<span class="_ _0"/>ganization could ha<span class="_ _0"/>ve multiple serv<span class="_ _0"/>ers that claim to handle “secure-</div><div class="t m0 x3 hd ya47 ff4 fs7 fc0 sc0 lsb ws16">target.net” that return dif<span class="_ _0"/>ferent results. <span class="_ _0"/>T<span class="_ _3"/>ypically<span class="_ _0"/>, this will be because an or<span class="_ _0"/>ganization </div><div class="t m0 x3 hd ya48 ff4 fs7 fc0 sc0 ls0 ws0">chooses to use the same domain name on their internal network as the<span class="_ _0"/>y do for their </div><div class="t m0 x3 hd ya49 ff4 fs7 fc0 sc0 ls0 ws0">public systems. </div><div class="t m0 x4 hd ya4a ff4 fs7 fc0 sc0 lsb ws16">Other times, organizations will ha<span class="_ _0"/>ve a separate and distinct domain name for their </div><div class="t m0 x3 hd ya4b ff4 fs7 fc0 sc0 ls0 ws0">internal systems. In this example, our tar<span class="_ _0"/>get may choose to use secure-target</div><div class="t m0 x3 hd ya4c ff4 fs7 fc0 sc0 lsb ws16">.loc or stnet.net. It’<span class="_ _2"/>s important to keep in mind that an organization is free to use </div><div class="t m0 x3 hd ya4d ff4 fs7 fc0 sc0 ls0 ws0">any domain the<span class="_ _0"/>y choose on a local network, e<span class="_ _0"/>ven something that may be in use by </div><div class="t m0 x3 hd ya4e ff4 fs7 fc0 sc0 ls0 ws0">someone else on the Internet.</div><div class="t m0 x4 hd ya4f ff4 fs7 fc0 sc0 ls0 ws0">On multiple occasions, I’<span class="_ _2"/>ve identied third-party vendors of my tar<span class="_ _0"/>get </div><div class="t m0 x3 hd ya50 ff4 fs7 fc0 sc0 lsb ws16">organization because of DNS records. F<span class="_ _0"/>or example, let’<span class="_ _2"/>s say our target or<span class="_ _0"/>ganization </div><div class="t m0 x3 hd ya51 ff4 fs7 fc0 sc0 ls0 ws0">has a DNS record of calendar<span class="_ _2"/>.weak-target.com that resolves to a dif<span class="_ _0"/>ferent subnet </div><div class="t m0 x3 hd ya52 ff4 fs7 fc0 sc0 ls0 ws0">than their other resources. <span class="_ _0"/>When we resolve or visit the IP address, we see that it </div><div class="t m0 x3 hd ya53 ff4 fs7 fc0 sc0 ls0 ws0">belongs to a third-party vendor that specializes in hosted collaboration softw<span class="_ _0"/>are.</div><div class="t m0 x3 h7 ya54 ff1 fs3 fc0 sc0 ls0 ws0">DNS Cache Snooping</div><div class="t m0 x3 hd ya55 ff4 fs7 fc0 sc0 ls0 ws0">Another vulnerability that can be used to our adv<span class="_ _0"/>antage is DNS cache snooping. </div><div class="t m0 x3 hd ya56 ff4 fs7 fc0 sc0 ls0 ws0">Cache snooping allo<span class="_ _0"/>ws us to enumerate websites and systems that users or systems </div><div class="t m0 x3 hd ya57 ff4 fs7 fc0 sc0 lsb ws16">hav<span class="_ _0"/>e requested at our target or<span class="_ _0"/>ganization.</div><a class="" href="http://weak-target.com"><div class="d m1" style="border-style:none;position:absolute;left:332.698413px;bottom:679.715797px;width:74.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://weak-target.com"><div class="d m1" style="border-style:none;position:absolute;left:254.089191px;bottom:215.316704px;width:73.000000px;height:13.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>