<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pffb" class="pf w2 h2" data-page-no="fb"><div class="pc pcfb w2 h2"><div class="t m0 xbe h10 y83 ff1 fs9 fc0 sc0 lsa ws0">228<span class="_ _d"> </span><span class="ff2 fs2 ls8">Advanced Persistent Threat Hacking<span class="_ _1e"/> </span></div><div class="t m0 x3 hd y11c ff4 fs7 fc0 sc0 lsb ws16">associated with the target or<span class="_ _0"/>ganization. If we observe a client probe for <span class="_ _0"/>W<span class="_ _3"/>eakNet </div><div class="t m0 x3 hd y11d ff4 fs7 fc0 sc0 ls0 ws0">but it is connected to another netw<span class="_ _0"/>ork with an SSID of “Linksys,<span class="_ _2"/>” we’ll want to </div><div class="t m0 x3 hd y20f ff4 fs7 fc0 sc0 lsb ws16">explore that Linksys netw<span class="_ _0"/>ork further<span class="_ _0"/>, as in the follo<span class="_ _0"/>wing output. <span class="_ _2"/>Again, even if </div><div class="t m0 x3 hd y210 ff4 fs7 fc0 sc0 ls0 ws0">it isn’t a sanctioned access point, it could still pro<span class="_ _0"/>ve to be connected to the tar<span class="_ _0"/>get </div><div class="t m0 x3 hd y211 ff4 fs7 fc0 sc0 lsc ws17">organization’<span class="_ _2"/>s internal network.</div><div class="t m0 x3 h40 y17cc fff fs5 fc0 sc0 ls0 ws0">BSSID              PWR RXQ  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH </div><div class="t m0 x3 h40 y17cd fff fs5 fc0 sc0 ls0 ws0">ESSID</div><div class="t m0 x3 h40 y17ce fff fs5 fc0 sc0 ls0 ws0">02:24:0A:99:AD:38   -9  45      488        2    0   1  54e. WPA2 CCMP   PSK</div><div class="t m0 x3 h40 y17cf fff fs5 fc0 sc0 ls0 ws0">Linksys</div><div class="t m0 x3 h40 y17d0 fff fs5 fc0 sc0 ls0 ws0">BSSID              STATION            PWR   Rate    Lost  Packets  Probes</div><div class="t m0 x3 h40 y17d1 fff fs5 fc0 sc0 ls0 ws0">02:24:0A:99:AD:38   00:22:FB:0E:3D:12  -27    0 - 1    170       26  Linksys, </div><div class="t m0 x3 h40 y17d2 fff fs5 fc0 sc0 ls0 ws0">WeakNet, WeakNet-Corporate</div><div class="t m0 x4 hd y17d3 ff4 fs7 fc0 sc0 ls0 ws0">The probed networks could also indicate the o<span class="_ _0"/>wner of the client de<span class="_ _0"/>vice. If we see </div><div class="t m0 x3 hd y17d4 ff4 fs7 fc0 sc0 ls0 ws0">a probe for <span class="_ _3"/>YURICH_HOME and we had identied an employee named T<span class="_ _3"/>om <span class="_ _3"/>Y<span class="_ _3"/>urich, </div><div class="t m0 x3 hd y17d5 ff4 fs7 fc0 sc0 ls0 ws0">this might be a strong indication of the o<span class="_ _0"/>wner<span class="_ _0"/>. <span class="_ _2"/>As always, k<span class="_ _0"/>eep your mind open </div><div class="t m0 x3 hd y17d6 ff4 fs7 fc0 sc0 ls0 ws0">and re<span class="_ _0"/>view the data without being restricted by preconcei<span class="_ _0"/>v<span class="_ _0"/>ed ideas of what you’<span class="_ _0"/>re </div><div class="t m0 x3 hd y17d7 ff4 fs7 fc0 sc0 ls0 ws0">looking for<span class="_ _2"/>.</div><div class="t m0 x4 hd y17d8 ff4 fs7 fc0 sc0 ls0 ws0">K<span class="_ _0"/>eep in mind that some client devices may not probe for other congured </div><div class="t m0 x3 hd y17d9 ff4 fs7 fc0 sc0 ls0 ws0">networks while connected to a network. <span class="_ _0"/>T<span class="_ _3"/>o force the clients to probe for other </div><div class="t m0 x3 hd y17da ff4 fs7 fc0 sc0 ls0 ws0">networks, you could spoof disassociation messages to kick them of<span class="_ _0"/>f their current </div><div class="t m0 x3 hd y17db ff4 fs7 fc0 sc0 ls0 ws0">wireless network. <span class="_ _0"/>W<span class="_ _3"/>e’ll go ov<span class="_ _0"/>er examples of ho<span class="_ _0"/>w to spoof these management </div><div class="t m0 x3 hd y17dc ff4 fs7 fc0 sc0 ls0 ws0">messages in the next section.</div><div class="t m0 x4 hd y17dd ff4 fs7 fc0 sc0 ls0 ws0">If we’<span class="_ _2"/>re lucky<span class="_ _2"/>, we’ll nd some obvious networks of interest—for e<span class="_ _0"/>xample, the </div><div class="t m0 x3 hd y17de ff4 fs7 fc0 sc0 lsb ws16">SSID might include part of the target or<span class="_ _0"/>ganization’<span class="_ _2"/>s name. The trickiest part in </div><div class="t m0 x3 hd y17df ff4 fs7 fc0 sc0 lsb ws16">re<span class="_ _0"/>viewing the data is to not shoot ourselv<span class="_ _0"/>es in the foot by ignoring a false ne<span class="_ _0"/>gativ<span class="_ _0"/>e—</div><div class="t m0 x3 hd y17e0 ff4 fs7 fc0 sc0 lsb ws16">that is, a network that we assume is not associated with the tar<span class="_ _0"/>get organization b<span class="_ _0"/>ut </div><div class="t m0 x3 hd y17e1 ff4 fs7 fc0 sc0 ls0 ws0">that in reality is an access point of interest.</div><div class="t m0 x4 hd y17e2 ff4 fs7 fc0 sc0 ls0 ws0">If we’<span class="_ _2"/>ve positiv<span class="_ _0"/>ely identied a target netw<span class="_ _0"/>ork, we’ll want to look up the OUI of </div><div class="t m0 x3 hd y17e3 ff4 fs7 fc0 sc0 ls0 ws0">the BSSID. The OUI of a MA<span class="_ _2"/>C address is the rst six hexadecimal digits, which are </div><div class="t m0 x3 hd y17e4 ff4 fs7 fc0 sc0 ls0 ws0">uniquely assigned to e<span class="_ _0"/>very manufacturer of netw<span class="_ _0"/>ork equipment. This information </div><div class="t m0 x3 hd y17e5 ff4 fs7 fc0 sc0 ls0 ws0">can be surprisingly useful. <span class="_ _3"/>Y<span class="_ _3"/>ou can look it up at www<span class="_ _2"/>.wireshark.org/tools/oui-</div><div class="t m0 x3 hd y17e6 ff4 fs7 fc0 sc0 ls0 ws0">lookup.html. By collecting this information, we might get a better idea of the </div><div class="t m0 x3 hd y17e7 ff4 fs7 fc0 sc0 lsb ws16">wireless network systems in use at the tar<span class="_ _0"/>get organization. </div><div class="t m0 x4 hd y17e8 ff4 fs7 fc0 sc0 ls0 ws0">If you identied any netw<span class="_ _0"/>orks that were cloaked, we’ll w<span class="_ _0"/>ant to go back and </div><div class="t m0 x3 hd y17e9 ff4 fs7 fc0 sc0 ls0 ws0">attempt to enumerate the SSID as part of the second phase. </div><div class="t m0 x4 hd y17ea ff4 fs7 fc0 sc0 ls0 ws0">If we can’t positi<span class="_ _0"/>v<span class="_ _0"/>ely conrm that a wireless network is not associated with a </div><div class="t m0 x3 hd y17eb ff4 fs7 fc0 sc0 lsb ws16">target or<span class="_ _0"/>ganization, then we’ll ha<span class="_ _0"/>ve to include it in our list of netw<span class="_ _0"/>orks to follow </div><a class="" href="http://www.wireshark.org/tools/oui-lookup.html"><div class="d m1" style="border-style:none;position:absolute;left:350.839002px;bottom:176.616780px;width:131.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a><a class="" href="http://www.wireshark.org/tools/oui-lookup.html"><div class="d m1" style="border-style:none;position:absolute;left:94.452003px;bottom:160.894936px;width:56.000000px;height:12.000000px;background-color:rgba(255,255,255,0.000001);"/></a></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>