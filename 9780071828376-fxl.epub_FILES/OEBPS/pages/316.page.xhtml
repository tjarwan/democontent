<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title/><link rel="stylesheet" href="../css/base.min.css"/><link rel="stylesheet" href="../css/fancy.min.css"/><link rel="stylesheet" href="../css/pdf.css"/><meta name="viewport" content="width=640, height=824"/></head><body><div id="page_body"><div id="pf13c" class="pf w2 h2" data-page-no="13c"><div class="pc pc13c w2 h2"><img class="bi xaf y1dd7 w4 h61" alt="" src="bg13c.png"/><div class="t m0 x2 h10 y83 ff2 fs2 fc0 sc0 ls8 ws0">Chapter 8: Spear Phishing with Hardware T<span class="_ _0"/>rojans<span class="_ _9"> </span><span class="ff1 fs9 lsa">293</span></div><div class="t m0 x3 h40 ya7f fff fs5 fc0 sc0 ls0 ws0">void loop(void){</div><div class="t m0 x3 h40 y18f7 fff fs5 fc0 sc0 ls0 ws0">  digitalWrite(led, HIGH);</div><div class="t m0 x3 h40 y1dd8 fff fs5 fc0 sc0 ls0 ws0">  delay(100);</div><div class="t m0 x3 h40 y1dd9 fff fs5 fc0 sc0 ls0 ws0">  digitalWrite(led, LOW);</div><div class="t m0 x3 h40 y1dda fff fs5 fc0 sc0 ls0 ws0">  delay(100);</div><div class="t m0 x3 h40 y1ddb fff fs5 fc0 sc0 ls0 ws0">}</div><div class="t m0 x4 hd y1ddc ff4 fs7 fc0 sc0 ls0 ws0">All of the actions happen in less than ten seconds, although that also depends </div><div class="t m0 x3 hd y1ddd ff4 fs7 fc0 sc0 ls0 ws0">on the size of the ne<span class="_ _0"/>w<span class="_ _2"/>.exe le, as we will w<span class="_ _0"/>ait for the le to nish downloading </div><div class="t m0 x3 hd y1dde ff4 fs7 fc0 sc0 ls0 ws0">before ex<span class="_ _0"/>ecuting and exiting. <span class="_ _2"/>Also, notice the double backslashes because we need </div><div class="t m0 x3 hd y1ddf ff4 fs7 fc0 sc0 ls0 ws0">to escape the backslash in the le path. <span class="_ _0"/>When using this in the real world, we’<span class="_ _2"/>d </div><div class="t m0 x3 hd y1de0 ff4 fs7 fc0 sc0 ls0 ws0">probably want to test a fe<span class="_ _0"/>w directories within the Po<span class="_ _0"/>wershell script to be sure we’<span class="_ _0"/>re </div><div class="t m0 x3 hd y1de1 ff4 fs7 fc0 sc0 ls0 ws0">do<span class="_ _0"/>wnloading the le to a well-hidden and writeable directory<span class="_ _2"/>.</div><div class="t m0 x3 h7 y1de2 ff1 fs3 fc0 sc0 ls0 ws0">T<span class="_ _3"/>eensy Binar<span class="_ _1"/>y Executable</div><div class="t m0 x3 hd y1de3 ff4 fs7 fc0 sc0 ls0 ws0">Because T<span class="_ _3"/>eensy is operating as an HID device, or ke<span class="_ _0"/>yboard, we can’<span class="_ _0"/>t simply run an </div><div class="t m0 x3 hd y1de4 ff4 fs7 fc0 sc0 ls0 ws0">ex<span class="_ _0"/>ecutable that is stored on the T<span class="_ _3"/>eensy device. <span class="_ _0"/>W<span class="_ _3"/>e do, howe<span class="_ _0"/>v<span class="_ _0"/>er<span class="_ _0"/>, hav<span class="_ _0"/>e a fe<span class="_ _0"/>w options </div><div class="t m0 x3 hd y1de5 ff4 fs7 fc0 sc0 ls0 ws0">for ho<span class="_ _0"/>w to get an ex<span class="_ _0"/>ecutable transferred to the operating system.</div><div class="t m0 x4 hd y1de6 ff4 fs7 fc0 sc0 ls0 ws0">W<span class="_ _3"/>e can “type out” a le that is embedded within our source le, or we can open </div><div class="t m0 x3 hd y1de7 ff4 fs7 fc0 sc0 ls0 ws0">a binary le on an SD card attached to the T<span class="_ _3"/>eensy<span class="_ _2"/>. Or we can attach the SD card as </div><div class="t m0 x3 hd y1de8 ff4 fs7 fc0 sc0 ls0 ws0">a USB storage de<span class="_ _0"/>vice and access the contents by interacting with the host operating </div><div class="t m0 x3 hd y1de9 ff4 fs7 fc0 sc0 lsb ws16">system, again through ke<span class="_ _0"/>yboard commands. This second method is slightly less </div><div class="t m0 x3 hd y1dea ff4 fs7 fc0 sc0 lsb ws16">preferred, again because it’<span class="_ _2"/>s becoming much more popular for organizations to block </div><div class="t m0 x3 hd y1deb ff4 fs7 fc0 sc0 ls0 ws0">USB storage de<span class="_ _0"/>vices, and because this leav<span class="_ _0"/>es slightly more meaningful forensic </div><div class="t m0 x3 hd y1dec ff4 fs7 fc0 sc0 ls0 ws0">e<span class="_ _0"/>vidence of a storage device being attached. Of course, if our backdoor is successful, </div><div class="t m0 x3 hd y1ded ff4 fs7 fc0 sc0 ls0 ws0">we can remov<span class="_ _0"/>e these log entries from the registry<span class="_ _3"/>.</div><div class="t m0 x4 hd y1dee ff4 fs7 fc0 sc0 ls0 ws0">In either case, we can expand the storage capabilities of the <span class="_ _0"/>T<span class="_ _2"/>eensy using the SD </div><div class="t m0 x3 hd y1def ff4 fs7 fc0 sc0 ls0 ws0">card adapter sho<span class="_ _0"/>wn in Figure 8-11. This is another easy component to work with </div><div class="t m0 x3 h21 y1df0 ff1 fs2 fc0 sc0 ls0 ws0">Figure 8-11<span class="_ _21"> </span><span class="ffc">T<span class="_ _3"/>eensy with riser and SD</span></div></div><div class="pi" data-data="{&#34;ctm&#34;:[1.209373,0.000000,0.000000,1.209373,0.000000,0.000000]}"/></div></div></body></html>